
;===========================================================================
; <<<<< SUPER JUMP >>>>>
; SJ after c.SP : 10230
; SJ Straight : 10231
; SJ Forward : 10232
; SJ Backward : 10233
; LJ West : 10240
;===========================================================================

;SUPER JUMP AFTER C.SP
[Statedef 10230]
type    = S
physics = S
anim = 40
ctrl = 0
velset = 0,0
facep2 = 1

[State 10230, Superjump Sound]
type = PlaySnd
trigger1 = Time = 0
value = 0,24

[State 10230, Superjump Var]
type = varset
trigger1 = Time = 0
var(22) = 1

[State 890, 2];FX
type = Explod
trigger1 = !time
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 10230, 11]
type = VelSet
trigger1 = AnimTime = 0
x = 0.85 * Const(velocity.jump.fwd.x)
y = Const(velocity.jump.y) - 2

[State 40, 6]
type = ChangeState
triggerall = NumExplod(90000008) || NumExplod(90000009) || NumExplod(90000007)
trigger1 = AnimTime = 0
value = 50
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) >= 1
trigger1 = AnimTime = 0
value = 55
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) = 0
trigger1 = AnimTime = 0
value = 50
ctrl = 1



;---------------------------------------------------------------------------
; SUPER JUMP STRAIGHT UP
[Statedef 10231]
type    = S
physics = S
anim = 40
ctrl = 0
velset = 0,0
facep2 = 1

[State 10230, Superjump Var]
type = varset
trigger1 = Time = 0
var(22) = 1

[State 890, 2]
type = Explod
trigger1 = !time
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 10231, Superjump Sound]
type = PlaySnd
trigger1 = Time = 0
value = 0,24

[State 10231, Give Player control]
type = ctrlset
trigger1 = Time = 20
value = 1

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 10231, 11]
type = VelSet
trigger1 = AnimTime = 0
x = Const(velocity.jump.neu.x)
y = Const(velocity.jump.y) - 2.5

[State 40, 6]
type = ChangeState
triggerall = NumExplod(90000008) || NumExplod(90000009) || NumExplod(90000007)
trigger1 = AnimTime = 0
value = 50
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) >= 1
trigger1 = AnimTime = 0
value = 55
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) = 0
trigger1 = AnimTime = 0
value = 50
ctrl = 1


;---------------------------------------------------------------------------
; SUPER JUMP FORWARD
[Statedef 10232]
type    = S
physics = S
anim = 40
ctrl = 0
velset = 0,0
facep2 = 1

[State 890, 2]
type = Explod
trigger1 = !time
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 10230, Superjump Var]
type = varset
trigger1 = Time = 0
var(22) = 1

[State 10232, Superjump Sound]
type = PlaySnd
trigger1 = Time = 0
value = 0,24

[State 10232, Give Player control]
type = ctrlset
trigger1 = Time = 20
value = 1

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 10232, 11]
type = VelSet
trigger1 = AnimTime = 0
x = Const(velocity.jump.fwd.x)
y = Const(velocity.jump.y) - 2.2

[State 40, 6]
type = ChangeState
triggerall = NumExplod(90000008) || NumExplod(90000009) || NumExplod(90000007)
trigger1 = AnimTime = 0
value = 50
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) >= 1
trigger1 = AnimTime = 0
value = 55
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) = 0
trigger1 = AnimTime = 0
value = 50
ctrl = 1


;---------------------------------------------------------------------------
; SUPER JUMP BACKWARD
[Statedef 10233]
type    = S
physics = S
anim = 40
ctrl = 0
velset = 0,0
facep2 = 1

[State 890, 2]
type = Explod
trigger1 = !time
Anim = 8051
postype = P1
pos = 0,-20
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 10230, Superjump Var]
type = varset
trigger1 = Time = 0
var(22) = 1

[State 10233, Superjump Sound]
type = PlaySnd
trigger1 = Time = 0
value = 0,24

[State 10233, Give Player control]
type = ctrlset
trigger1 = Time = 20
value = 1

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1


[State 10233, 11]
type = VelSet
trigger1 = AnimTime = 0
x = Const(velocity.jump.back.x)
y = Const(velocity.jump.y) - 2.2

[State 40, 6]
type = ChangeState
triggerall = NumExplod(90000008) || NumExplod(90000009) || NumExplod(90000007)
trigger1 = AnimTime = 0
value = 50
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) >= 1
trigger1 = AnimTime = 0
value = 55
ctrl = 1

[State 40, 6]
type = ChangeState
triggerall = !NumExplod(90000008) && !NumExplod(90000009) && !NumExplod(90000007)
triggerall = var(51) = 0
trigger1 = AnimTime = 0
value = 50
ctrl = 1
;---------------------------------------------------------------------------
; WIN STATE DECIDER
[Statedef 180]
type = S


[state 180, victoryquote]
type = victoryquote
trigger1 = !time && var(51) = 0
value = random%965


[state 180, victoryquote]
type = victoryquote
trigger1 = !time && var(51) >= 1
value = 35 + (random%24)

[state 181, 1]
type = assertspecial
trigger1 = 1
flag = roundnotover

[state 3101, assertspecial]
type = assertspecial
trigger1 = var(49) = 2
flag = nomusic
flag2 = noFG

[State 3025, Dragon Ball from opponent]
type = helper
triggerall = numenemy
triggerall = !((ishometeam = 1)&& (teamside= 1)) 
trigger1 = !time
trigger1 = MatchOver && !numhelper(18045)
helpertype = normal
stateno = 18045
ID = 18045
name = "Dragon Ball"
postype = p2
ownpal = 1
ignorehitpause = 1
persistent = 0

[state 180, Big Bang Attack Winpose]
type = changestate
trigger1 = var(49) = 2
value = 4202


[state 181, Evolution Winposes]
type = changestate
triggerall = var(51) = 2 
trigger1 = !time
value = 190

[state 180, Squid Winpose]
type = changestate
trigger1 = var(49) = 3
value = 70200

[state 180, Stomp Winpose]
type = changestate
triggerall = Numenemy
triggerall = var(49) = 1
triggerall = enemy, name != "SaibamenZ2"
triggerall = enemy, name != "FarmerZ2"
triggerall = enemy, pos y = 0
triggerall = enemy, pos x = [-240,240]
trigger1 = Winko
value = 181

[state 180, Normal Winposes]
type = changestate
trigger1 = !time
value = 181+random%4
;------------------------------------------------------------
;WINPOSE 1- Stomp or Destroy
[statedef 181]
type = S
movetype = A
ctrl = 0
juggle = 0
anim = 20
sprpriority = -4

[state 181, changestate]
type = changestate
triggerall = !time
trigger1 = enemy, name = "SaibamenZ2"
trigger2 = enemy, name = "FarmerZ2"
trigger3 = enemy, alive
trigger4 = p2dist X < -12 
trigger4 = facing != enemy, facing
trigger5 = !winko
value = 182+random%3



[State 100, steps]
type = playsnd
triggerall = anim = 20
trigger1 = animelemtime(5)=1 || animelemtime(9) = 1
value = 0,51

[State 0, Enemy not on-screen]
type = ChangeState
triggerall = !time
trigger1 = enemy,Pos X!=[-140,140]
trigger2 = enemy,Pos Y != 0
trigger3 = enemy,anim != 5110
value = 182+random%3
ctrl = 0


[state 182, velset]
type = velset
trigger1 = anim = 20
x = const(velocity.walk.fwd.x)


[state 182, velset]
type = velset
trigger1 = anim = 182 || anim = 186
x = 0

[state 182, changeanim]
type = changestate
trigger1 = Enemy, Facing != Facing
trigger1 = Anim = 20
trigger1 = vel x > 0
trigger1 = Enemy, P2Dist X <= 10 && (Enemy, P2Dist X >= -20)
trigger2 = Enemy, Facing = Facing
trigger2 = Anim = 20
trigger2 = vel x > 0
trigger2 = Enemy, P2Dist X >= -85 && (Enemy, P2Dist X >= -35)
trigger3 = Anim = 20
trigger3 = vel x > 0
trigger3 = FrontEdgeBodyDist <=5
trigger4 =  time = 120 && anim != 182 && anim != 186
value = ifelse(p2stateno = 1850,1810,1811)




[state 181, 1]
type = assertspecial
trigger1 = time < 300
flag = roundnotover

;------------------------------------------------------------
;Stomp
[statedef 1810]
type = S
movetype = A
ctrl = 0
juggle = 0
velset = 0,0
anim = 182
sprpriority = -4

[state 1810, changeanim]
type = changeanim
triggerall = !time
trigger1 = enemy,name = "Gotenks Z2"
trigger2 = enemy,name = "Freeza Z2"
trigger3 = enemy,name = "C18 Z2"
value = 18201


[State 200, hit ground sound]
type = null
triggerall = anim =182
trigger1 = animelemtime(5)=0
value = 5100,0
channel = 1

[State 200, step sound]
type =null
triggerall = anim = 182
trigger1 = animelem = 5
value = 184,0+random%3



[State 200, hit ground sound]
type = playsnd
triggerall = anim =182 || anim = 18201
trigger1 = animelemtime(4)=0
value = 181,11


[state 182, envshake]
type = envshake
triggerall = anim = 182 || anim = 18201
trigger1 = animelem = 4
time = 16
freq =  60
ampl = 5

[state 1810, remember]
type = playsnd
trigger1 = time = 60 
value = 181,ifelse(NumExplod(18200),12,13+random%2)
channel = 0

[State 732, Talking face]
type = Explod
trigger1 = time = 59 && random < 500
anim = 18200
ID = 18200
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[State 732, Talking face]
type = Explod
trigger1 = time = 59 && !NumExplod(18200)
anim = 18202
ID = 18202
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[state 181, 1]
type = assertspecial
trigger1 = time < 200
trigger2 = ifelse(NumExplod(18200),0,time < 270)
flag = roundnotover

;------------------------------------------------------------
;Destroy
[statedef 1811]
type = S
movetype = A
ctrl = 0
juggle = 0
velset = 0,0
anim = 186
sprpriority = -4

[State 4500, 1]
type = null
trigger1 = time = 30
value = 181,9

[State 732, Hand FX]
type = Explod
triggerall = anim = 186
trigger1 = animelemtime(2) = 0
anim = 18600
ID = 18600
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1
persistent = 0

[State 732, Ball FX]
type = Explod
triggerall = anim = 186
trigger1 = animelemtime(2) = 0
anim = 18601
ID = 18601
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = 6
ownpal = 0
bindtime = -1
persistent = 0

[State 731, Charging Sound]
type = PlaySnd
triggerall = anim = 186
trigger1 = animelemtime(2) = 0
value = 8,0
loop = 1
channel = 8
volumescale = 25

[State 731, Charging Sound]
type = PlaySnd
triggerall = anim = 186
trigger1 = time = 52
value = 1811,0



[State 1900, SSJ white circle]
type = null
triggerall = anim = 186
trigger1 = time = 120
anim = 90202
id = 90202
pos = 35,-36
sprpriority = 7
ontop = 1
bindtime = -1
ownpal = 1
supermovetime = 9999
ignorehitpause = 1
removetime = -2
scale = .005,.005

[State 1900, SSJ white circle]
type = modifyexplod
trigger1 = numexplod(90202) 
scale = .12*(time-120),.12*(time-120)
ID = 90202

[State 4500, 1]
type = null
trigger1 = time = 120
channel = 8

[State 4500, 1];transform SND
type = null
trigger1 = time = 120
value = 194,0



[state 181, 1]
type = assertspecial
trigger1 = time <250
flag = roundnotover

;Hit by Stomp
[Statedef 1850]
type = L
movetype = H
physics = N
sprpriority = 2
anim = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

[state 1850, nothitby]
type = nothitby
trigger1 = 1
value = SCA

[state 1850, changeanim]
type = changeanim
triggerall = anim = 5110
trigger1 = enemynear,animelemtime(4) = 0
trigger1 = enemynear, anim = 182 
value = 5080

;---------------------------------------------------------------------------
; WINPOSE 2 - I am Super Vegeta
[Statedef 182]
type = S
ctrl = 0
anim = 184
velset = 0,0
sprpriority = 1

[state 182, playsnd]
type = playsnd
trigger1 = animelem = 1
value = 184,ifelse(var(51) >= 1,4+random%2,3)
channel = 0

[state 182, playsnd]
type = playsnd
trigger1 =  animelem = 4
value = 181,10



[state 182, envshake]
type = envshake
trigger1 = animelemtime(4) = 0
ampl = 16
freq = 50
time = 10


[State 732, Talking face]
type = Explod
trigger1 = animelemtime(2) = 0
anim = ifelse(var(51) >= 1,18402,18400)
ID = 18400
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[State 732, Talking face]
type = Explod
trigger1 = animelemtime(4) = 0
anim = ifelse(var(51) >= 1,18403,18401)
ID = 18401
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[state 181, 1]
type = assertspecial
trigger1 = time < 280
flag = roundnotover

;---------------------------------------------------------------------------
; WINPOSE 3 - Wryyyy?
[Statedef 183]
type = S
ctrl = 0
anim = ifelse(var(51) = 1,18301,183)
velset = 0,0
sprpriority = 1


[state 183, air]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 0,0

[state 183, air]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 0,2

[state 183, air]
type = playsnd
triggerall = var(51) = 0
trigger1 = animelemtime(9) = 10
value = 183,5
channel = 0


[State 732, Talking face]
type = Explod
triggerall = var(51) = 0
trigger1 = animelemtime(9) = 10 
anim = 18300
ID = 18300
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[state 183, air]
type = playsnd
triggerall = var(51) > 0
trigger1 = animelemtime(9) = 10
value = 186,0
channel = 0

[State 732, Face]
type = Explod
triggerall = var(51) > 0
trigger1 = animelemtime(9) = 10 
anim = 18702
ID = 18702
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 0
bindtime = -1


[state 181, 1]
type = assertspecial
trigger1 = time < 200
trigger2 = var(51) = 1 && time < 400
flag = roundnotover

;---------------------------------------------------------------------------
; WINPOSE 4 - Judgemental Head Turn
[Statedef 184]
type = S
ctrl = 0
anim = ifelse(random < 500,185,18504)
velset = 0,0
sprpriority = 1

[state 184, playsnd]
type = playsnd
trigger1 = time = 30
value = 185,ifelse(anim = 185,0,1+random%2)
channel = 0

[State 732, Go lick your wounds]
type = Explod
trigger1 = time = 29 && anim = 185
anim = 18500
ID = 18500
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[State 732, You disappoint me]
type = Explod
trigger1 = time = 140 && NumExplod(18500)
anim = 18501
ID = 18501
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[State 732, Another goody two shoes]
type = Explod
trigger1 = time = 29 && anim = 18504
anim = 18502
ID = 18502
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[State 732, Crawls into an early grave]
type = Explod
trigger1 = time = 140 && NumExplod(18502)
anim = 18503
ID = 18503
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[state 181, 1]
type = assertspecial
trigger1 = time < 300
flag = roundnotover
;---------------------------------------------------------------------------
;EVOWINPOSE 1 - Flare Aura
[Statedef 190]
type = S
ctrl = 0
anim = 187
sprpriority = 1

[state 185, envshake]
type = envshake
trigger1 = animelemtime(4) = 0
time = 999
ampl = 1
freq = 60

[State 732, Aura]
type = Explod
triggerall = !NumExplod(18701)
trigger1 = animelemtime(4) = 0
anim = 18701
ID = 18701
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -1
sprpriority = -1
ownpal = 0
bindtime = -1

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(3)=0
value = 8,1
volumescale = 255

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(4)=0
value = 8,0
loop = 1
pan = 1
channel = 4

[state 185, power]
type = playsnd
trigger1 = time = 39
value = 186,1
channel = 0

[State 732, Face]
type = Explod
trigger1 = time = 38
anim = 18703
ID = 18703
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 2
ownpal = 0
bindtime = -1


[state 181, 1]
type = assertspecial
trigger1 = time < 400
flag = roundnotover

;===========================================================================
;POWER CHARGE
;===========================================================================
[StateDef 900]
type = S
movetype = I
physics = S
anim = ifelse(var(51) = 0,900,ifelse(var(51) = 1,902,911))
velset = 0,0
ctrl = 0

[State 1900,  face explod]
type = null
triggerall = !NumExplod(9001)
triggerall = anim = 900
;trigger1 = animelemtime(6)=0
trigger1 = time=72
anim = 9001
id = 9001
pos = 0,0
sprpriority = 6
bindtime = -1
ownpal = 0
removeongethit = 1
ignorehitpause = 1
facing = 1
pausemovetime = 9999
supermovetime = 9999
removetime = -2

[state 3000, UUURAAAAAAAAAAAAAA!]
type = playsnd
trigger1 = animelemtime(3) = 0
value = 8,8
channel = 0
volumescale = 255


[State 1000, Power]
type = PowerAdd
triggerall = (Anim = 900 || anim = 902 || anim = 911) && (power < 3000)
trigger1 = (AILevel<=0) && (command = "holdb") && (command = "holdy")
trigger2 = AILevel>0
value = 5 + (time/20)

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(3)=0
value = 8,1
volumescale = 255

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(4)=0
value = 8,0
loop = 1
pan = 1
channel = 3


[State 4500, 1];Scream
type = PlaySnd		
trigger1 = animelemtime(3)=0
value = 8,1
volumescale = 255
channel = 4

[State 1000, shake]
type = EnvShake
triggerall = (anim=900 || anim = 902 || anim = 911) && animelemtime(5)>=0
trigger1 = !(time%4)
time=4
freq=80
ampl=1+0.02*time

[State 1000, ssbe flash]
type = PalFX
triggerall = var(51) = 2
trigger1 = (Anim = 900 || anim = 902 || anim = 911) && !(time%10) && animelemtime(5)>=0
add = -10, 20, 100
sinadd = -10,20,60,10
time = 10

[State 1000, ssb flash]
type = PalFX
triggerall = var(51) = 1
trigger1 = (Anim = 900 || anim = 902 || anim = 911) && !(time%10) && animelemtime(5)>=0
add = -10, 20, 60
sinadd = -10,20,60,10
time = 10

[State 1000, ssj flash]
type = PalFX
triggerall = var(51) = 0
trigger1 = (Anim = 900 || anim = 902 || anim = 911) && !(time%10) && animelemtime(5)>=0
add = 10, 20, -20
sinadd = -10,20,60,10
time = 10

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(4)=0
id = 905
name = "Charge"
pos = -24,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
size.xscale = ifelse(var(51) != 1,1.1,1)
size.yscale = ifelse(var(51) != 1,1.1,1)

[State 1003, Helper]
type = Helper
triggerall = var(51) = 1
trigger1 = AnimElemTime(4)=1
trigger2=AnimElemTime(4)>1&&time%5=0
helpertype = Normal
name = "PerseEffect"
id = 2932
;pos = ((random%240)-120),((random%240)-120)
pos =((random%Const(Size.Ground.Front))-10),((random%Const(Size.Height))-50)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
sprpriority=-1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .02 - (.1*.5)
size.yscale = .02 - (.1*.5)

[State 1003, Helper]
type = Helper
triggerall = var(51) = 1
trigger1 = AnimElemTime(4)=1
trigger2=AnimElemTime(4)>1&&time%40=0
helpertype = Normal
name = "PerseEffect"
id = 2932
pos =((random%Const(Size.Ground.Front))-10),0
;pos = 0,0;-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .04 - (.1*.5)
size.yscale = .04 - (.1*.5)

[State 1003, Helper]
type = Helper
triggerall = var(51) = 1
trigger1 = AnimElemTime(4)=1
trigger2=AnimElemTime(4)>1&&time%80=0
helpertype = Normal
name = "PerseEffect"
id = 2932
pos =((random%Const(Size.Ground.Front))-10),0
;pos = 0,0;-ceil(random/10)
postype = p1
facing = 1
stateno = 2932
keyctrl = 0
ownpal = 1
supermovetime = 9999
pausemovetime = 9999
ignorehitpause = 1
size.xscale = .06 - (.1*.5)
size.yscale = .06 - (.1*.5)

[State 1001, stopsnd]
type = stopsnd
trigger1 = !AILEVEL
trigger1 = (command != "holdb") || (command != "holdy")
trigger2 = anim != 900 && anim != 902 && anim != 911
trigger3 = Power >= const(data.power) || Power >= PowerMax || RoundState != 2
channel = 3
persistent = 0

[State 1000, PC-End]
type = ChangeState
triggerall = anim = 900 || anim = 902 || anim = 911
trigger1 = (AILevel<=0)
trigger1 = (command != "holdb") || (command != "holdy")
trigger2 = Power >= const(data.power) || Power >= PowerMax || RoundState != 2
trigger3 = AILevel > 0
trigger3 = enemynear, movetype = A || enemy, Vel X > 4
trigger3 = Time >= 20
trigger4 = AILevel > 0
trigger4 = enemynear, stateno = 5120
value = 901
Ctrl = 1

; End of Power Charge
[StateDef 901] 
type = S
movetype = I
physics = S
ctrl = 0
anim = ifelse(var(51) = 0,901,904)

[State 1001, stopsnd]
type = stopsnd
trigger1 = 1
channel = 3

persistent = 0
[State 1001, full power]
type = playsnd
trigger1 = anim = 901 && power >= 3000
value = 8,3
channel = 1
persistent = 0


[State 1001, stopsnd]
type = stopsnd
trigger1 = power < 3000
channel = 0
persistent = 0

[State 1001, full power]
type = playsnd
trigger1 = (anim = 901 || anim = 904) && power >= 3000
value = 8,4
channel = 0
persistent = 0



[State 1001, EndByPowMax]
type = PalFX
trigger1 = Power = 3000
time = 1
add = 255-(20*Time), 255-(20*Time), 255-(20*Time)

[State 1001, End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
;AIR DASH
;===========================================================================
[Statedef 110]
type = A
physics = N
anim = 110
velset = 0,0
ctrl = 0

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000200

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000210

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000220

[State 110, var]
type = VarSet
trigger1 = time=0
var(10)=1

[State 110, end]
type = ChangeState
trigger1 = AnimTime = 0
value = 111

;------------------------------------------
; DASH FORWARD
[Statedef 111]
type = A
physics = N
anim = 102
ctrl = 0
velset = 0,0

[State 0, CtrlSet]
type = CtrlSet
trigger1 = !NumExplod(110)
value = 1

[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "x"
anim = 15999
ID = 90000200
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "y"
anim = 15999
ID = 90000210
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "z"
anim = 15999
ID = 90000220
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "a"
anim = 15999
ID = 90000230
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "b"
anim = 15999
ID = 90000240
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "c"
anim = 15999
ID = 90000250
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "start"
anim = 15999
ID = 90000195
removetime = 5
pausemovetime = 5
supermovetime = 5

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 100, 7]
type = Explod
trigger1 = Time = 0
Anim = 8050
postype = P1
pos = -10,-20
scale = 1,.8
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1

[State 111, 1]
type = VelSet
trigger1 = time=0
x = 9

[State 115, dash Sound]
type = PlaySnd
trigger1 = time=0
value = 100,0

[State 111, 1]
type = VelAdd
trigger1 = time>=5 && vel X>=0
x = -0.3

[State 111, 1]
type = StateTypeSet
trigger1 = time >= 5
physics = A

[State 111, 1]
type = ChangeState
trigger1 = time > 7
value = 50

;------------------------------------------
;LAND FROM AERIAL DASH FORWARD
[Statedef 112]
type    = S
movetype= I
physics = S
ctrl = 0
anim = 103

[State 115, 1]
type = VelSet
trigger1 = Time = 0
x = 15
y = 0

[State 115, 3]
type = VelAdd
trigger1 = Time > 0
x = .15

[state 115, 2]
type = posset
trigger1 = time = 0
y = 0

[State 115, Landing Sound]
type = PlaySnd
trigger1 = animelem = 2
value = 52,0

[State 115, e]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;-----------------------------------------
;AIR DASH BACK
[Statedef 115]
type = A
movetype = I
physics = N
anim = 115
ctrl = 0
velset = 0,0

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000200

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000210

[state 115, removexplod]
type = removeexplod
trigger1 = !time
id = 90000220

[State 110, var]
type = VarSet
trigger1 = time=0
var(10)=1

[State 0, CtrlSet]
type = CtrlSet
trigger1 = !NumExplod(110)
value = 1

[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "x"
anim = 15999
ID = 90000200
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "y"
anim = 15999
ID = 90000210
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "z"
anim = 15999
ID = 90000220
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "a"
anim = 15999
ID = 90000230
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "b"
anim = 15999
ID = 90000240
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "c"
anim = 15999
ID = 90000250
removetime = 5
pausemovetime = 5
supermovetime = 5
[State 0, Explod]
type = Explod
trigger1 = NumExplod(110)
trigger1 = command = "start"
anim = 15999
ID = 90000195
removetime = 5
pausemovetime = 5
supermovetime = 5

[State 0, PosAdd]
type = PosAdd
trigger1 = PrevStateNo = 251
trigger1 = !Time
y = -30

[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 0
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 100, 7]
type = Explod
trigger1 = Time = 0
Anim = 8050
postype = P1
pos = 0,-20
scale = 1,.8
bindtime = 15
sprpriority = 2
ownpal = 1
removetime = -2
removeongethit = 1
facing = -1

[State 111, 1]
type = VelSet
trigger1 = time=0
x = -7

[State 115, dash Sound]
type = PlaySnd
trigger1 = time=0
value = 100,0

[State 111, 1]
type = VelAdd
trigger1 = time>=5 && vel X<=0
x = 0.2

[State 111, 1]
type = StateTypeSet
trigger1 = time >= 5
physics = A

[State 111, 1]
type = ChangeState
trigger1 = time > 7
value = 116

[State 112, end]
type = ChangeState
trigger1 = Vel Y > 0 && Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
; Back Dash in air - modified state 50
[Statedef 116]
type    = A
physics = A

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 50, 2]
type = ChangeAnim
trigger1 = Time = 0
value = 104


;===================<GUARD>================
;Guard Start
[StateDef 120]
type = U
physics = U
anim = 120 + (StateType = C) + (StateType = A) * 2

[State 120, StateTypeSet: Standing]
type = StateTypeSet
trigger1 = !Time && StateType = S
physics = S

[State 120, StateTypeSet: Crouching]
type = StateTypeSet
trigger1 = !Time && StateType = C
physics = C

[State 120, StateTypeSet: Jumping]
type = StateTypeSet
trigger1 = !Time && StateType = A
physics = A

[State 120, VelSet]
type = VelSet
trigger1 = !Time && StateType != A
x = 0
y = 0

[State 120, Stand to Crouching]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = S && command = "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = S && command = "holdup"
trigger3 = AILevel && StateType = S && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
stateType = C
physics = C

[State 120, Crouching to Stand]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = C && command != "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = C && command != "holdup"
trigger3 = AILevel && StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S

[State 120, AI Fix]
type = CtrlSet
trigger1 = AILevel && NumEnemy
value = (EnemyNear, Time >= 120 || Time >= 180)

[State 120, Change to Guard State]
type = ChangeState
trigger1 = !AnimTime || AILevel
value = 130 + (StateType = C) + (StateType = A) * 2

[State 120, Stop Guarding]
type = ChangeState
trigger1 = !AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command != "holdfwd", command != "holdback"), ifElse(P2dist x < 0, command != "holdback", command != "holdfwd")))
trigger2 = !InGuardDist
trigger3 = AILevel && NumEnemy
trigger3 = EnemyNear, HitDefAttr = SCA, AT
value = 140


;Standing Guard
[StateDef 130]
type = S
physics = S

[State 130, ChangeAnim]
type = ChangeAnim
trigger1 = Anim != 130
value = 130

[State 130, AI Fix]
type = CtrlSet
trigger1 = AILevel && NumEnemy
value = (EnemyNear, Time >= 120 || Time >= 180)

[State 130, Standing to Crouch]
type = ChangeState
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = S && command = "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = S && command = "holdup"
trigger3 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
trigger3 = (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
value = 131

[State 130, Stop Guarding]
type = ChangeState
trigger1 = !AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command != "holdfwd", command != "holdback"), ifElse(P2dist x < 0, command != "holdback", command != "holdfwd")))
trigger2 = !InGuardDist
trigger3 = AILevel && NumEnemy
trigger3 = EnemyNear, HitDefAttr = SCA, AT
value = 140

[State 130, Landing Sound]
type = PlaySnd
trigger1 = !Time
trigger1 = PrevStateNo = 132 || (PrevStateNo = [154,155])
value = 52,0

[State 130, Landing Dust Expod]
type = Explod
trigger1 = !Time
trigger1 = PrevStateNo = 132 || (PrevStateNo = [154,155])
anim = 8102
sprpriority = -3
posType = P1
scale = 0.5,0.5
pauseMoveTime = -1
superMoveTime = -1
ownPal = 1


;Crouch Guarding
[StateDef 131]
type = C
physics = C

[State 131, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 131
value = 131

[State 131, Crouching to Standing]
type = ChangeState
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = S && command != "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = S && command != "holdup"
trigger3 = AILevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger3 = (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
value = 130

[State 131, AI Fix]
type = CtrlSet
trigger1 = AILevel && NumEnemy
value = (EnemyNear, Time >= 120 || Time >= 180)

[State 131, Stop Guarding]
type = ChangeState
trigger1 = !AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command != "holdfwd", command != "holdback"), ifElse(P2dist x < 0, command != "holdback", command != "holdfwd")))
trigger2 = !InGuardDist
trigger3 = AILevel && NumEnemy
trigger3 = EnemyNear, HitDefAttr = SCA, AT
value = 140


;Air Guard
[StateDef 132]
type = A
physics = N

[State 132, ChangeAnim]
type = ChangeAnim
trigger1 = anim != 132
value = 132

[State 132, VelAdd]
type = VelAdd
trigger1 = 1
y = const(movement.yAccel)

[State 132, VarSet]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0 && vel y > 0)

[State 132, VelSet]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 132, PosSet]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 132, AI Fix]
type = CtrlSet
trigger1 = AILevel && NumEnemy
value = (EnemyNear, Time >= 120 || Time >= 180)

[State 132, Jumping to Standing]
type = ChangeState
trigger1 = sysvar(0) && InGuardDist
trigger1 = (!AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command = "holdfwd", command = "holdback"), ifElse(P2dist x < 0, command = "holdback", command = "holdfwd")))) || AILevel
value = 130

[State 132, Change to Falling]
type = ChangeState
trigger1 = sysvar(0)
value = 52

[State 132, Stop Guarding]
type = ChangeState
trigger1 = !AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command != "holdfwd", command != "holdback"), ifElse(P2dist x < 0, command != "holdback", command != "holdfwd")))
trigger2 = !InGuardDist
trigger3 = AILevel && NumEnemy
trigger3 = EnemyNear, HitDefAttr = SCA, AT
value = 140


;Guard End
[StateDef 140]
type = U
physics = U
ctrl = 1

[State 140, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = 140 + (StateType = C) + (StateType = A) * 2

[State 140, StateTypeSet: Standing]
type = StateTypeSet
trigger1 = !Time && StateType = S
physics = S

[State 140, StateTypeSet: Crouching]
type = StateTypeSet
trigger1 = !Time && StateType = C
physics = C

[State 140, StateTypeSet: Jumping]
type = StateTypeSet
trigger1 = !Time && StateType = A
physics = A

[State 140, Standing to Crouching]
type = StateTypeSet
trigger1 = !AILevel && StateType = S && (NumExplod(90000002) || NumExplod(90000001) || NumExplod(90000003))
trigger2 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
trigger2 = StateType = S && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
stateType = C
physics = C

[State 140, Crouching to Standing]
type = StateTypeSet
trigger1 = !AILevel && StateType = C && (!NumExplod(90000002) && !NumExplod(90000001) && !NumExplod(90000003))
trigger2 = AILevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger2 = StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S

[State 140, End]
type = ChangeState
trigger1 = !AnimTime
value = (StateType = C) * 11 + (StateType = A) * 51


;Hit while Guarding (Standing)
[StateDef 150]
type = S
movetype = H
physics = N
velSet = 0,0

[State 150, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 150

[State 150, End]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2 * ((!AILevel && (NumExplod(90000002) || NumExplod(90000001) || NumExplod(90000003))) || (AILevel && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)))

[State 150, Standing to Crouching]
type = StateTypeSet
trigger1 = !AILevel && StateType = S && (NumExplod(90000002) || NumExplod(90000001) || NumExplod(90000003))
trigger2 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
stateType = C
physics = C

[State 150, Crouching to Standing]
type = StateTypeSet
trigger1 = !AILevel && StateType = C && (!NumExplod(90000002) && !NumExplod(90000001) && !NumExplod(90000003))
trigger2 = AIlevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger2 = StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S


;Knocked Back while Guarding (Standing)
[StateDef 151]
type = S
moveType = H
physics = S
anim = 150

[State 151, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1

[State 151, VelSet]
type = VelSet
trigger1 = Time = GetHitVar(SlideTime)
trigger2 = HitOver
x = 0

[State 151, CtrlSet]
type = CtrlSet
trigger1 = time = GetHitVar(CtrlTime)
value = 1

[State 151, Standing to Crouching]
type = StateTypeSet
trigger1 = !AILevel && StateType = S && (NumExplod(90000002) || NumExplod(90000001) || NumExplod(90000003))
trigger2 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
trigger2 = StateType = S && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
stateType = C
physics = C

[State 151, Crouching to Standing]
type = StateTypeSet
trigger1 = !AILevel && StateType = C && (!NumExplod(90000002) && !NumExplod(90000001) && !NumExplod(90000003))
trigger2 = AILevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger2 = StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S

[State 151, End]
type = ChangeState
trigger1 = HitOver
value = 130
ctrl = 1


;Hit while Guarding (Crouching)
[StateDef 152]
type = C
moveType = H
physics = N
velSet = 0,0

[State 152, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 151

[State 152, End]
type = ChangeState
trigger1 = HitShakeOver
value = 151 + 2 * ((!AILevel && ((!enemy, NumExplod(92828282) && !enemy, NumExplod(92468246) && command = "holddown") || ((enemy, NumExplod(92828282) || enemy, NumExplod(92468246)) && command = "holdup"))) || (AILevel && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)))

[State 152, Standing to Crouching]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = S && command = "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = S && command = "holdup"
trigger3 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
trigger3 = StateType = S && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
stateType = C
physics = C

[State 152, Crouching to Standing]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = C && command != "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = C && command != "holdup"
trigger3 = AILevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger3 = StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S


;Knocked Back while Guarding (Crouching)
[StateDef 153]
type = C
moveType = H
physics = C
anim = 151

[State 153, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1

[State 153, VelSet]
type = VelSet
trigger1 = Time = GetHitVar(SlideTime)
trigger2 = HitOver
x = 0

[State 153, CtrlSet]
type = CtrlSet
trigger1 = Time = GetHitVar(CtrlTime)
value = 1

[State 153, Standing to Crouching]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = S && command = "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = S && command = "holdup"
trigger3 = AILevel && Random < (250 * (AILevel ** 2 / 64.0))
trigger3 = StateType = S && (EnemyNear, MoveType = A) && (EnemyNear, StateType = C)
stateType = C
physics = C

[State 153, Crouching to Standing]
type = StateTypeSet
trigger1 = !enemy, NumExplod(92828282) && !enemy, NumExplod(92468246)
trigger1 = !AILevel && StateType = C && command != "holddown"
trigger2 = enemy, NumExplod(92828282) || enemy, NumExplod(92468246)
trigger2 = !AILevel && StateType = C && command != "holdup"
trigger3 = AILevel && Random < (125 * (AILevel ** 2 / 64.0))
trigger3 = StateType = C && (EnemyNear, MoveType = A) && (EnemyNear, StateType != C)
stateType = S
physics = S

[State 153, End]
type = ChangeState
trigger1 = HitOver
value = 131
ctrl = 1

;Hit while Guarding (Jumping)
[StateDef 154]
type = A
moveType = H
physics = N
velSet = 0,0

[State 154, ChangeAnim]
type = ChangeAnim
trigger1 = 1
value = 152

[State 154, End]
type = ChangeState
trigger1 = HitShakeOver
value = 155


;Knocked Back while Guarding (Jumping)
[StateDef 155]
type = A
moveType = H
physics = N
anim = 152

[State 155, HitVelSet]
type = HitVelSet
trigger1 = !Time
x = 1
y = 1

[State 155, VelAdd]
type = VelAdd
trigger1 = 1
y = const(movement.yAccel)

[State 155, CtrlSet]
type = CtrlSet
trigger1 = Time = GetHitVar(CtrlTime)
value = 1

[State 155, VarSet]
type = VarSet
trigger1 = 1
sysvar(0) = (pos y >= 0 && vel y > 0)

[State 155, VelSet]
type = VelSet
trigger1 = sysvar(0)
y = 0

[State 155, PosSet]
type = PosSet
trigger1 = sysvar(0)
y = 0

[State 155, End]
type = ChangeState
trigger1 = sysvar(0) && InGuardDist
trigger1 = (!AILevel && (ifElse(!enemy, NumExplod(94646464) && !enemy, NumExplod(92468246), ifElse(P2dist x < 0, command != "holdfwd", command != "holdback"), ifElse(P2dist x < 0, command != "holdback", command != "holdfwd")))) || AILevel
value = 130

[State 155, End]
type = ChangeState
trigger1 = sysvar(0)
value = 52

;---------------------------------------------------------------------------
;INTRO DECIDER
[Statedef 191]
type = S
ctrl = 0




[state 180, Normal Winposes]
type = changestate
trigger1 = !time
value = 701+random%6
;---------------------------------------------------------------------------
;Do you feel pain?
[Statedef 700]
type = S
anim = 700

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[state 700, pain]
type = playsnd
trigger1 = time = 60 
value =  19736,3+random%2
channel = 0

[State 732, Talking face]
type = Explod
trigger1 = Anim=700
trigger1 = time = 60 && !NumExplod(746)
anim = 70000
ID = 70000
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 4
ownpal = 0
bindtime = -1

[state 700, changestate]
type = changestate
trigger1 = animtime  = 0
value = 0
;--------------------------------------------------------
;Descending from sky
[statedef 701]
type = A
physics = N
velset = 0,1
anim = 701


[state 701, positionset]
type = posset
trigger1 = !time
y = -300


[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[state 700, velset]
type = velset
trigger1 = Pos Y >= 0 && Vel Y > 0
y = 0



[State 1900, Aura helper]
type = Helper
trigger1 = anim = 701 && animelemtime(1) = 0
id = 905
name = "Charge"
pos = -12,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
size.xscale = 1.1
size.yscale = 1.1
persistent = 0

[state 701,changeanim]
type = changeanim
trigger1 =  anim = 701 & Pos Y = 0
value = 702

[State 4500, 1];Small sound
type = Playsnd
trigger1 = !time
value = 8,1
volumescale = 255


[State 4500, 2];long sound
type = PlaySnd
trigger1 = !time
value = 8,0
loop = 1
pan = 1
channel =  3

[state 701, stopsnd]
type = stopsnd
trigger1 = anim = 702
trigger2 = anim != 701
channel = 3

[State 1001, full power]
type = playsnd
trigger1 = anim = 702 && animelemtime(1) = 0
value = 8,3
channel = 1
persistent = 0


[state 700, changestate]
type = changestate
trigger1 = anim = 702 && animtime = 0
value = 0
;---------------------------------------------------------------------------
;Squidtro
[Statedef 702]
type = S
anim = 703
sprpriority = 2

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[state 702, winpose]
type = varset
trigger1 = time = 1
var(49) = 3

[state 702, playsnd]
type = playsnd
trigger1 =  time = 152
value = 191,0
channel = 0

[state 702, playsnd]
type = playsnd
trigger1 =  time = 177
value = 2,12


[State 732, Talking face]
type = Explod
trigger1 = !time
anim = 70300
ID = 70300
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 3
ownpal = 0
bindtime = -1

[State 732, Talking face]
type = Explod
trigger1 = animelemtime(4) = 0
anim = 70301
ID = 70301
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 1
ownpal = 0
bindtime = -1

[State 732, Talking face]
type = Explod
trigger1 = animelemtime(4) = 0
anim = 70302
ID = 70302
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
supermove = 1
removetime = -2
sprpriority = 7
ownpal = 0
bindtime = -1

[state 702, squish]
type = playsnd
trigger1 = time = 51 || time = 96 || time = 121
value = 702,5


[State 0, Super FX]
type = Helper
trigger1 = animelemtime(4) = 0
stateno = 1910
id = 1910
pos = 0,0
postype = p1
supermovetime = 9999
pausemovetime = 9999
sprpriority = 4
ownpal = 1
scale = 1,1
persistent = 0


[state 700, changestate]
type = changestate
trigger1 = animtime  = 0
value = 0
ctrl = 0
;---------------------------------------------------------------------------
;Special WINPOSE - Squiddy Returns
[Statedef 70200]
type = S
ctrl  = 0
anim = 188
sprpriority = 1

[state 70200, camera]
type = ScreenBound
trigger1 = animelemtime(7) > 0
value = 0

[state 70200, surprised sound]
type = playsnd
trigger1 = animelemtime(4) = 0
value = 703,1

[state 70200, velset]
type = velset
trigger1 = animelemtime(7) = 0
x = 6

[state 70200, stay away from me]
type = playsnd
trigger1 = animelemtime(7) = 0
value = 702,6+random%2
channel = 0
persistent = 0

[state 70200, Squid]
type = helper
triggerall = !NumHelper(70200)
trigger1 = animelemtime(9) > 0 && pos x != [-240,240]
stateno = 70201
id = 70201
postype = back
pos = -40,0
name = "spinsquid"
persistent = 0



[state 70200, 1]
type = assertspecial
trigger1 = time < 200
flag = roundnotover
;---------------------------------------------------------------------------
;Sweeping Intro
[Statedef 703]
type = S
physics = N
anim = 704
sprpriority = 2

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[state 703, apron]
type = helper
trigger1 = !time
stateno = 70300
id = 70300
postype = p1
pos = 0,0
sprpriority = 3
name = "apron"
ownpal = 1

[state 703, brush sound]
type = playsnd
triggerall = anim = 704
trigger1 = animelemtime(3) = 0 || animelemtime(11) = 0 || animelemtime(19) = 0
value = 703,0

[state 703, shocked sound]
type = playsnd
triggerall = anim = 704
trigger1 = animelemtime(25) = 0
value = 703,1

[state 703, rise]
type = velset
triggerall = anim = 704
trigger1 = animelemtime(28) = 0
y = -1

[State 200, 1]
type = PlaySnd
triggerall = anim = 704
trigger1 = animelemtime(28) = 0
trigger2 = animelemtime(31) = 0
value = 0, 2
channel = 1

[state 703, broom]
type = helper
triggerall = anim = 704
trigger1 = animelemtime(31) = 0
stateno = 70301
id = 70301
postype = p1
pos = 0,0
sprpriority = 1
name = "broom"
ownpal = 1


[state 703, explod]
type = explod
triggerall = anim = 704
trigger1 = animelemtime(31) = 0
anim = 70402
id = 70402
postype = p1
pos = 0,0
ownpal = 1
sprpriority = 1
bindtime = -1
removetime = -2


[state 703, ygravity]
type = veladd
triggerall = anim = 704
trigger1 = animelemtime(32) >= 0
y = .30

[state 703, land]
type = changeanim
triggerall = anim = 704
trigger1 = pos y >= 0 && vel y > 0
value = 705

[state 703, ystop]
type = velset
triggerall = anim = 705
trigger1 = animelemtime(1) = 0
y = 0

[state 52, Land FX]
type = helper
triggerall = anim = 705
trigger1 = animelemtime(1) = 0
name = "LandFX"

StateNo = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State -3, Landing Sound]
type = PlaySnd
triggerall = anim = 705
trigger1 = animelemtime(1) = 0
value = 40, 0

[state 703, explod]
type = explod
triggerall = anim = 705
trigger1 = animelemtime(7) = 5
anim = 70500
id = 70500
postype = p1
pos = 0,0
ownpal = 1
bindtime = -1
sprpriority = 3
removetime = -2

[state 703, floorlevel]
type = posset
trigger1 = pos y > 0
y = 0


[state 700, changestate]
type = changestate
triggerall = anim = 705
trigger1 = animtime  = 0
value = 0
ctrl = 0
;---------------------------------------------------------------------------
;SSJ transformation Intro
[Statedef 704]
type = S
physics = N
anim = 706
sprpriority = 2

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[State 190, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 706

[State 3000, Cut Out intro]
type = helper
trigger1 = time=0
helpertype = normal
stateno = 70401
ID = 70401
name = "cut_out"
postype = p1
pos = 0,0
ownpal = 1
persistent = 0

[State 800, VarSet]
type = VarAdd
trigger1 = time>100 && animelemtime(97)<1
var(26) = 1

[State 800, VarSet]
type = VarAdd
trigger1 = animelemtime(97)>=1
var(26) = -2


[state 704, Aura FX]
type = explod
trigger1 =  animelemtime(9) = 0
anim = 707
id = 707
pos = 0,0
postype = P1
sprpriority = 2
ownpal = 1
removetime = -1
persistent = 0
ignorehitpause = 1

[State 1000, shake]
type = EnvShake
triggerall = !(time%4)
trigger1 = animelemtime(9)>=0 && animelemtime(135) < 0
time = 4
freq = 80
ampl = 1+0.02*time

[State 4500, 1];power up SFX
type = PlaySnd
trigger1 = animelemtime(9)=0
value = 193,1
volume = 500
channel = 17

[state 3000, WOAAAAAAAAAAAAAAAAA!]
type = playsnd
trigger1 = animelemtime(9) = 0
value = 8,8
channel = 0
volumescale = 255

[State 1900, dust]
type = explod
trigger1 = animelemtime(9)=0
anim = 908
id = 908
pos = 23,5
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = -1
removetime = -1

[state 704, Hair FX]
type = Helper
trigger1 =  animelemtime(41) = 0
stateno = 70400
id = 70400
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
persistent = 0
ignorehitpause = 1

[state 704, removeexplod] ;Aura Disappears
type = removeexplod
trigger1 = animelemtime(78) = 0
id = 707

[State 200, BGPalFX]
type = BGPalFX
trigger1 = time>=100 && time < 425
time = 1
add = -ceil(0.4*var(26)), -ceil(0.4*var(26)), -ceil(0.4*var(26))
mul	= 256,256,256
invertall = 0
color = 256

[State 0,from sky lightning]
type = explod
triggerall = time>=150 && time < 425
trigger1 = gametime%(100-var(26)/5) = 0
anim = 70200+random%6
sprpriority = 7
postype = p1
pos = 0,ceil(pos y)
facing = ifelse(random<500,-1,1)
random = 160,0
scale = 1,2
pausemovetime = -1
supermovetime = -1
ownpal = 1

[State 0, lightning sound]
type = playsnd
triggerall = time>=150 && time < 425
trigger1 = gametime%(100-var(26)/5) = 0
value = 2400,3
volume = -170-(32*numexplod)
;freqmul = .9 + (random/5000.0)
channel = 20

[State 1211, BGPalFX]
type = BGPalFX
triggerall = time>=150 && time < 425
trigger1 = gametime%(100-var(26)/5) = 0
time = 3
color = 0
invertall = 1

[State 4500, 1]; SSJ power up SFX
type = PlaySnd
trigger1 = animelemtime(69)=0
value = 193,3
channel = 20

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(69)=0
id = 905
name = "Charge"
pos = -24,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
size.xscale = 1.1
size.yscale = 1.1

[State 4500, 1];Small sound
type = PlaySnd
trigger1 = animelemtime(69)=0
value = 704,0
volumescale = 255

[State 4500, 2];long sound
type = PlaySnd
trigger1 = animelemtime(70)=0
value = 8,0
loop = 1
pan = 1
channel = 3

[state 3000, HEUGHAAAAAAAAAAAAAA!]
type = playsnd
trigger1 = animelemtime(78) = 0
value = 8,10
channel = 0
volumescale = 255

[State 1001, stopsnd]
type = stopsnd
trigger1 = animelemtime(135) = 0
channel = 3


[state 3000, Hmph]
type = playsnd
trigger1 = animelemtime(142) = 0
value = 181,7
channel = 0


[state 700, changestate]
type = changestate
trigger1 = animtime  = 0
value = 0
ctrl = 0

;---------------------------------------------------------------------------
;Short SSJ transformation Intro
[Statedef 705]
type = S
physics = N
anim = 713
sprpriority = 2

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[State 190, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 713

[State 800, VarSet]
type = VarSet
trigger1 = !time
var(26) = 0

[State 3000, Cut Out intro]
type = helper
trigger1 = time=0
helpertype = normal
stateno = 70500
ID = 70500
name = "cut_out"
postype = p1
pos = 0,0
ownpal = 1
persistent = 0

[state 705, closed eyes]
type = explod
trigger1 = !time
anim = 714
postype = p1
pos = 0,0
sprpriority = 3
removetime = -2
bindtime = -1

[State 200, Sky darkens]
type = BGPalFX
trigger1 = time > 50 && time <= 183
time = 1
add = -(var(26)-50), -(var(26)-50), -(var(26)-50)
mul	= 256,256,256
invertall = 0
color = 256

[State 800, VarSet]
type = VarAdd
trigger1 = time <= 183
var(26) = 1

[State 705, HMPH]
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 181,6+random%3
channel = 17

[State 705, HMPH]
type = PlaySnd
trigger1 = animelemtime(2)=0
value = 703,1
channel = 19

[State 4500, 1]; SSJ power up SFX
type = PlaySnd
trigger1 = animelemtime(6)=0
value = 193,3
channel = 20

[State 200, Sky lightens]
type = BGPalFX
trigger1 = time > 183
time = 1
add = -(var(26)-50), -(var(26)-50), -(var(26)-50)
mul	= 256,256,256
invertall =0
color = 256

[State 800, VarSet]
type = VarAdd
trigger1 = time > 183
var(26) = -2

[State 1900, Aura helper]
type = Helper
trigger1 = animelemtime(6)=0
id = 905
name = "Charge"
pos = -24,-2
postype = P1
stateno = 905
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
size.xscale = 1.1
size.yscale = 1.1

[State 1900, dust]
type = explod
trigger1 = animelemtime(6)=0
anim = 908
id = 908
pos = 23,5
sprpriority = 4
bindtime = -1
ownpal = 1
removeongethit = 1
ignorehitpause = 1
facing = -1
removetime = -1

[state 700, changestate]
type = changestate
trigger1 = animtime  = 0
value = 0
ctrl = 0
;---------------------------------------------------------------------------
;Whis Intro
[Statedef 706]
type = S
physics = N
anim = 715
ctrl = 0

[state 700, intro]
type = assertspecial
trigger1 = 1
flag = intro

[state 706, noshadow]
type = assertspecial
trigger1 = animelemtime(4) < 0
trigger1 = anim = 715
flag = noshadow

[state 706, Whis]
type = helper
trigger1 = !time
stateno = 70600
id = 70600
pos = 0,0
postype = p1
sprpriority = -1
persistent = 0

[state 706, statetypeset]
type = statetypeset
trigger1 = !time
statetype = A

[state 706, posadd]
type = posadd
trigger1 = !time
y = -60

[state 706, travel sound]
type = playsnd
trigger1 = !time
value = 706,0
volumescale = 0
channel = 17

[state 706, beam of light]
type = explod
trigger1 = time = 30
anim = 718
id = 718
pos = 0,-473
postype = p1
sprpriority = 5
scale = 1.4,1 
removetime = -2
persistent = 0


[state 706, crash sound]
type = playsnd
trigger1 = !time
value = 706,1
channel = 19

[state 706, initial shake]
type = envshake
trigger1 = time%4 = 0
trigger1 = time < 110
time = 4
ampl = 4 
freq = 20

[state 706, beam disperse shake]
type = envshake
trigger1 = time%4 = 0
trigger1 = time >= 110
trigger1 = ((time - 110) / 10) < 4
time = 4
ampl = 4 - ((time - 110) / 10)
freq = 20

[state 706, teleport sound]
type = playsnd
trigger1 = animelemtime(2) = 0
trigger1 = anim = 715
value = 2302,0

[state 706, veladd]
type = veladd
trigger1 = time >= 180
trigger1 = animelemtime(5) >= 0
trigger1 = pos y < 0
y = .05

[state 706, changeanim]
type = changeanim
trigger1 = pos y >= 0 && vel y > 0
value = 716

[state 420, rise]
type = statetypeset
trigger1 = pos y >= 0 && vel y > 0
physics = S
statetype = S

[state 52, Land FX]
type = helper
trigger1 = anim = 716 && animelemtime(1) = 1
name = "LandFX"

StateNo = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State -3, Landing Sound]
type = PlaySnd
trigger1 = anim = 716 && animelemtime(1) = 1
value = 40, 0

[state 706 , velset]
type = velset
trigger1 = pos y >= 0 && vel y > 0 
y = 0

[state 706, posset]
type = posset
trigger1 = pos y > 0
y = 0

[state 700, changestate]
type = changestate
trigger1 = animtime  = 0
trigger1 = anim = 716
value = 0
ctrl = 0

;---------------------------------------------------------------------------
;Whis Helper
[Statedef 70600]
type = A
physics = N
anim = 719
sprpriority = -1
ctrl = 0

[state 706, noshadow]
type = assertspecial
trigger1 = animelemtime(7) < 0 || animelemtime(15) >= 0
flag = noshadow


[state 70600, bindtoroot]
type = bindtoroot
trigger1 = time < 6
pos = 0,0

[state 706, teleport sound]
type = playsnd
trigger1 = animelemtime(5) = 0
trigger2 = animelemtime(15) = 0
value = 2302,0

[state 706, snack]
type = explod
trigger1 = animelemtime(9) = 75
anim = 717
id = 717
pos = 0,0
postype = p1
sprpriority = 0
removetime = -2
persistent = 0


[state 70600, destroy]
type = destroyself
trigger1 = !animtime
trigger2 = root, stateno != 706
;---------------------------------------
;Emo Z Counter
[Statedef 749]
type		= S
physics		= S
movetype		= I
anim		= 758
ctrl		= 0
velset		= 0,0
poweradd		= -1000
sprpriority	= 2
facep2		= 1


[State 750, Punches or Kicks?]
type		= VarSet
trigger1		= !Time && !AILevel
var(17)		= IfElse(((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90000006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90000004))) && ((ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2)),1,2)
ignorehitpause	= 1

[State 750, Punches or Kicks?]
type		= VarSet
trigger1		= !Time && AILevel
var(17)		= IfElse(p2bodydist x > 80, 1,2)
ignorehitpause	= 1



[State 750, NotHitBy]
type		= NotHitBy
trigger1		= 1
value		= SCA
[State 750, ECreset]
type		= PalFX
trigger1		= !Time
add                 = 255,255,255
time		= 3
[State 750, EnvColor]
type		= EnvColor
trigger1		= !Time
value		= 240,240,240 
time		= 1
[State 750, SuperPause]
type		= SuperPause
trigger1		= !Time
time		= 20
movetime		= 20
anim		= -1
sound		= s750,0
p2defmul		= 1
darken		= 0

[State 220, 1]
type = PlaySnd
trigger1 = !time
value = 4100, 5

[State 750, Explod] ;Counter Lightning
type		= Explod
trigger1		= !Time
anim		= 753
sprpriority	= 10
pos		= 40, Floor(-ScreenPos Y)
postype		= P1
persistent	= 0
pausemovetime	= -1
supermove		= 1
ownpal		= 1


[State 750, end]
type		= ChangeState
trigger1		= !AnimTime
value		= IfElse(var(17)=1,751,752)
;---------------------------------------
;Z Counter
[Statedef 750]
type		= S
physics		= S
movetype		= I
anim		= 750
ctrl		= 0
velset		= 0,0
poweradd		= -1000
sprpriority	= 2
facep2		= 1


[State 750, Punches or Kicks?]
type		= VarSet
trigger1		= !Time && !AILevel
var(17)		= IfElse(((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90000006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90000004))) && ((ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2)),1,2)
ignorehitpause	= 1

[State 750, Punches or Kicks?]
type		= VarSet
trigger1		= !Time && AILevel
var(17)		= IfElse(p2bodydist x > 70, 1,2)
ignorehitpause	= 1

[State 750, NotHitBy]
type		= NotHitBy
trigger1		= 1
value		= SCA
[State 750, ECreset]
type		= PalFX
trigger1		= !Time
time		= 1
[State 750, EnvColor]
type		= EnvColor
trigger1		= !Time
value		= 240,240,240 
time		= 1
[State 750, SuperPause]
type		= SuperPause
trigger1		= !Time
time		= 20
movetime		= 20
anim		= -1
sound		= s750,0
p2defmul		= 1
darken		= 0



[State 750, Explod] ;Counter Lightning
type		= Explod
trigger1		= !Time
anim		= 753
sprpriority	= 10
pos		= 40, Floor(-ScreenPos Y)
postype		= P1
persistent	= 0
pausemovetime	= -1
supermove		= 1
ownpal		= 1


[State 750, end]
type		= ChangeState
trigger1		= !AnimTime
value		= IfElse(var(17)=1,751,752)
;---------------------------------------------------------------------------
;NEW NEW Punch Z counter
[Statedef 751]
type		= S
physics		= S
movetype		= A
anim                = ifelse(var(51) = 1,749,751)
ctrl		= 0
velset		= 0,0
juggle = 15
sprpriority	= 2


[State 1000, snd]
type = playsnd
trigger1 = time = 4
value = 1100,0


[State 220, BEGONE]
type = playsnd
trigger1 = animelem=4 
value = 3,25
channel = 0

[state 1100, flash white]
type = palfx
triggerall = animelemtime(14) = 1
trigger1 = var(35) = 1 
add = 255,255,255
time = 3

[state 1000, varset]
type = varset
triggerall = var(35) = 1
trigger1 = animelemtime(14) = 1
var(35) = 0


[state 3101, Smoke FX]
type = explod
trigger1 = animelemtime(2) = 0
anim = 30100
id = 30100
pos = 0,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
bindtime = -1
ignorehitpause = 0
scale = 1,1



[State 200, 1]
type = PlaySnd
trigger1 = animelem = 5
value = 0, 2
channel = 1

[State 200, velset]
type = Velset
trigger1 = time < 12 && animelem != 1
x = 25

[state 300, velmul]
type = velmul
trigger1 = time > 15
x = .50

[state 300, nothitby]
type = nothitby
trigger1 = time <= 15
value = SCA

[State 200, 1]
type = HitDef
triggerall = !movecontact
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(fvar(11) * 35 < 8, 8, fvar(11) * 35)), 6
animtype = Hard	
guardflag = MA
hitflag = MAF
pausetime = 14,15
guard.pausetime = 15,15
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-75
hitsound = s1421, 0
guardsound = S6,1
ground.type = High
ground.slidetime = 15
ground.hittime  = 18
ground.velocity = -1,-12
guard.velocity = -9
fall = 1
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -1,-12
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,40,210), 35
givepower = 35,35
kill = 0
yaccel = 0.5
envshake.time = 16
envshake.freq = 80
envshake.ampl = 9
ID = 7550

[state 751, max scaling]
type = varset
trigger1 = movehit = 1
fvar(13) = 23
ignorehitpause = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(7)>=0
value = 0

[state 300, targetstate]
type = targetstate
trigger1 = movehit
trigger1 = numtarget(7550)
trigger1 = !(target, ishelper)
value = 7550
ignorehitpause = 1
persistent = 0



[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;----------------------------
;Hit by Punch Zetto
[statedef 7550]
type = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
facep2 = 1

[state 7550, changeanim2]
type = changeanim2
trigger1 = !time
value = 651

[State -2, CAPCOM Blue Shock PalFX]
type = PalFX
trigger1 = 1
time = 1
add = Ceil(100 -80 * sin(2 * pi * gametime / 10)),Ceil(100 -80 * sin(2 * pi * gametime / 10)),Ceil(180 -80 * sin(2 * pi * gametime / 10))
color = 0 
invertall = 0
ignorehitpause = 1

[state 2060, changeanim]
type = changeanim
trigger1 = time = 14
value = IfElse(selfanimexist(5937),5937,5030)

[State 4005, vel]
type = velset
triggerall = anim != 651
trigger1 = AnimElemtime(2)=0
x = -3
y = -9
persistent = 0

[State 6100, turning snd]
type = PlaySnd
triggerall = anim=5937
trigger1 = !time
trigger2 = time = 10
trigger3 = time = 20
trigger4 = time = 30
trigger5 = time = 40
trigger6 = time = 50
trigger7 = time = 60
trigger8 = time = 70
trigger9 = time = 80
value = 21,1
persistent = 1
 
[State 9011, VelAdd]
type = VelAdd
triggerall = time > 14
trigger1 = Pos Y < 0
y = 0.35

[state 1060, changestate]
type = selfstate
trigger1 = pos Y >= 0 && Vel Y > 0
value = 5100
;---------------------------------------
;NEW (old) Punch Z Counter
[Statedef 7511]
type		= S
physics		= N
movetype		= A
anim                = 751
ctrl		= 0
velset		= 0,0
sprpriority	= 2

[state 751, muteki]
type = nothitby
trigger1 = time <= 22 || vel y > 0
value = SCA

[State 200, 1]
type = PlaySnd
triggerall = anim = 751
trigger1 = animelem = 4
value = 0, 2

[state 420, rise]
type = statetypeset
triggerall = anim = 751
trigger1 = animelemtime(4) = 0
physics = N
statetype = A


[state 420, velset]
type = velset
triggerall = anim = 751
trigger1 =  animelemtime(4) = 0
x = 1.5
y = -8
persistent = 0

[state 420, veladd]
type = veladd
triggerall = anim = 751
trigger1 = animelemtime(4) >= 0
y = 0.4

[State 420, 3]
type = HitDef
trigger1 = hitcount < 11
attr = A, NA
damage = 8, 0
hitflag = MAF
guardflag = MA
pausetime = 2,2
guard.pausetime = 2,2
sparkno = s7010
guard.sparkno = s7000
sparkxy = -20,-65
hitsound   = s5, 0
guardsound = S6,1
animtype = Up
ground.type = High
ground.slidetime = 12
ground.hittime = 30
ground.velocity = -.5,-8
guard.velocity = -7
kill = 0
air.velocity = -.5,-8
fall = 1
fall.recover = 0
air.animtype = back
getpower= 0, 0
givepower = 10,10
yaccel = 0.45

[State 420, 3]
type = HitDef
trigger1 = hitcount = 11
attr = A, NA
damage = 20, 0
hitflag = MAF
guardflag = MA
pausetime = 25,25
guard.pausetime = 25,25
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-65
hitsound   = s5, 2
guardsound = S6,1
animtype = Up
ground.type = High
ground.slidetime = 12
ground.hittime = 30
fall.recover = 0
ground.velocity = -.5,-8
guard.velocity = -7
kill = 0
air.velocity = -.5,-8
fall = 1
air.animtype = back
envshake.time = 25
envshake.ampl = 3
envshake.freq = 50
getpower= 0, 0
givepower = 20,20
yaccel = 0.45


[state 751, changeanim]
type = changeanim
triggerall = anim != 48
trigger1 = pos y >= 0 && vel y > 0
value = 48

[state 420, rise]
type = statetypeset
trigger1 = pos y >= 0 && vel y > 0
physics = S
statetype = S

[state 52, Land FX]
type = helper
trigger1 = anim = 48 && animelemtime(1) = 1
name = "LandFX"
StateNo = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State -3, Landing Sound]
type = PlaySnd
trigger1 = anim = 48 && animelemtime(1) = 1
value = 40, 0

[state 751, posset]
type = posset
trigger1 = pos y > 0
y = 0

[state 751, velset]
type = velset
trigger1 = pos y >= 0 && vel y > 0
y = 0

[state 751, changestate]
type = changestate
triggerall = anim = 48
trigger1 = !animtime
value = 0
ctrl = 1
;---------------------------------------
;(Old) Punch Z Counter
[Statedef 7510]
type		= S
physics		= N
movetype		= A
anim                = 751
ctrl		= 0
velset		= 0,0
sprpriority	= 2

[state 751, velset]
type = velset
trigger1 = !time
x = 1
y = -2


[state 751, velset]
type = velset
trigger1 = animelemtime(3) = 0
x = 0
y = 0


[State 193, Explod]
type = Explod
trigger1 = animelemtime(6) = 0 
anim = 754
ID = 754
pos = 10,-70
postype = p1  ;p2,front,back,left,right
facing = 1
bindtime = 1
sprpriority = 4
removetime = -2
supermovetime = 40
persistent = 0
scale = .8,.8

[State 193, Explod]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 756
ID = 756
pos = 10,-70
postype = p1  ;p2,front,back,left,right
facing = 1
bindtime = 1
sprpriority = 4
removetime =-2
supermovetime = 40
persistent = 0
scale = .8,.8

[State 250, 1]
type = PlaySnd
trigger1 = animelem = 6
value = 2,12
persistent = 0

[State 1061, Hitdef]
type = HitDef
trigger1 = animelem = 6
attr = S, HP
animtype  = hard
damage    = ceil(ifElse(root,fvar(11) * 66 < 30, 30, root,fvar(11) * 66)),20
priority  = 4,Hit
guardflag = M
hitflag = MAF
pausetime = 0,10
guard.pausetime = 0,0
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0,0
hitsound   = s2,8
guardsound = S5,20
ground.type = high
air.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 12
ground.velocity = -4,-4.5
guard.velocity = -7.5
air.velocity = -4,-4
airguard.velocity = -5, -4
kill = 0
envshake.time = 10
envshake.ampl = 4
envshake.freq = 176
fall.envshake.time = 10
fall.envshake.ampl = 4
fall.envshake.freq = 176
yaccel = 0.5
fall = 1
air.fall = 1
fall.recover = 0
p1sprpriority = 3
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
getpower = 0,0
givepower = 35,35
persistent = 0
ID = 3000
P2Facing = 1


[State 750, end]
type		= ChangeState
trigger1		= !AnimTime
value		= 50
;---------------------------------------
;Kick Z Counter
[Statedef 752]
type		= S
physics		= S
movetype		= A
anim                = ifelse(var(51) = 1,759,752)
ctrl		= 0
juggle              = 15
velset		= 0,0
sprpriority	= 2

[State 750, ECreset]
type		= PalFX
triggerall          = var(51) = 1
trigger1		= animelemtime(4) = 0
add                 = 255,255,255
time		= 3

[State 220, 1]
type = PlaySnd
triggerall = var(51) = 1
trigger1 = animelemtime(4) = 0
value = 3100, 0


[State 220, 1]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 2
channel = 1


[State 756, 3]
type = HitDef
trigger1 = AnimElem = 4
attr = A, NA
;damage = 50,0
damage = ceil(ifElse(fvar(11) * 50 < 7, 7, fvar(11) * 50)), 0
hitflag = MAF
guardflag = M
priority = 4, Hit
pausetime = 13,13
sparkno = s7030
guard.sparkno = s7000
sparkxy = -20,-55
hitsound   = s5, 5
guardsound = S6,1
animtype = Up
ground.type = High
ground.slidetime = 21
ground.hittime = 12
guard.hittime = 21
ground.velocity = -1,-5
guard.velocity = -4
air.velocity = ifelse(p2movetype=H,-3,-1),ifelse(p2movetype=H,-5,-7)
fall = 1
fall.recover = 0
air.animtype = back
getpower= 0,0
givepower = 35,35
envshake.time = 16
envshake.freq = 60
envshake.ampl = 4
yaccel = 0.5
p2stateno = 753
kill = 0

[state 751, max scaling]
type = varset
trigger1 = movehit = 1
fvar(13) = 23
ignorehitpause = 1

[State 752, changeanim]
type = ChangeAnim
trigger1 = AnimElemTime(4) > 0 && AnimElemTime(5) <= 0
trigger1 = movecontact
ignorehitpause = 1
persistent = 0
value = 752
elem = 5

[state 752, playsnd]
type = playsnd
trigger1 = animelem = 3
value = 3,13
channel = 0

[state 751, changestate]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;-----------------------------------------------
;Kick Counter Fly Away
[Statedef 753]
type = A
movetype = H
physics = N
anim = ifelse(selfanimexist(5052),5052,5030)
ctrl = 0
velset = -10, -7
facep2 = 1

[State 9011, VelAdd]
type = VelAdd
trigger1 = (Pos Y < 0)
y = 0.35

[State 9011, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 9011, ChangeState]
type = SelfState
trigger1 = (Pos Y >= 0) && (Vel Y > 0)
value = 5100

;Emo Air Z Counter
[Statedef 759]
type = A
physics = N
movetype = I
anim = 760
ctrl = 0
;velset = 0,0
poweradd = -1000
sprpriority = 2
facep2 = 1

[State 2302, pause]
type = pause
trigger1 = !time
time = 7
movetime = 7
ignorehitpause = 1

[State 220, 1]
type = PlaySnd
trigger1 = !time
value = 4100, 5

[State 750, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 750, ECreset]
type = palfx
trigger1 = !time
add = 255,255,255
time = 3

[State 900, 2]
type = EnvColor
trigger1 = !Time
value = 240,240,240 
time = 1

[State 900, 3] ;Counter Lightning
type = Explod
trigger1 = !Time
anim = 753
sprpriority = 10
pos = 40, Floor(-ScreenPos Y)
postype = P1
persistent = 0
pausemovetime = -1
supermove = 1
ownpal = 1

[State 750, superpause]
type = superpause
trigger1 = !time
time = 20
movetime = 20
anim = -1
sound = s750,0
p2defmul = 1
darken = 0

[State 750, end]
type = changestate
trigger1 = !animtime
value = 762
;===========================================================================
; AERIAL ZETTO COUNTER
; counter state : 760
; smash punch : 761
; Smash Kick : 762
; Lightning anim : 753
;===========================================================================

;Air Z Counter
[Statedef 760]
type = A
physics = N
movetype = I
anim = 122
ctrl = 0
;velset = 0,0
poweradd = -1000
sprpriority = 2
facep2 = 1

[State 2302, pause]
type = pause
trigger1 = !time
time = 7
movetime = 7
ignorehitpause = 1

[State 750, Punches or Kicks?]
type		= VarSet
trigger1		= !Time && !AILevel
var(17)		= IfElse(((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90000006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90000004))) && ((ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2)),1,2)
ignorehitpause	= 1



[State 750, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA

[State 750, ECreset]
type = palfx
trigger1 = !time
time = 1

[State 900, 2]
type = EnvColor
trigger1 = !Time
value = 240,240,240 
time = 1

[State 900, 3] ;Counter Lightning
type = Explod
trigger1 = !Time
anim = 753
sprpriority = 10
pos = 40, Floor(-ScreenPos Y)
postype = P1
persistent = 0
pausemovetime = -1
supermove = 1
ownpal = 1

[State 750, superpause]
type = superpause
trigger1 = !time
time = 20
movetime = 20
anim = -1
sound = s750,0
p2defmul = 1
darken = 0

[State 750, end]
type = changestate
trigger1 = !animtime
value = IfElse(var(17)=1,761,762)
;-------------------------------------------
;Air Punch Z Counter
[Statedef 761]
type = A
physics = A
movetype = A
velset = 0,-1
anim = 620
ctrl = 0

[State 220, snd]
type = playsnd
trigger1 = animelem=3 && random<500
value = 3,20+random%2
channel = 0

[State 620, 2]
type = PlaySnd
trigger1 = AnimElem = 4
value = 0, 2

[State 620, 3]
type = HitDef
trigger1 = AnimElem = 8
attr = A, NA
damage = ceil(ifElse(fvar(11) * 50 < 7, 7, fvar(11) * 50)), 0
hitflag = MAF
guardflag = HA
animtype = Hard
pausetime = 16,16
sparkno = s7030
guard.sparkno = s7000
sparkxy = -30,-50
hitsound   = s5,2
guardsound = S6,1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -5
air.velocity = -7,10
envshake.time = 20
envshake.freq = 60
envshake.ampl = 8
kill = 0
airguard.cornerpush.veloff= 0
air.animtype = Back
fall.animtype = Back
getpower= 0, 0
givepower = 35,35
yaccel = 0.5
fall = 1
fall.recover = 0

[state 761, changestate]
type = changestate
trigger1 = !animtime
value = 50
;-------------------------------------------
;Air Kick Z Counter
[Statedef 762]
type = A
physics = A
movetype = A
anim = ifelse(var(51) = 1,761,650)
ctrl = 0

[State 650, 3]
type = HitDef
trigger1 = AnimElem = 4
attr = A, NA
damage = ceil(ifElse(fvar(11) * 43 < 7, 7, fvar(11) * 43)), 0
hitflag = MAF
guardflag = HA
animtype = Hard
pausetime = 16,16
sparkno = s7030
guard.sparkno = s7000
sparkxy = -30,-55
hitsound   = s5,5
guardsound = S6,1
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -5
kill = 0
air.velocity = -6,8
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
fall = 1
fall.recover = 0
p2facing = 1
airguard.cornerpush.veloff= 0
air.animtype = Back
fall.animtype = Back
getpower= 0, 0
givepower = 35,35
yaccel = 0.5
fall = 1


[state 761, changestate]
type = changestate
trigger1 = !animtime
value = 50

;===========================================================================
; DASH COLLISION
; Actual collision with enemy:	950
; Grabbing enemy:			951
; Returning to state 0:		952
;===========================================================================

;Dash collision
[Statedef 950]
type		= S
physics		= S
movetype		= A
anim		= 950
ctrl		= 0
velset		= 0,0
sprpriority	= 2

[State 950, Smoke Explod]; Smoke FX
type		= Explod
trigger1		= Time = 5 && NumExplod(956)=0 && TeamSide = 1
anim		= 956
pos		= 45,0
postype		= p1
removetime	= -2
scale		= 1,1
sprpriority	= 0
id		= 956
bindtime		= -1
ownpal		= 1
ignorehitpause	= 1
pausemovetime	= -1
;[State 950, Collision Explod solid]; Collision FX
;type		= Explod
;triggerall	= var(2) = 0 ;solid
;trigger1		= Time = 5 && NumExplod(955)=0 && TeamSide = 1
;anim		= 955
;pos		= 45,-56
;postype		= p1
;removetime	= 80
;supermove		= 1
;sprpriority	= 0
;id		= 955
;bindtime		= -1
;ontop		= 1
;ownpal		= 1
;ignorehitpause	= 1
;pausemovetime	= -1
;[State 950,  Collision Explod transparent]; Collision FX
;type		= Explod
;triggerall	= var(2) = 1 ;transparent
;trigger1		= Time = 5 && NumExplod(955)=0 && TeamSide = 1
;anim		= 958
;pos		= 45,-56
;postype		= p1
;removetime	= 80
;supermove		= 1
;sprpriority	= 0
;id		= 955
;bindtime		= -1
;ontop		= 1
;ownpal		= 1
;ignorehitpause	= 1
;pausemovetime	= -1
;
;[state 950, scale FX]
;type		= ModifyExplod
;trigger1		= NumExplod(955)
;scale		= 0.9+0.1*sin(0.1*time),0.9+0.1*sin(0.1*time)
;id		= 955

[State 950, Explod]; White FG
type		= Explod
trigger1		= Time = 5 && NumExplod(957)=0 && TeamSide = 1
anim		= 957
pos		= 0,0
postype		= left
removetime	= 3
scale		= 1,1
sprpriority	= 7
id		= 957
bindtime		= -1
ontop		= 1
ownpal		= 1
ignorehitpause	= 1
pausemovetime	= -1

[State 950, Notification]
type		= helper
trigger1		= Time = 5 && numhelper(13200)=0 && TeamSide = 1
stateno		= 13200
ID		= 13200
name		= "notif-col"
postype		= p1
pos		= 45,-57
ownpal		= 1
pausemovetime	= 65535
supermovetime	= 65535
ignorehitpause	= 1
facing		= -1

[State 950, PosAdd 1]
type		= PosAdd
trigger1		= P2bodydist X < 10
X		= -8
[State 950, PosAdd 2]
type		= PosAdd
trigger1		= P2bodydist X < 25
X		= -5
[State 950, PosAdd 3]
type		= PosAdd
trigger1		= P2bodydist X < 35
X		= -2
[State 950, PosAdd 4]
type		= PosAdd
trigger1		= P2bodydist X < 40
X		= -1

[State 950, Width]
type		= Width
trigger1		= 1
edge		= 50,40

[State 950, Grab SND]
type		= PlaySnd
trigger1		= Time = 5
value		= 800,1

[State 950, Voice];Scream
type		= PlaySnd
trigger1		= Time = 5
value		= 8,2
volumescale		= 255

[State 950, Explosion SND]
type		= PlaySnd
trigger1		= Time = 5 && TeamSide = 1
value		= 950,0

[State 950, 1];Scream
type		= PlaySnd
trigger1		= Time = 5
value		= 3,11
volumescale		= 255

[State 950, shake]
type		= EnvShake
trigger1		= !(time%4)
time		= 8
freq		= 20
ampl		= 1+0.1*time

[State 950, count]
type		= VarSet
trigger1		= !time
var(30)		= 0
[State 950, count]
type		= VarAdd
triggerall	= time < 75
trigger1		= command="x" || command="y" || command="z" || command="a" || command="b" || command="c" || command="start"
trigger2		= command = "up" || command = "down" || command = "back" || command = "fwd"
var(30)		= 1

[State 950, ChangeState - Winning]
type		= Changestate
triggerall	= time = 80
trigger1		= var(30) > enemy,var(30)
value		= 951

[State 950, ChangeState - Losing]
type		= Changestate
triggerall	= time = 80
trigger1		= var(30) < enemy,var(30)
value		= 0
ctrl		= 0	;so you don't get away with the punishment >:)

[State 950, ChangeState - Draw]
type		= Changestate
triggerall	= time = 80
trigger1		= var(30) = enemy, var(30)
value		= 105
ctrl		= 0

[State 950, ChangeState - ABORT];this was missing from the HDBZ engine tweaks/fixes topic. Copied from GotenksZ2.
type		= Changestate
trigger1		= P2StateNo != 950 && P2StateNo != 951 && Time>=4 && Time<50
value		= 952
ctrl		= 1

;-----------------------------------------
;Grabbing
[Statedef 951]
type		= S
movetype		= A
physics		= S
juggle		= 15
velset		= 0,0
ctrl		= 0
anim		= 951
sprpriority	= 1
facep2		= 1
poweradd		= 20

[State 800, Don't Guard]
type		= attackdist
trigger1		= 1
value		= 0

[State 800, hit]
type		= HitDef
trigger1		= AnimElem = 1
attr		= S,NT
hitflag		= M- 
priority		= 1,Miss 
sparkno		= -1
p1facing		= 1
p2facing		= 1
guard.dist	= 0
fall		= 0
fall.recover	= 0

[State 0, ChangeState]
type = ChangeState
trigger1 = MoveHit=1
value = 811
ignorehitpause = 1
persistent = 0

[State 951, Abort]
type		= ChangeState
trigger1		= time=5;2
value		= 952
ctrl		= 0
ignorehitpause	= 1

;-----------------------------------------
;Abort Dash Collision
[Statedef 952];to avoid bugs
type		= S
physics		= N
movetype		= A
ctrl		= 1
velset		= 0,0
sprpriority	= 2

[State 952, RemoveExplod]
type		= RemoveExplod
trigger1		= 1
id		= 955
[State 952, RemoveExplod]
type		= RemoveExplod
trigger1		= 1
id		= 956
[State 952, RemoveExplod]
type		= RemoveExplod
trigger1		= 1
id		= 957

[State 952, ChangeState]
type		= ChangeState
trigger1		= 1
value		= 0
ctrl		= 1


;===========================================================================
; CHEAP KO
;===========================================================================

[Statedef 5950]
type = L
physics = S
movetype = H
ctrl = 0
velset = 0,0

[State 5950, 1]
type = HitVelSet
trigger1 = Time = 0
x = 2

[State 5950, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5950, 4]
type = NotHitBy
trigger1 = 1
value = SCA

[State 5950, 4]
type = ChangeAnim
trigger1 = !HitOver
value = IfElse(FVar(1)=0,5000,5020)

[State 190, 4]
type = ChangeAnim
trigger1 = HitOver
value = 5950
persistent = 0

[state 5950, playsnd]
type = playsnd
trigger1 = animelem = 4
trigger1 = anim = 5950
value = 11,3
channel = 0

[State 1100, ChangeState]
type = Changeanim
triggerall = anim = 5950
trigger1 = !Animtime
value = 5952

[state 1100, changestate]
type = changestate
triggerall = anim = 5952
trigger1 = !animtime
value = 5150

;================================================
;Killed by Chou Kamehameha (Fatality)

[Statedef 5941]
type    = S
movetype= I
physics = N
ctrl = 0
sprpriority = 7

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 10000, Explod]; White BG
type = Explod
trigger1 = time = 0
anim = 2763
id = 19875
pos =  160,120
postype = left
sprpriority = 7
bindtime = -1
ownpal = 1
removetime = -2
pausemovetime = 999999
supermovetime = 999999
scale = 1.50,1.50
ignorehitpause = 1
persistent = 0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3000, invisibleanim]
type = ChangeAnim
trigger1 = !time
Value = 15999
ignorehitpause = 1

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = IfElse(time%4=0,-2,IfElse(time%4=2,2,0))
ignorehitpause = 1

[State 3000, Killed sound]
type = PlaySnd
trigger1 = !time
value = 11,0

[State 1315, Vegeta]
type = explod
trigger1 = !time
anim = 5941
ID = 5941
sprpriority=7
postype = p1
pos = 0,-15
removetime=-2
ownpal=0
ignorehitpause=1
bindtime = -1
ontop = 1

[State 13300, Fadeout no selfanim]
type = PalFX
triggerall = !SelfAnimExist(5942)
trigger1 = Time = [0,30]
time = 1
add = -4*(Time),-4*(Time),-4*(Time)

[State 1315, fadeout selfanim]
type = explod
triggerall = SelfAnimExist(5942)
trigger1 = !time
anim = 5942
ID = 5942
sprpriority=7
postype = p1
pos = 0,-15
removetime=-2
ownpal=0
ignorehitpause=1
bindtime = -1
ontop = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time >130
value = 5942

;---------------------------------------------------------------------------------------
;Prevent Freezing from Chou Kmh Kill
[Statedef 5942]
type = S
movetype= H
physics = N
velset = 0,0

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 49999, 1]
type = LifeSet
trigger1 = 1
value = 0

[State 49999, 1]
type = PosSet
trigger1 = 1
y = 9000

[State 49999, 5]
type = ChangeAnim2
trigger1 = !time
value = 15999

[State 444, 0]
type = Changestate
trigger1 = time >=60
value = 5150

;================================================
;Killed by Chou Kamehameha (Fatality) - FULL SCREEN WALT VERSION

[Statedef 5943]
type    = S
movetype= H
physics = N
ctrl = 0
sprpriority = 7
facep2 = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3000, hit anim]
type = ChangeAnim2
trigger1 = Anim!=5943
value = 5943
ignorehitpause = 1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [0,30]
time = 1
add = -8*(Time),-8*(Time),-8*(Time)

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 30
time = 1
add = -256,-256,-256

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = IfElse(time%4=0,-2,IfElse(time%4=2,2,0))
ignorehitpause = 1

[State 3000, moving back]
type = Velset
trigger1 = 1
X = -0.2
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 4500, 1];Dissolve SFX
type = null; PlaySnd
trigger1 = time=30
value = 2950,3
volumescale = 355

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time >99
value = 5942

;================================================
;Killed by Chou Kamehameha (Fatality) - FULL SCREEN WALT VERSION DIAGONAL UP

[Statedef 5944]
type    = S
movetype= H
physics = N
ctrl = 0
sprpriority = 7
facep2 = 1

[State 3000, put up]
type = PosAdd
trigger1 = !time
Y = -15
X = -20
ignorehitpause = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3000, hit anim]
type = ChangeAnim2
trigger1 = Anim!=5943
value = 5943
ignorehitpause = 1

[State 3000, rotate]
type = AngleDraw
trigger1 = Anim=5943
value = -30
ignorehitpause = 1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [0,30]
time = 1
add = -8*(Time),-8*(Time),-8*(Time)

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 30
time = 1
add = -256,-256,-256

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = IfElse(time%4=0,-2,IfElse(time%4=2,2,0))
ignorehitpause = 1

[State 3000, moving back]
type = Velset
trigger1 = 1
X = -0.2
Y = -0.2
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

[State 4500, 1];Dissolve SFX
type = null; PlaySnd
trigger1 = time=30
value = 2950,3
volumescale = 355

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time >99
value = 5942

;================================================
;Killed by Chou Kamehameha (Fatality) - FULL SCREEN WALT VERSION DIAGONAL DOWN

[Statedef 5946]
type    = S
movetype= H
physics = N
ctrl = 0
sprpriority = 7
facep2 = 1

[State 2260, bg]
type = assertspecial
trigger1 = 1
flag = noFG
flag2 = noBG
flag3 = nobardisplay
ignorehitpause = 1

[State 182, 1]
type = screenbound
trigger1 = 1
movecamera = 0,0
value = 1

[State 3000, hit anim]
type = ChangeAnim2
trigger1 = Anim!=5943
value = 5943
ignorehitpause = 1

[State 3000, rotate]
type = AngleDraw
trigger1 = Anim=5943
value = 30
ignorehitpause = 1

[State 13300, Fadeout]
type = PalFX
trigger1 = Time = [0,30]
time = 1
add = -8*(Time),-8*(Time),-8*(Time)

[State 13300, Fadeout]
type = PalFX
trigger1 = Time >= 30
time = 1
add = -256,-256,-256

[State 3000, shaking]
type = PosAdd
trigger1 = time<30
X = IfElse(time%4=0,-2,IfElse(time%4=2,2,0))
ignorehitpause = 1

[State 3000, moving back]
type = Velset
trigger1 = 1
X = -0.2
Y = 0.2
ignorehitpause = 1

[State 3000, nhb]
type = nothitby
trigger1 = 1
time = 1
value = SCA
ignorehitpause = 1

;This prevent freeze game
[State 49999, 5]
type = ChangeState
trigger1 = time >99
value = 5942

;---------------------------------------------------------------------------
;P2 going to the ground from a.SP
[Statedef 651]
type = A
movetype = H
physics = N
ctrl = 0
sprpriority = -1
velset = 0,0

[State 3020, 2]
type = changeanim2
trigger1 = !time
value = 651

[State 4005, vel Y]
type = velset
trigger1 = Time = 15;animelemtime(2)=0
y = 8
x = -4
ignorehitpause = 1

[State 3052, Land]
type = changestate
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 652

;---------------------------------------------------------------------------
;P2 bouncing on the ground from a.SP
[Statedef 652]
type    = L
movetype= H
physics = N
velset = 0,0


[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.95

;[State 5100, 10]
;type = PlaySnd
;trigger1 = Time = 1
;;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;value = f7,2

[State 5100, 5]
type = VelSet
trigger1 = AnimTime = 0
y = -11.5
x = 2

[State 111, 1]
type = StateTypeSet
trigger1 = AnimTime = 0
physics = A

[State 5100, 12]
type = SelfState
trigger1 = AnimTime = 0
value = 5050


;===========================================================================
;SHOCKED BY MASENKO (code by POTS)
;===========================================================================
[Statedef 7696]
type = U
physics = N
movetype = H
ctrl = 0
velset = 0, 0

[State 7696, sts]
type = null;statetypeset
trigger1 = !time
trigger1 = pos y < 0
statetype = A
[State 7696, sts]
type = null;statetypeset
trigger1 = !time
trigger1 = pos y >= 0
statetype = S

[State 7696, Pos]
type = posset
trigger1 = pos y >= 0
y = 0

[State 7696, Anim]
type = changeanim
trigger1 = !time
trigger1 = anim != 7696 && selfanimexist(7696)
value = 7696
[State 7696, Anim]
type = changeanim
trigger1 = !time
trigger1 = anim != 9010 && !selfanimexist(7696) && selfanimexist(9010)
value = 9010
[State 7696, Anim]
type = changeanim
trigger1 = !time
trigger1 = !selfanimexist(7696) && !selfanimexist(9010)
value = IfElse(statetype != A, 5002, 5030)

[State 7696, Var]
type = varset
trigger1 = !time
;trigger1 = gethitvar(hitcount) <=1
sysfvar(4) = 0
ignorehitpause = 1
[State 7696, Var]	;stun time variable?
type = varadd
trigger1 = !time
sysfvar(4) = 20+ceil(enemy,var(26)/0.8)+ 90*(enemy,var(19))	;20+ceil(enemy,var(26)/1.2)+ 90*(enemy,var(19))
ignorehitpause = 1

[State 7696, Var if Gohan performed Finisher 1]
type = varset
trigger1 = (enemy,stateno=[3020,3030])
sysfvar(4) = 0
ignorehitpause = 1

[State 7696, nopalfx]
type = palfx
trigger1 = !time
trigger1 = (anim = 7696 || anim = 9010)
add = 0, 0, 0
time = 1

[State 7696, End]
type = changestate
trigger1 = alive && (anim = 7696 || anim = 9010) && hitshakeover
trigger2 = alive && (anim != 7696 && anim != 9010) && hitshakeover
value = IfElse(statetype = A, 1115020, 5300)
[State 7696, End]
type = selfstate
trigger1 = !alive && (anim != 7696 || anim != 9010) && hitshakeover
value = 5030


;========================< HIT BACK, then dizzy >=============================
;Hit back, then dizzy
[Statedef 1115020]
type = A
movetype = H
physics = N
velset = 0, 0
[State 1115020, Anim]
type = changeanim
trigger1 = 1
value = 5030
[State 1115020, End]
type = changestate
trigger1 = hitshakeover
value = 1115030


[Statedef 1115030]
type = A
movetype = H
physics = N
ctrl = 0
[State 1115030, Accel]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)
[State 1115030, 1] ;Fix by Zzyzzyxx
type = VelSet
trigger1 = !Time
x = GetHitVar(xvel) * facing
y = gethitvar(yvel)
[State 1115030, End]
type = changestate
trigger1 = hitover
trigger2 = vel y > 0 && pos y >= 10
value = 1115050
[State 1115030, End]
type = changestate
trigger1 = !animtime
value = 1115035

;Stand/air hit transition
[Statedef 1115035]
type = A
movetype = H
physics = N
[State 1115035, Anim]
type = changeanim
trigger1 = !time && selfanimexist(5035)
value = 5035
[State 1115035, Accel]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)
[State 1115035, End]
type = changestate
trigger1 = hitover
trigger2 = !animtime
trigger3 = vel y > 0 && pos y >= 10
trigger4 = !time && anim != 5035
value = 1115050

;Air fall
[Statedef 1115050]
type = A
movetype = H
physics = N
[State 1115050, Anim]
type = changeanim
trigger1 = anim = 5035 && !animtime
trigger2 = anim != 5035 && !time
value = 5050
[State 1115050, Anim]
type = changeanim
trigger1 = anim = [5050, 5059]
trigger1 = vel y >= IfElse(anim = 5050, 1, -2)
trigger1 = selfanimexist(anim + 10)
value = anim + 10
persistent = 0
[State 1115050, Accel]
type = veladd
trigger1 = 1
y = gethitvar(yaccel)
[State 1115050, End]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= IfElse((anim = [5051, 5059]) || (anim = [5061, 5069]), 0, 25)
value = 1115100


;Hit ground 1
[Statedef 1115100]
type = L
movetype = H
physics = N
[State 1115100, 1]
type = velset
trigger1 = !time && gethitvar(fall.yvel) = 0 && vel x > 1
x = 1
[State 1115100, Shake]
type = fallenvshake
trigger1 = !time
[State 1115100, Var]
type = varset
trigger1 = !time
sysvar(1) = floor(vel y)
[State 1115100, Anim]
type = ChangeAnim
trigger1 = !time
value = 5100
[State 1115100, Pos]
type = posset
trigger1 = !time
y = 0
[State 1115100, Vel]
type = velset
trigger1 = !time
y = 0
[State 1115100, Vel]
type = velmul
trigger1 = !time
x = 0.75
[State 1115100, End]
type = changestate
trigger1 = !time
trigger1 = gethitvar(fall.yvel) = 0
value = 1115110
;[State 1115100, FX]
;type = gamemakeanim
;trigger1 = time = 1
;value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
;pos = 0, 0
;under = sysvar(1) <= 14
[State 1115100, hurt]
type = hitfalldamage
trigger1 = time = 3
;[State 1115100, snd]
;type = PlaySnd
;trigger1 = Time = 1
;;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;value = F7,2
[State 1115100, freeze]
type = posfreeze
trigger1 = 1
[State 1115100, End]
type = changestate
trigger1 = !animtime
value = 1115101

;Bounce into air
[Statedef 1115101]
type = L
movetype = H
physics = N
[State 1115101, Anim]
type = changeanim
trigger1 = !time
value = 5160
[State 1115101, Vel]
type = hitfallvel
trigger1 = !time
[State 1115101, Pos]
type = posset
trigger1 = !time
y = 20
[State 1115101, accel]
type = veladd
trigger1 = 1
y = 0.4
[State 1115101, End]
type = changestate
trigger1 = vel y > 0 && pos y >= 12
value = 1115110

;Hit ground 2, Liedown
[Statedef 1115110]
type = L
movetype = H
physics = N
[State 1115110, Shake]
type = fallenvshake
trigger1 = !time

[State 1115110, 2]
type = changeanim
trigger1 = !time
value = 5170
[State 1115110, hurt]
type = hitfalldamage
trigger1 = !time
[State 1115110, Pos]
type = posset
trigger1 = !time
y = 0
[State 1115110, Var]
type = varset
trigger1 = !time
trigger1 = gethitvar(fall.yvel) != 0
sysvar(1) = floor(vel y)
;[State 1115110, snd]
;type = PlaySnd
;trigger1 = !time && !sysvar(0)
;;value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)
;value = F7,2
;[State 1115110, FX]
;type = gamemakeanim
;trigger1 = !time && !sysvar(0)
;value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
;pos = 0, 0
;under = sysvar(1) <= 14
[State 1115110, Vel]
type = velset
trigger1 = !time
y = 0
[State 1115110, Anim]
type = changeanim
persistent = 0
triggerall = anim != [5111, 5119]
trigger1 = !animtime
trigger2 = sysvar(0)
value = 5110

[State 1115110, ko]
type = selfstate
triggerall = !alive
trigger1 = !animtime
trigger2 = sysvar(0)
trigger3 = anim = [5110, 5119]
value = 5150
[State 1115110, Var]
type = varset
trigger1 = sysvar(0)
trigger1 = !time
sysvar(0) = 0
[State 1115110, Vel]
type = velmul
trigger1 = 1
x = 0.85
[State 1115110, getup]
type = changestate
trigger1 = alive && time >= 9;const(data.liedown.time)
value = 1115120
persistent = 0

;Getting up
[Statedef 1115120]
type = L
movetype = H
physics = N
[State 1115120, Anim]
type = changeanim
trigger1 = !time
value = 5120
[State 1115120, Vel]
type = velset
trigger1 = !time
x = 0
[State 1115120, NHB]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 1115120, hitfall]
type = hitfallset
trigger1 = !animtime
value = 0   ;1
[State 1115120, NHB]
type = nothitby
trigger1 = 1
value = SCA
time = 1
[State 1115120, dizzy]
type = changestate
trigger1 = !animtime
value = 5300

;========================< DIZZY >=============================
;Dizzy
[Statedef 5300]
type = S
movetype = I
physics = S
velset = 0, 0
anim = 5300
 
[State 5300, Skip]
type = changeanim
trigger1 = animelemtime(animelemno(0)) > 0 && animelemtime(animelemno(0) + 1) < 0
trigger1 = animelemtime(animelemno(0) + 1) >= -enemy,sysvar(2)
value = 5300
elem = animelemno(0) + 1
 
[State 5300, End]
type = selfstate
trigger1 = enemy,sysvar(3) <= 0 || time >= 300 || roundstate != 2
value = 0
ctrl = 1

;========================< THROW ESCAPE >=============================
;Throw Escape
[Statedef 5940]
type = S
movetype = H
physics = S
velset = 0, 0

[State 0, SelfState]
type = SelfState
trigger1 = !Time
value = Cond(Var(0)=1,950,5949)
ignorehitpause = 1

[Statedef 5949]
type = S
movetype = H
physics = S
velset = 0, 0
anim = 5940


[State 950, PosAdd 1]
type		= PosAdd
trigger1            = Time <=10
trigger1		= P2bodydist X < 10
X		= -8
[State 950, PosAdd 2]
type		= PosAdd
trigger1            = Time <=10
trigger1		= P2bodydist X < 25
X		= -5
[State 950, PosAdd 3]
type		= PosAdd
trigger1            = Time <=10
trigger1		= P2bodydist X < 35
X		= -2
[State 950, PosAdd 4]
type		= PosAdd
trigger1            = Time <=10
trigger1		= P2bodydist X < 40
X		= -1

[State 950, Width]
type		= Width
trigger1            = Time <=10
edge		= 50,40
 
[State 41, Train]
type = AfterImage
triggerall = var(51) != 2
trigger1 = Time = 10
time= 30
timegap= 1
framegap= 3
length= 12
palbright= 0,0,0
paladd= 0,0,0
palmul= .9,.9,.9
palcontrast= 120,120,120
palpostbright= 0,0,0
trans= add1

[State 115, dash Sound]
type = PlaySnd
trigger1 = time=0
value = 100,0

[State 111, 1]
type = VelSet
trigger1 = time>=11 
x = -7

[State 111, 1]
type = StateTypeSet
trigger1 = time > 20
movetype = I

[State 111, 1]
type = SelfState
trigger1 = time =20
value = 0
ctrl = 1