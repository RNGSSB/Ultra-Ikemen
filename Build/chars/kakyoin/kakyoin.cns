;---------------------------------------------------------------------------
; 基本データ
;---------------------------------------------------------------------------
[Data]
life              = 1000   ;ライフ（体力ゲージ）最大値
power             = 10000  ;パワーゲージ最大値（オプション・デフォルトは3000=Lv.3）
attack            = 100    ;攻撃力（デフォルトは１００％）
defence           = 100    ;防御力（デフォルトは１００％）
fall.defence_up   = 50     ;横に倒れている時に一時的に加える防御力（％）
liedown.time      = 60     ;横に倒れている時間（フレーム）
airjuggle         = 15     ;ジャグルポイント限界値（「小ネタ.txt」参照）
sparkno           = 2      ;デフォルトのヒットスパーク（fightfxから）
guard.sparkno     = 40     ;デフォルトのガードスパーク（fightfxから）
KO.echo           = 0      ;ＫＯ時の音声（11,0）にエコーを掛けるか否か（0=掛けない,1=掛ける）
volume            = 255    ;キャラの標準の音量（最小-255・最大255）
IntPersistIndex   = 59     ;次のラウンドへ持ち越せる「Var」のアドレスの範囲を決める
FloatPersistIndex = 39     ;次のラウンドへ持ち越せる「FVar」のアドレスの範囲を決める

[Size]
xscale           = .833    ;キャラの横の大きさ（絶対値・float）
yscale           = 1.07    ;キャラの縦の大きさ（絶対値・float）
ground.back      = 18      ;地上にいる時の「後方の物理的な幅」
ground.front     = 18      ;地上にいる時の「前方の物理的な幅」
air.back         = 18      ;空中にいる時の「後方の物理的な幅」
air.front        = 18      ;空中にいる時の「前方の物理的な幅」
height           = 65      ;キャラの物理的な高さ（高いほど相手は飛び越しにくくなる）
attack.dist  
    = 160     ;相手がガード態勢に入る最低の距離
proj.attack.dist = 90      ;自分の「Projectile」に対して相手がガード態勢に入る最低の距離
proj.doscale     = 1       ;xscaleとyscaleを「Projectile」にも影響させるか否か（0=させない・1=させる）
head.pos         = -5,-95  ;キャラの標準の頭の座標（Bind系で適用される）
mid.pos          = -2,-64  ;キャラの標準の体中心の座標（Bind系で適用される）
shadowoffset     = 0       ;影のＹ軸方向の位置座標
draw.offset      = 0,0     ;キャラの表示座標（Ｘ軸,Ｙ軸）

;---------------------------------------------------------------------------
; 移動速度
;---------------------------------------------------------------------------
[Velocity]
walk.fwd     = 2.8         ;前進速度（Ｘ軸・[Statedef 20]に適用される）
walk.back    = -2.1        ;後退速度（Ｘ軸・[Statedef 20]に適用される）
run.fwd      = 7.6,0       ;前方に走る速度（Ｘ軸,Ｙ軸・[Statedef 100]に適用される）
run.back     = -7,0      ;後方に走る速度（Ｘ軸,Ｙ軸・[Statedef 105]に適用される）
jump.neu     = 0,-11     ;垂直ジャンプの速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
jump.back    = -2.5        ;後方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
jump.fwd     = 3.2         ;前方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
runjump.back = -3.1,-11.6  ;後方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
runjump.fwd  = 3.5,-11.6   ;前方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
airjump.neu  = 0,-6        ;空中垂直ジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 45]に適用される）
airjump.back = -2.9        ;空中後方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）
airjump.fwd  = 2.9         ;空中前方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）

;---------------------------------------------------------------------------
; 運動関係
;---------------------------------------------------------------------------
[Movement]
airjump.num     = 0        ;空中ジャンプが出来る回数
airjump.height  = 35       ;空中ジャンプが出来る最低の高度（Ｙ軸）
yaccel          = .6       ;Ｙ軸加速度（重力）
stand.friction  = .85      ;立っている時の摩擦係数（ステートのPhysicsが「S」の時）
crouch.friction = .82      ;しゃがんでいる時の摩擦係数（ステートのPhysicsが「C」の時）

;===========================================================================
; State
;===========================================================================
:Time Up - Lose
[Statedef 170]
type = S
movetype = I
physics = S
ctrl = 0
anim = ifelse(var(0),10000,170)
velset = 0,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = time < 120
flag = RoundNotOver

;---------------------------------------------------------------------------
;Time Up - Draw
[Statedef 175]
type = S
movetype = I
physics = S
ctrl = 0
anim = ifelse(var(0),10000,170)
velset = 0,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = time < 120
flag = RoundNotOver

;---------------------------------------------------------------------------
;Win
[Statedef 180]
type = S
movetype = I
physics = S
ctrl = 0
velset = 0,0

[State 0, assert]
type = assertspecial
trigger1 = time < 240
flag = RoundNotOver

[State 0, anim]
type = changeanim
trigger1 = !var(0)
trigger1 = !time
trigger1 = anim != 196
value = 196

[State 0, var]
type = varrandom
trigger1 = !time
v = 10
range = 0,2

[State 0, var]
type = varset
trigger1 = !time
trigger1 = WinTime
var(10) = 3

[State 0, snd]
type = playsnd
trigger1 = var(10) = 0
trigger1 = time = 6
value = 2,0
channel = 0

[State 0, snd]
type = playsnd
trigger1 = var(10) = 1
trigger1 = time = 6
value = 4,2
channel = 0

[State 0, snd]
type = playsnd
trigger1 = var(10) = 2
trigger1 = time = 6
value = 4,4
channel = 0

[State 0, snd]
type = playsnd
trigger1 = var(10) = 3
trigger1 = time = 6
value = 3,8
channel = 0

[state 0, helper]
type = helper
trigger1 = !fvar(11) || !numpartner
trigger1 = time = 1
trigger2 = fvar(11) = 92
helpertype = normal
name = "win"
stateno = 9100
id = 9100

;===========================================================================
;Intro
[Statedef 190]
type = S
movetype = I
physics = S
anim = 0
ctrl = 0
velset = 0,0

[State 0, power]
type = powerset
trigger1 = roundsexisted = 0
trigger1 = !time
trigger1 = power < 1000
value = 1000

[State 0, end]
type = changestate    
trigger1 = p2name = "dio"
trigger2 = p2name = "final dio"
trigger3 = p2name = "DIO BRANDO"
trigger4 = p2name = "shadow dio"
trigger5 = p2name = "Shadow Dio"
value = 194

[State -2, 3]
type = ChangeState
triggerall = teamside = 1
trigger1 = (P2Name = "kakyoin" || P4Name = "kakyoin") && EnemyNear,AuthorName = "Nimame"
value = 191+(random%2)

[State -2, 3]
type = ChangeState
triggerall = teamside = 2
trigger1 = (P2Name = "kakyoin" || P4Name = "kakyoin") && EnemyNear,AuthorName = "Nimame"
value = 191+(P2stateno=191)

[State 0, end]
type = changestate
trigger1 = 1
value = 191 + (random%2)

;---------------------------------------------------------------------------
;Intro1
[Statedef 191]
type = S
physics = N
anim = 195
velset = 0,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Intro

[State 0, screen]
type = screenbound
trigger1 = 1
value = 0

[State 0, pos]
type = posadd
trigger1 = !time
x = ifelse(teamside=1,-41,-42)

[State 0, anim]
type = changeanim
trigger1 = !(p2name = "Polnareff" && enemy,authorname = "Izumo")
trigger1 = time = 32
trigger2 = p2name = "Polnareff" && enemy,authorname = "Izumo"
trigger2 = p2stateno = 0 || enemy,anim = 0 || p2stateno != 192
trigger2 = enemy,time >= 4
value = 40
persistent = 0

[State 0, state]
type = statetypeset
trigger1 = anim = 40
statetype = A
persistent = 0

[State 0, snd]
type = playsnd
trigger1 = anim = 40
value = 4,0
channel = 0
persistent = 0

[State 0, vel]
type = velset
trigger1 = anim = 40 && !animtime
x = 1.16
y = -11

[State 0, anim]
type = changeanim
trigger1 = anim = 40 && !animtime
value = 42
persistent = 0

[State 0, gravity]
type = gravity
trigger1 = anim = 42

[State 0, anim]
type = changeanim
trigger1 = pos y >= 0 && vel y > 0
value = 48
persistent = 0

[State 0, vel]
type = velset
trigger1 = pos y >= 0 && vel y > 0
x = 0
y = 0

[State 0, pos]
type = posset
trigger1 = anim = 48
y = 0
persistent = 0

[State 0, snd]
type = playsnd
trigger1 = anim = 48
value = 0,17
volume = 32
persistent = 0

[State 0, end]
type = changestate
trigger1 = anim = 48 && !animtime
value = 0

;---------------------------------------------------------------------------
;Intro2-1
[Statedef 192]
type = S
physics = S
velset = 0,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Intro

[State 0, var]
type = varrandom
trigger1 = !time
v = 10
range = 0,2

[State 0, anim]
type = changeanim
triggerall = time > 0
trigger1 = p2stateno = 0 || enemy,anim = 0
trigger1 = enemy,time >= 16
trigger2 = time > 240
trigger3 = roundsexisted = 0
trigger3 = roundno > 1
trigger4 = p2name = "jotaro" && enemy,authorname = "y.y" && p2stateno = 160
trigger5 = p2name = "joseph" && enemy,authorname = "y.y" && p2stateno = 160
trigger6 = p2name = "Hol horse" && enemy,authorname = "y.y" && p2stateno = 160
trigger8 = p2name = "Jotaro Kujo" && enemy,authorname = "warusaki3" && p2stateno = 192
value = 196+var(10)
persistent = 0

[State 0, end]
type = changestate
trigger1 = anim != 0
trigger1 = anim != 190
value = 193

[State 0, snd]
type = playsnd
trigger1 = anim = 190
value = 5,1
channel = 0
persistent = 0

[State 0, end]
type = changestate
trigger1 = anim = 190
trigger1 = !animtime
value = 0

;---------------------------------------------------------------------------
;Intro2-2
[Statedef 193]
type = S
physics = S
velset = 0,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Intro

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = anim = 196
value = 4,1
channel = 0

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = anim = 197
value = 3,5
channel = 0

[State 0, snd]
type = playsnd
trigger1 = !time
trigger1 = anim = 198
value = 3,4
channel = 0

[State 0, end]
type = changestate
trigger1 = anim != 0
trigger1 = time = 65
value = 0

;---------------------------------------------------------------------------
;vs DIO Intro
[Statedef 194]
type = S
physics = S
velset = 0,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Intro

[State 0, anim]
type = changeanim
triggerall = time > 0
trigger1 = p2stateno = 0 || enemy,anim = 0
trigger1 = enemy,time >= 8
trigger2 = time > 400
trigger3 = p2name = "dio" && p2stateno = 192
trigger4 = p2name = "final dio" && p2stateno = 192
trigger5 = p2name = "shadow dio" && p2stateno = 192
trigger6 = p2name = "Shadow Dio" && p2stateno = 190
value = 191
persistent = 0

[State 0, snd]
type = playsnd
trigger1 = anim = 191
trigger1 = animelem = 1
value = 5,0
channel = 0

[State 0, end]
type = changestate
trigger1 = anim = 191 && !animtime
value = 0

;---------------------------------------------------------------------------
[Statedef 195]
type = S
movetype = I
physics  = S
ctrl = 0
velset = 0,0
sprpriority = 1-(var(0)>0)*3

[State 0, anim]
type = changeanim
triggerall = !var(0)
trigger1 = !time
value = 195+(random%5)

[State 0, var]
type = varset
trigger1 = !time
var(10) = anim

[State 0, anim]
type = changeanim
triggerall = var(0)
trigger1 = !time
trigger1 = anim != 10001
trigger1 = anim != 10950
trigger1 = anim != [10010,10011]
trigger1 = anim != [10200,10620]
trigger1 = anim != [13000,13301]
value = 10000

[State 0, anim]
type = changeanim
triggerall = var(0)
trigger1 = anim = 10010 && !animtime
value = 10011

[State 0, snd]
type = playsnd
trigger1 = time = 4
value = 3,4
channel = 0

[State 0, snd]
type = playsnd
trigger1 = time = 4
trigger1 = command = "holdx"
value = 5,1
channel = 0

[State 0, ctrl]
type = ctrlset
trigger1 = time = 55
value = 1

[State 0, end]
type = changestate
trigger1 = anim = 190
trigger1 = time = 55
trigger2 = var(0)
trigger2 = p2dist x < 0
value = 0
ctrl = 1

[State 0, end]
type = changestate
trigger1 = anim = [195,199]
trigger1 = time = 55
value = 196

;---------------------------------------------------------------------------
[Statedef 196]
type = U
movetype = I
physics  = S
ctrl = 1-(var(59)&&(var(36)=1100||var(36)=1011||var(36)<0));AIコンボ時or崩し
sprpriority = 1-(var(0)>0)*3

[State 0, var]
type = varset
trigger1 = prevstateno != 195
trigger1 = !time
var(10) = anim

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = NoAutoTurn

[State 0, end]
type = changestate
trigger1 = var(0)
trigger1 = p2dist x < 0
value = 0
ctrl = 1

[State 0, var]
type = changeanim
trigger1 = p2dist x < 0
value = 5

[State 0, turn]
type = turn
trigger1 = p2dist x < 0
value = 1

;AIctrlset
[State 0, turn]
type = ctrlset
triggerall = var(59)
trigger1 = !var(36)
trigger2 = roundstate != 2
value = 1

[State 0, var]
type = changeanim
trigger1 = anim = 5
trigger1 = !animtime
value = var(10)
elem = ifelse((var(10)=[195,199]),1,6)

;===========================================================================
;本体立ち弱
[Statedef 200]
type = S
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno=[100,105]),201,200)
poweradd = 0
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = animelemtime(5) = 0
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,10

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 200
trigger1 = animelem = 2
attr = S, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = M
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -14,-89
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 40*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 200
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 201
trigger1 = animelem = 2
attr = S, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = M
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -14,-89
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 40*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 200
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 0 && command != "holddown" && (command = "holdfwd" || command = "holdback") && prevstateno != [100,105]
value = 20
ctrl = 1

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 0 && (command = "holdup" || command = "longjump") && prevstateno != [100,105]
value = 40

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 0 && command = "holddown" && prevstateno != [100,105]
value = 10
ctrl = 1

[State 0, end]
type = changestate
trigger1 = anim = 200 && animelemtime(4) = 1
trigger2 = anim = 201 && animelemtime(5) = 2
value = 196

;===========================================================================
;本体立ち中
[Statedef 210]
type = S
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno=[100,105]),211,210)
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

;AI
[State 0, pos]
type = varadd
trigger1 = var(59)
trigger1 = (var(36) = [1011,1012]) || (var(36) = 1005) || (var(36) = 22)
trigger1 = !time
fvar(33) = 1

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = animelemtime(6) = 1
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 3
value = 0,11

[State 0, pos]
type = posadd
triggerall = !var(8)
triggerall = anim = 210
trigger1 = animelem = 3
x = ceil(6*const(size.xscale))

[State 0, hit]
type = hitdef
triggerall = !var(8)
triggerall = anim = 210
trigger1 = animelem = 3
attr = S, NA
damage = ceil(ifelse((35*fvar(0))<7,7,(35*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,11
sparkno = s6001
sparkxy = -12,-80
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 210
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
triggerall = anim = 211
trigger1 = animelem = 3
attr = S, NA
damage = ceil(ifelse((28*fvar(0))<7,7,(28*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -12,-80
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 211
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 11.9
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = anim = 210 && animelemtime(4) = 3
trigger2 = anim = 211 && animelemtime(6) = 6
value = 196

;---------------------------------------------------------------------------
;本体近距離立ち中
[Statedef 215]
type = S
movetype = A
physics = N
ctrl = 0
anim = 215
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

;AI
[State 0, pos]
type = varadd
trigger1 = var(59)
trigger1 = (var(36) = [1011,1012]) || (var(36) = 1005) || (var(36) = [22,23])
trigger1 = !time
fvar(33) = 1

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 3
value = 0,10

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = animelem = 3
attr = S, NA
damage = ceil(ifelse((28*fvar(0))<7,7,(28*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -12,-80
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 215
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 11.9
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = animelemtime(5) = 2
value = 196

;===========================================================================
;本体立ち強
[Statedef 220]
type = S
movetype = A
physics  = N
ctrl = 0
anim = ifelse((prevstateno = [100,105]),221,220+(var(9)!=0)*2)
poweradd = 50*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = anim = 221 && animelemtime(6) = 2
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = anim = 220
trigger1 = animelem = 3
value = 6,2

[State 0, snd]
type = playsnd
triggerall = !var(8)
triggerall = anim = 220
trigger1 = animelem = 3
value = 0,11

[State 0, snd]
type = playsnd
triggerall = !var(8)
triggerall = anim != 220
trigger1 = animelem = 3
value = 0,11

[State 1100, 攻撃フラグリセット①]
type     = MoveHitReSet
trigger1 = AnimElem = 4
Persistent = 0

[State 0, hit]
type = hitdef
triggerall = !var(8)
triggerall = anim = 220
trigger1 = animelem = 3
attr = S, NA
damage = ceil(ifelse((56*fvar(0))<7,7,(56*fvar(0)))),ceil(ifelse((56*fvar(0)*.25)<7,7,(56*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,6
sparkno = s6002
sparkxy = -10,-64
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 60*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = High
ground.slidetime = 13
ground.hittime = 13
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 13
fall = 0
air.fall = 1
fall.recovertime = 32
guard.kill = 0
persistent = 0
yaccel = .36
id = 220
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
triggerall = anim = 220
trigger1 = animelem = 7
attr = S, NA
damage = ceil(ifelse((28*fvar(0))<7,7,(28*fvar(0)))),ceil(ifelse((28*fvar(0)*.25)<7,7,(28*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,13
sparkno = s6002
sparkxy = -16,-92
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0*!(var(9)=2),0
givepower = 10*!(var(9)=2),0
ground.type = High
ground.slidetime = 18
ground.hittime = 18
ground.velocity = -10
guard.velocity = -8
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 0
air.fall = 1
fall.recovertime = 32
guard.kill = 0
persistent = 0
yaccel = .36
id = 220
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
triggerall = anim = 221
trigger1 = animelem = 3
attr = S, NA
damage = ceil(ifelse((56*fvar(0))<7,7,(56*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -12,-80
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 60*!(var(9)=2),0
givepower = 30*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -1,-5.5*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 220
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
trigger1 = animelemtime(5) < 0
fvar(3) = 8.3
ignorehitpause = 1

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
trigger1 = animelemtime(5) > 0
fvar(3) = 16
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = anim = 220
trigger1 = !animtime
value = 0
ctrl = 1

[State 0, end]
type = changestate
trigger1 = anim = 221 && animelemtime(7) = 2
trigger2 = anim = 222 && animelemtime(7) = 2
value = 196

;---------------------------------------------------------------------------
;本体立ち強スタンド
[Statedef 320]
type = A
movetype = I
physics = N
ctrl = 0
anim = 320
sprpriority = 2

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, anim]
type = changeanim
trigger1 = anim != 320
trigger2 = parent,animelem = 1
trigger3 = anim = 320
trigger3 = animelemno(0) != parent,animelemno(0)
value = 320
elem = parent,animelemno(0)
ignorehitpause = 1

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 400, CornerPush]
type = VarSet
trigger1 = 1
fvar(3) = root,fvar(3)
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 3000
trigger2 = root,stateno = 3100
value = root,stateno + 50

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 3500 && root,time = 3
value = 3550

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1200
trigger4 = root,stateno = 1300
value = root,stateno + 50

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = anim = 321 && !animtime
trigger2 = root,stateno != 220
value = 10000

;===========================================================================
;回り込み
[Statedef 300]
type = S
movetype = I
physics = N
anim = 300
ctrl = 0
velset = 0,0
sprpriority = -1
facep2 = 1;-(prevstateno=[100,119])

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 0, hitby]
type = hitby
Trigger1 = ifelse(((helper(7520*(numhelper(7520)>0)),var(10)) = 0),1,Animtime<=-8)
value = SCA,AT

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, snd]
type = null;playsnd
trigger1 = animelem = 2
value = 3,2
channel = 0

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[state 0, helper]
type = helper
trigger1 = animelem = 3
helpertype = normal
name = "Image"
stateno = 305
id = 305
pos = 0,0
postype = p1
ownpal = 1
keyctrl = 0

[State 0, vel]
type = veladd
trigger1 = animelemtime(3) >= 3
trigger1 = animelemtime(7) <= 0
x = .95

[State 0, vel]
type = velmul
trigger1 = animelemtime(10) > 0
x = .92

[State 0, vel]
type = velset
trigger1 = animelem = 18
x = 0

[State 0, var]
type = varset
trigger1 = !animtime
var(24) = 8

[State 0, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 305]
type = S
movetype = I
physics = N
anim = 300
ctrl = 0
vel = 0,0
sprpriority = -3

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, assert]
type = assertspecial
trigger1 = !(time%2)
flag = Invisible

[State 0, vel]
type = veladd
trigger1 = animelemtime(3) >= 3
trigger1 = animelemtime(7) <= 0
x = .95

[State 0, vel]
type = velmul
trigger1 = animelemtime(10) > 0
x = .92

[State 0, vel]
type = velset
trigger1 = animelem = 18
x = 0

[State 0, end]
type = DestroySelf
trigger1 = !animtime
trigger2 = root,movetype = H

;===========================================================================
;本体屈弱
[Statedef 400]
type = C
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno=[100,105]),401,400)
poweradd = 0
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = !animtime
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 200, Snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,10

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 400
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = L
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 40*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 400
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 401
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = L
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 40*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 400
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

;AI
[State 0, ctrl]
type = changestate
triggerall = var(59)
trigger1 = !animtime
trigger1 = var(36) = 1100
value = 1
ctrl = 0

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 1 && command != "holddown" && (command = "holdfwd" || command = "holdback") && prevstateno != [100,105]
value = 20
ctrl = 1

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 1 && (command = "holdup" || command = "longjump") && prevstateno != [100,105]
value = 40

[State 400, 3]
type = ChangeState
triggerall = !var(59)
trigger1 = animelemtime(4) >= 1 && command != "holddown" && command != "holdfwd" && command != "holdback" && prevstateno != [100,105]
value = 12
ctrl = 1

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;===========================================================================
;本体屈中（Stand）
[Statedef 410]
type = C
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno = [100,105]),411,410)
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = !animtime
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 4
value = 6,0

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 410
trigger1 = animelem = 4
attr = C, NA
damage = ceil(ifelse((42*fvar(0))<7,7,(42*fvar(0)))),ceil(ifelse((42*fvar(0)*.25)<7,7,(42*fvar(0)*.25)))
priority = 5,Hit
hitflag = MAF
guardflag = L
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -6,-19
guard.sparkno = s6010
hitsound = s0,4
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 1
guard.kill = 0
persistent = 0
yaccel = .36
id = 410
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 411
trigger1 = animelem = 4
attr = C, NA
damage = ceil(ifelse((42*fvar(0))<7,7,(42*fvar(0)))),ceil(ifelse((42*fvar(0)*.25)<7,7,(42*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,13
sparkno = s6001
sparkxy = -6,-19
guard.sparkno = s6010
hitsound = s0,4
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 15
ground.hittime = 15
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 15
fall = 0
air.fall = 1
guard.kill = 0
persistent = 0
yaccel = .36
id = 411
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 11.9
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;本体屈中（No Stand）
[Statedef 412]
type = C
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno = [100,105]),413,412)
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = !animtime
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,11

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 412
trigger1 = animelem = 2
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = L
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 11
ground.hittime = 11
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 11
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 412
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 413
trigger1 = animelem = 2
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 11
ground.hittime = 11
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 11
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 412
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;本体3中
[Statedef 415]
type = C
movetype = A
physics = N
ctrl = 0
anim = 415
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !animtime
x = 0

[State 0, snd]
type = playsnd
trigger1 = animelem = 1
value = 2,1
channel = 0

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,11

[State 0, vel]
type = posadd
triggerall = !var(8)
trigger1 = animelemtime(2) >= 0
trigger1 = animelemtime(7) < 0
x = ceil(2*const(size.xscale))

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = !movecontact
attr = C, NA
damage = ceil(ifelse((35*fvar(0))<7,7,(35*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = L
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6001
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,2
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 412
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;本体屈中スタンド
[Statedef 510]
type = A
movetype = A
physics = N
ctrl = 0
anim = 510
sprpriority = 2

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 400, CornerPush]
type = VarSet
trigger1 = 1
fvar(3) = root,fvar(3)
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = root,var(8) > 0
value = anim
elem = 4

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 3000
trigger2 = root,stateno = 3100
value = root,stateno + 50

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 3500 && root,time = 3
value = 3550

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1200
trigger4 = root,stateno = 1300
value = root,stateno + 50

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 410
value = 10000

;===========================================================================
;本体屈強（Stand）
[Statedef 420]
type = C
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno = [100,105]),421,420)
poweradd = 50*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = animelemtime(5) = 0
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 3
value = 6,1

[State 1100, 攻撃フラグリセット①]
type     = MoveHitReSet
trigger1 = AnimElem = 4
Persistent = 0

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 420
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((49*fvar(0))<7,7,(49*fvar(0)))),ceil(ifelse((49*fvar(0)*.25)<7,7,(49*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = L
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,3
sparkno = s6002
sparkxy = -6,-28
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 60*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
ground.cornerpush.veloff = 0
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 1
persistent = 0
fall.recover = 1
fall.recovertime = 30
guard.kill = 0
yaccel = .36
id = 420
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 420
trigger1 = animelem = 7
attr = C, NA
damage = ceil(ifelse((35*fvar(0))<7,7,(35*fvar(0)))),ceil(ifelse((35*fvar(0)*.25)<7,7,(35*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
guard.pausetime = 0,13
sparkno = s6002
sparkxy = -14,-20
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0*!(var(9)=2),0
givepower = 10*!(var(9)=2),0
ground.type = Trip
ground.slidetime = 18
ground.hittime = 18
ground.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
guard.velocity = -8
air.type = low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 0
air.fall = 1
persistent = 0
fall.recover = 1
fall.recovertime = 30
guard.kill = 0
yaccel = .36
id = 420
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 421
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((49*fvar(0))<7,7,(49*fvar(0)))),ceil(ifelse((49*fvar(0)*.25)<7,7,(49*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = L
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,3
sparkno = s6002
sparkxy = -6,-28
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 60*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 1
persistent = 0
fall.recover = 1
fall.recovertime = 30
guard.kill = 0
yaccel = .36
id = 420
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 421
trigger1 = animelem = 7
attr = C, NA
damage = ceil(ifelse((35*fvar(0))<7,7,(35*fvar(0)))),ceil(ifelse((35*fvar(0)*.25)<7,7,(35*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
guard.pausetime = 0,13
sparkno = s6002
sparkxy = -14,-20
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0*!(var(9)=2),0
givepower = 10*!(var(9)=2),0
ground.type = Trip
ground.slidetime = 18
ground.hittime = 18
ground.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
guard.velocity = -8
air.type = low
air.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 0
air.fall = 1
persistent = 0
fall.recover = 1
fall.recovertime = 30
guard.kill = 0
yaccel = .36
id = 420
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
trigger1 = animelemtime(5) < 0
fvar(3) = 8.3
ignorehitpause = 1

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
trigger1 = animelemtime(6) > 0
fvar(3) = 16
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;本体屈強（No Stand）
[Statedef 422]
type = C
movetype = A
physics = N
ctrl = 0
anim = ifelse((prevstateno = [100,105]),401,400)
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3
facep2 = 1-(prevstateno=[100,119])

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, vel]
type = velset
trigger1 = !time
trigger1 = vel x != 0
trigger1 = prevstateno != [100,105]
trigger2 = !animtime
x = 0

[State 0, vel]
type = velmul
triggerall = !var(8)
trigger1 = prevstateno = [100,105]
x = .95

[State 200, Snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,10

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 400
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = L
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 400
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = anim = 401
trigger1 = animelem = 3
attr = C, NA
damage = ceil(ifelse((21*fvar(0))<7,7,(21*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = L
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -10,-27
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = Low
air.velocity = -2,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
id = 400
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 11.9
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 11
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 520]
type = A
movetype = A
physics = N
velset = 0,0
anim = root,anim+100
ctrl = 0
sprpriority = 2

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0]
type = changeanim
trigger1 = parent,stateno = 420 & parent,animelemtime(3) >= 0
trigger1 = parent,stateno = 420 & parent,animelemtime(3) < 1
value = anim
elem = 5
persistent = 1

[State 0]
type = changeanim
trigger1 = parent,stateno = 420 & parent,animelemtime(7) >= 0
trigger1 = parent,stateno = 420 & parent,animelemtime(7) < 1
value = anim
elem = 13
persistent = 1

[State 0, vel]
type = veladd
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1200
x = root,vel x

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 3000
trigger2 = root,stateno = 3100
value = root,stateno + 50

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 3500 && root,time = 3
value = 3550

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1200
trigger4 = root,stateno = 1300
value = root,stateno + 50

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 420
value = 10000

;===========================================================================
;ジャンプ弱
[Statedef 600]
type = A
movetype = A
physics = N
ctrl = 0
anim = 600
poweradd = 30*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 2
value = 0,10

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = !movecontact
attr = A, NA
damage = ceil(ifelse((49*fvar(0))<7,7,(49*fvar(0)))),0
priority = 3,Hit
hitflag = MAF
guardflag = HA
animtype = Light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -11,-55
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 40*!(var(9)=2),0
givepower = 20*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-6*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 12
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, snd]
type = playsnd
trigger1 = !time
value = 2,0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse((var(6)&8)&&!var(0),.45,ifelse((var(6)&8),.4,ifelse(fvar(10),.45,ifelse((var(6)&16),.5,.55))))

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 4030, ChangeState]
type = ChangeState
triggerall = !var(8)
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;---------------------------------------------------------------------------
;ジャンプ中
[Statedef 610]
type = A
movetype = A
physics = N
ctrl = 0
anim = 610
poweradd = 40*!(var(9)=2)
sprpriority = 1-(var(0)>0)*3

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 4
value = 0,11

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = !movecontact
attr = A, NA
damage = ceil(ifelse((28*fvar(0))<7,7,(28*fvar(0)))),0
priority = 5,Hit
hitflag = MAF
guardflag = HA
animtype = light
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6000
sparkxy = -8,-35
guard.sparkno = s6010
hitsound = s0,0
guardsound = s0,9
getpower = 50*!(var(9)=2),0
givepower = 25*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-6*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
air.hittime = 12
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 0
air.fall = 0
persistent = 0
yaccel = .36
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, snd]
type = playsnd
trigger1 = !time
value = 2,1

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse((var(6)&8)&&!var(0),.45,ifelse((var(6)&8),.4,ifelse(fvar(10),.45,ifelse((var(6)&16),.5,.55))))

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 4030, ChangeState]
type = ChangeState
triggerall = !var(8)
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;---------------------------------------------------------------------------
;ジャンプ強
[Statedef 620]
type = A
movetype = A
physics = N
anim = 620
ctrl = 0
poweradd = 50
sprpriority = 2

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 3
value = 6,2

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = animelem = 2
attr = A, NA
damage = ceil(ifelse((70*fvar(0))<7,7,(70*fvar(0)))),ceil(ifelse((70*fvar(0)*.25)<7,7,(70*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = HA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6002
sparkxy = -6,-32
guard.sparkno = s6010
hitsound = s0,3
guardsound = s0,9
getpower = 30*!(var(9)=2),0
givepower = 15*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-6*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
air.hittime = 12
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 28
guard.kill = 0
persistent = 0
yaccel = .36
p2facing = ifelse(!var(11),1,0)

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = animelem = 4
attr = A, NA
damage = ceil(ifelse((14*fvar(0))<7,7,(14*fvar(0)))),ceil(ifelse((14*fvar(0)*.25)<7,7,(14*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = HA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,9
sparkno = s6002
sparkxy = -6,-32
guard.sparkno = s6010
hitsound = s0,3
guardsound = s0,9
getpower = 30*!(var(9)=2),0
givepower = 10*!(var(9)=2),0
ground.type = High
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -1,-6*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
air.hittime = 12
fall = 0
air.fall = 1
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall.recover = 1
fall.recovertime = 28
guard.kill = 0
persistent = 0
yaccel = .36
p2facing = ifelse(!var(11),1,0)

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse((var(6)&8)&&!var(0),.45,ifelse((var(6)&8),.4,ifelse(fvar(10),.45,ifelse((var(6)&16),.5,.55))))

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 4030, ChangeState]
type = ChangeState
triggerall = !var(8)
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;---------------------------------------------------------------------------
[Statedef 725]
type = A
movetype = A
physics = N
velset = 0,0
anim = 725
ctrl = 0
sprpriority = -2

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 0,30

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 400, CornerPush]
type = VarSet
trigger1 = 1
fvar(3) = root,fvar(3)
ignorehitpause = 1

[State 0]
type = changeanim
trigger1 = parent,stateno = 620 & parent,animelemtime(2) >= 0
trigger1 = parent,stateno = 620 & parent,animelemtime(2) < 1
value = anim
elem = 2
persistent = 1

[State 0]
type = changeanim
trigger1 = parent,stateno = 620 & parent,animelemtime(4) >= 0
trigger1 = parent,stateno = 620 & parent,animelemtime(4) < 3
value = anim
elem = 6
persistent = 1

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1101
value = root,stateno + 50

[State 0, end]
type = changestate
trigger1 = !animtime
trigger2 = root,stateno != 620
value = 10000

;===========================================================================
;ガーキャン(本体)
[Statedef 700]
type = S
movetype = I
physics = S
ctrl = 0
anim = 20900
poweradd = ifelse(((helper(7520*(numhelper(7520)>0)),var(10)) = 0),0,-1000)
velset = 0,0
facep2 = 1

[State 0, nhb]
type = nothitby
trigger1 = time <= 10
trigger2 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
trigger2 = 1
value = SCA
time = 1

[State 0, pal]
type = palfx
trigger1 = time < 10
trigger1 = time%2
add = 128,128,128
time = 1
ignorehitpause = 1

[State 0, hit]
type = pause
triggerall = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
trigger1 = time = 1
time = 20

[State 0, hit]
type = playsnd
triggerall = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
trigger1 = time = 1
value = 700,100

[State 0, snd]
type = playsnd
trigger1 = time = 4
value = 3,7
channel = 0

[State 0, end]
type = changestate
trigger1 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 0)
trigger1 = time = 10
trigger2 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
trigger2 = time = 35
value = 196

;---------------------------------------------------------------------------
;ガーキャン(スタンド)
[Statedef 750]
type = S
movetype = A
physics = S
ctrl = 0
anim = 10700
velset = 0,0
sprpriority = 2

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, width]
type = width
trigger1 = 1
edge = 20,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, hit]
type = hitby
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP

[State 0, nhb]
type = nothitby
trigger1 = time <= 10
trigger1 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 0)
trigger2 = time <= 20
trigger2 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
value = SCA

[State 10000, HitBy]
type = HitBy
trigger1 = time >= 10
trigger1 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 0)
trigger2 = time >= 20
trigger2 = ((helper(7520*(numhelper(7520)>0)),var(10)) = 1)
value = SCA,NA,SA,HA,NP,SP,HP

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9500

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, pos]
type = bindtoroot
trigger1 = time <= 1
pos = 15,0

[State 0, hit]
type = hitdef
triggerall = !movecontact
trigger1 = animelem = 6
trigger2 = animelem = 7
attr = S, SA
damage = ceil(ifelse((56*root,fvar(0))<7,7,(56*root,fvar(0)))),ceil(ifelse((56*root,fvar(0)*.25)<7,7,(56*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,13
sparkno = s6004
sparkxy = -10,-80
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 20,0
ground.type = High
ground.slidetime = 31
ground.hittime = 31
ground.velocity = -4,-6*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
air.velocity = -4,-6*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 1
fall.recover = 1
fall.recovertime = 28
guard.kill = 0
persistent = 0
yaccel = .36
p2facing = 1
kill = ((helper(20032*(numhelper(20032)>0)),var(10)) = 0)

[state -2, var]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, var]
type = parentvarset
trigger1 = root,var(44) = 1
trigger1 = movehit = 1
var(44) = 2

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 11.9
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = movehit = 1
var(50) = 1

[State 0, power]
type = poweradd
trigger1 = var(50)
value = 40

[State 0, var]
type = varset
trigger1 = 1
var(50) = 0

;コーナープッシュ処理
[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = !fvar(3)
fvar(5) = 0

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = numtarget
trigger1 = target,BackEdgeBodyDist <= 5 || target,FrontEdgeBodyDist <= 5
fvar(5) = 1

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = movecontact = 1
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = fvar(3) = [0,.1]
trigger2 = NumTarget
trigger2 = target,statetype = A && target,stateno != [5070,5071]
trigger3 = root,fvar(3)
fvar(3) = 0

[State -2, CornerPush]
type = PosAdd
triggerall = IsHelper
triggerall = fvar(3)
triggerall = fvar(5)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
x = -fvar(3)

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
triggerall = fvar(3)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
fvar(3) = fvar(3)*.75

[State 0, anim]
type = changeanim
trigger1 = var(8) > 0
value = anim
elem = animelemno(-1)

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, var]
type = varadd
trigger1 = var(8)
var(8) = -1

[State 0, var]
type = varset
trigger1 = movecontact = 1
var(8) = 12
ignorehitpause = 1

[State 0, end]
type = changestate
trigger1 = animelemtime(13) = 2
value = 9001

;===========================================================================
;アドバンシングガード
[Statedef 710]
type = U
movetype = I
physics = N
ctrl = 0
velset = 0,0

[State 0, vel]
type = velset
trigger1 = 1
x = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 6020
id = 6020
pos = ceil(28*const(size.xscale)),ifelse(statetype=C&&!var(0),ceil(-45*const(size.xscale)),ceil(-90*const(size.xscale)))
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 2
ownpal = 1
shadow = 0,0,0
pausemovetime = 0
supermovetime = 0

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "AVG"
stateno = 715
id = 715
pos = -10,0
postype = p1
keyctrl = 0
pausemovetime = 999999
supermovetime = 999999
size.ground.back = 20
size.ground.front = 20
size.height = 240

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
stateno = 8030
id = 8030
pos = 0,0
postype = p2
ownpal = 1
keyctrl = 0
pausemovetime = 999999
supermovetime = 999999

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 0,20

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 3,9
channel = 0

[State 0, anim]
type = changeanim
trigger1 = !var(59)
trigger1 = time >= 0 && command != "holddown"
trigger2 = var(59)
trigger2 = time >= 0 && statetype = S
value = 150+var(0)

[State 0, anim]
type = changeanim
trigger1 = !var(59)
trigger1 = time >= 0 && command = "holddown"
trigger2 = var(59)
trigger2 = time >= 0 && statetype = C
value = 151+var(0)

[State 0, state]
type = statetypeset
trigger1 = command != "holddown"
statetype = S
physics = S

[State 0, state]
type = statetypeset
trigger1 = command = "holddown"
statetype = C
physics = C

[State 0, nhb]
type = nothitby
trigger1 = time <= 1
value = SCA
time = 1

[State 0, end]
type = changestate
trigger1 = time = 1
value = 151+(command = "holddown")*2

;---------------------------------------------------------------------------
;アドバンシングガード2
[Statedef 711]
type = U
movetype = I
physics = N

[State 0, vel]
type = velset
trigger1 = 1
x = 0

[State 0, anim]
type = changeanim
trigger1 = time >= 0 && command != "holddown"
value = 150+var(0)

[State 0, anim]
type = changeanim
trigger1 = time >= 0 && command = "holddown"
value = 151+var(0)

[State 0, state]
type = statetypeset
trigger1 = command != "holddown"
statetype = S
physics = S

[State 0, state]
type = statetypeset
trigger1 = command = "holddown"
statetype = C
physics = C

[State 0, end]
type = changestate
trigger1 = numhelper(715)
trigger1 = command = "holdback"
value = 151+(command = "holddown")*2

[State 0, end]
type = changestate
trigger1 = !numhelper(715)
value = 130+(command = "holddown")
ctrl = 1

;---------------------------------------------------------------------------
;アドバンシングガード(ヘルパー)
[Statedef 715]
type = S
movetype = I
physics = N
anim = 715
velset = 0,0

[State 0, push]
type = playerpush
trigger1 = 1
value = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = velset
trigger1 = !time
x = 20

[State 0, vel]
type = veladd
trigger1 = time > 0
x = -1

[State 0, end]
type = DestroySelf
trigger1 = time = 15

;---------------------------------------------------------------------------
; アドバンシングガード(煙)
[Statedef 8030]
type = S
movetype = I
physics = N
velset = 0,0
anim = 8030
sprpriority = 4

[State 0, pos]
type = posset
trigger1 = 1
x = enemynear,pos x
y = 0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 0, end]
type = DestroySelf
trigger1 = !animtime

;===========================================================================
;投げ
[Statedef 800]
type = S
movetype = A
physics = S
ctrl = 0
anim = 800+var(0)
sprpriority = 0

[State 0, hit]
type = hitdef
triggerall = !var(59)
triggerall = !fvar(7)
trigger1 = p2movetype != H && (p2stateno != [40,42])
trigger1 = animelemtime(1) >= 0
attr = S,NT
priority = 1,Miss
hitflag = M-
sparkno = -1
hitsound = s0,10
;p1stateno = 801
p2stateno = 810
p1facing = ifelse(command = "holdfwd", 1, -1)
p2facing = 1
fall = 1
numhits = 0
id = 800

[State 0, hit]
type = hitdef
triggerall = var(59)
triggerall = !fvar(7)
trigger1 = p2movetype != H && (p2stateno != [40,42])
trigger1 = animelemtime(1) >= 0
attr = S,NT
priority = 1,Miss
hitflag = M-
sparkno = -1
hitsound = s0,10
;p1stateno = 801
p2stateno = 810
p1facing = ifelse(-facing*(helper(60000+(facing=1)*10),pos x-pos x)<200, -1, 1)
p2facing = 1
fall = 1
numhits = 0
id = 800

[State 901, Throw]
type = ChangeState
trigger1 = numtarget(800)
trigger1 = target,stateno = 810
value = 801
persistent = 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 220+var(0)

;---------------------------------------------------------------------------
;投げ
[Statedef 801]
type = S
movetype = A
physics = S
ctrl = 0
anim = 801+var(0)
velset = 0,0
poweradd = 120
sprpriority = -3

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, width]
type = width
trigger1 = 1
edge = 80,0

[State 0, end]
type = changestate
trigger1 = time = [1,4]
trigger1 = target,command = "holdfwd" || target,command = "holdback"
trigger1 = target,command = "y" || target,command = "z" || target,command = "b" || target,command = "c"
value = 820

[State 0, var]
type = varset
trigger1 = !var(0)
trigger1 = time = 5
var(9) = 1

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,16

[State 0, target]
type = targetbind
trigger1 = time < 37 
pos = ifelse(!var(0),62,47),-100
time = 1

[State 0, anim]
type = playsnd
trigger1 = var(0)
trigger1 = time = 50
value = 6,13

[State 0, snd]
type = playsnd
trigger1 = time = 5
value = 3,6
channel = 0

[State 0, anim]
type = changeanim
trigger1 = var(0)
trigger1 = time = 31
value = 10803

[State 810, 1]
type = helper
trigger1 = time = 32
trigger2 = time = 52
trigger3 = time = 55
trigger4 = time = 57
trigger5 = time = 58
trigger6 = time = 60
trigger7 = time = 62
trigger8 = time = 64
helpertype = normal
stateno = 880
id = 880
postype = p1
pos = 0,-60
ownpal = 1
keyctrl = 0

[State 0, life]
type = targetlifeadd
trigger1 = time = 33
trigger2 = time = 57
trigger3 = time = 60
trigger4 = time = 63
trigger5 = time = 64
trigger6 = time = 66
trigger7 = time = 68
trigger8 = time = 70
value = ceil(ifelse((-7*fvar(0))>-7,-7,(-7*fvar(0))))
kill = time >= 63
ignorehitpause = 1
id = 800

[State 0, life]
type = TargetPowerAdd
trigger1 = time = 33
trigger2 = time = 57
trigger3 = time = 60
trigger4 = time = 63
trigger5 = time = 64
trigger6 = time = 66
trigger7 = time = 68
trigger8 = time = 70
value = 10
ID = 800

[State 0, spr]
type = sprpriority
trigger1 = !var(0)
trigger1 = time = 37
value = 2

[State 0, target]
type = targetstate
trigger1 = time = 37
value = 811

[State 0, target]
type = targetbind
trigger1 = time = 37
pos = ifelse(!var(0),62,47),-10
time = 1

[State 0, target]
type = targetstate
trigger1 = time = 70
value = 812

[State 0, anim]
type = changeanim
trigger1 = time = 70
value = 802+var(0)

[State 0, vel]
type = velset
trigger1 = time = 70
x = -13

[State 0, end]
type = changestate
trigger1 = anim = 802 && !animtime
trigger2 = anim = 10802 && animelemtime(6) = 2
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;投げぬけ（自分）（y.yさん製作）
[Statedef 820]
type = A
movetype = I
physics = A
anim = 5040+var(0)
velset = -3,-6

[State 0, target]
type = targetbind
trigger1 = !time
pos = 50,0

[State 0, target]
type = targetstate
trigger1 = !time
value = 830

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

;---------------------------------------------------------------------------
;投げ(スタンド)
[Statedef 850]
type = U
movetype = I
physics = N
ctrl = 0
anim = 10801
velset = 0,0
sprpriority = -2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 15,0

[State 0, anim]
type = playsnd
trigger1 = time = 50
value = 6,13

[State 0, anim]
type = changeanim
trigger1 = time = 32
value = 10803
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = root,anim = 802
value = 10802
persistent = 0

[State 0, end]
type = changestate
trigger1 = anim = 10802
trigger1 = root,stateno != 801
value = 9000

;---------------------------------------------------------------------------
;投げ(ENEMY)
[Statedef 810]
type = A
movetype = H
physics = N
ctrl = 0
velset = 0,0
sprpriority = 0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, screen]
type = screenbound
trigger1 = 1
value = 0

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, anim2]
type = changeanim2
trigger1 = !time
value = 810

[State 0, anim2]
type = changeanim2
trigger1 = !time
trigger1 = authorname="Izumo"
trigger1 = name="Kakyoin"
trigger2 = authorname="Nimame"
trigger2 = name="Kakyoin" || name="Kakyoin2"
value = 815

[State 0, anim2]
type = changeanim2
trigger1 = !time
trigger1 = authorname="Izumo" || authorname="Nimame"
trigger1 = name="Polnareff"
value = 816

[State 0, nhb]
type = selfstate
trigger1 = time > 60
value = 5050

;---------------------------------------------------------------------------
;投げ2(ENEMY)
[Statedef 811]
type = A
movetype = H
physics = N
ctrl = 0
anim = 5030
velset = -0.4,-6.4

[State 0, vel]
type = veladd
trigger1 = time <= 16
y = .5

[State 0, vel]
type = velset
trigger1 = time = 17
x = 0
y = 0

[State 0, pos]
type = posadd
trigger1 = !(time%3)
trigger1 = time >= 20
x = -1
y = 0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, anim]
type = changeanim2
trigger1 = !(time%3)
trigger1 = time >= 25
value = 811

;---------------------------------------------------------------------------
;投げ3(ENEMY)
[Statedef 812]
type = A
movetype = H
physics = N
ctrl = 0
anim = 5050
velset = -8,-5

[State 0, vel]
type = veladd
trigger1 = 1
y = .4

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, self]
type = SelfState
trigger1 = pos y >= 0
trigger1 = vel y > 0
value = 5100

;---------------------------------------------------------------------------
;投げ抜け（相手）
[Statedef 830]
type = A
movetype = I
physics = N
velset = -3,-6

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, anim]
type = changeanim
trigger1 = !time
value = 5210

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = .45

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 52
ctrl = 1


;---------------------------------------------------------------------------
;投げ（弾）
[Statedef 880]
type = A
physics = N
anim = 880+(random%4)

[State 0, vel]
type = velset
trigger1 = anim = 880
x = 16
y = -10

[State 0, vel]
type = velset
trigger1 = anim = 881
x = 16
y = -8

[State 0, vel]
type = velset
trigger1 = anim = 882
x = 16
y = -6

[State 0, vel]
type = velset
trigger1 = anim = 883
x = 16
y = 0

[State 0, explod]
type = explod
trigger1 = p2dist x <= 5
anim = 6004
id = 6000
postype = p1
pos = 0,0
sprpriority = 3
ownpal = 1

[State 0, hit]
type = hitadd
trigger1 = p2dist x <= 5
value = 1

[State 0, snd]
type = playsnd
trigger1 = p2dist x <= 5
value = 0,5

[State 0, end]
type = DestroySelf
trigger1 = p2dist x <= 5

;==============================================================================
;エメラルドスプラッシュ(Main)
[Statedef 1000]
type = S
movetype = A
physics = S
ctrl = 0
anim = 195+(random%4)
velset = 0,0
sprpriority = 0
facep2 = 1

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 220
trigger2 = prevstateno = 410
trigger3 = prevstateno = 420
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 0, var]
type = varset
trigger1 = !time
var(6) = (var(6)|256)

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, ctrl]
type = ctrlset
trigger1 = time = 10
value = 1

[State 0, state]
type = changestate
trigger1 = ctrl	
value = 196
ctrl = 1

[State 0, state]
type = null;statetypeset
trigger1 = ctrl	
movetype = I
ignorehitpause = 1
persistent = 0

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(スタンド)
[Statedef 1050]
type = U
movetype = A
physics = N
ctrl = 0
anim = 1050
sprpriority = -2

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, var]
type = parentvarset
trigger1 = root,var(44) != 2
var(44) = 1

[State 0, anim]
type = changeanim
trigger1 = !time
value = 1050

[State 0, pos]
type = null;posadd
trigger1 = time = 0
x = 15

[State 0, snd]
type = playsnd
trigger1 = animelem = 4
value = 3,1
channel = 0

[State 0, snd]
type = playsnd
trigger1 = animelem = 13
value = 6,3

[state 0, helper]
type = helper
trigger1 = !var(13)
trigger1 = animelemtime(13) = 0
helpertype = normal
name = "eme sp"
stateno = 1060
id = 1060
pos = ceil(-7*const(size.xscale)),ceil(-86*const(size.yscale))
ownpal = 1

[state 0, helper]
type = helper
trigger1 = !var(13)
trigger1 = animelemtime(13) = 3
helpertype = normal
name = "eme sp"
stateno = 1061
id = 1061
pos = ceil(-10*const(size.xscale)),ceil(-78*const(size.yscale))
ownpal = 1

[state 0, helper]
type = helper
trigger1 = !var(13)
trigger1 = animelemtime(13) = 0
helpertype = normal
name = "eme sp"
stateno = 1062
id = 1062
pos = ceil(-7*const(size.xscale)),ceil(-70*const(size.yscale))
ownpal = 1

[state 0, helper]
type = helper
trigger1 = !var(13)
trigger1 = animelemtime(13) = 3
helpertype = normal
name = "eme sp"
stateno = 1063
id = 1063
pos = ceil(-10*const(size.xscale)),ceil(-62*const(size.yscale))
ownpal = 1

[State 0, var]
type = varrandom
triggerall = var(13)
trigger1 = animelemtime(13) = 0
trigger2 = animelemtime(13) = 3
trigger3 = animelemtime(13) = 6
trigger4 = animelemtime(13) = 9
v = 10
range = 0,3

[state 0, helper]
type = helper
triggerall = var(13)
trigger1 = animelemtime(13) = 0
trigger2 = animelemtime(13) = 3
trigger3 = animelemtime(13) = 6
trigger4 = animelemtime(13) = 9
helpertype = normal
name = "eme sp"
stateno = 11050
id = 11050+(animelemtime(13)/3)*2
pos = ceil(-16*const(size.xscale)),ceil(-(66+var(10)*8)*const(size.yscale))
ownpal = 1

[State 0, var]
type = varrandom
triggerall = var(13)
trigger1 = animelemtime(13) = 0
trigger2 = animelemtime(13) = 3
trigger3 = animelemtime(13) = 6
trigger4 = animelemtime(13) = 9
v = 10
range = 0,3

[state 0, helper]
type = helper
triggerall = var(13)
trigger1 = animelemtime(13) = 0
trigger2 = animelemtime(13) = 3
trigger3 = animelemtime(13) = 6
trigger4 = animelemtime(13) = 9
helpertype = normal
name = "eme sp"
stateno = 11050
id = 11051+(animelemtime(13)/3)*2
pos = ceil(-16*const(size.xscale)),ceil(-(90-var(10)*8)*const(size.yscale))
ownpal = 1

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 1051

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(スタンド/終了)
[Statedef 1051]
type = U
movetype = I
physics = N
ctrl = 0
anim = 1051
velset = 0,0
sprpriority = -2

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = !(time%2)
flag = Invisible

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, snd]
type = playsnd
trigger1 = time = 40
value = 0,15

[State 0, scale]
type = angledraw
trigger1 = time > 40
scale = (const(size.xscale)-(.08*(time-40))),(const(size.yscale)+(.06*(time-40)))

[State 0, anim]
type = changeanim
trigger1 = time = 52
value = 20000

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = time = 52
value = 10000

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(弾1)
[Statedef 1060]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1060
sprpriority = 2

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, vel]
type = velset
trigger1 = !time
x = 5.2
y = -.85

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, explod]
type = explod
trigger1 = !numexplod(1065)
trigger1 = animelemtime(2) = 0 && anim = 1060
anim = 1065
id = 1065
postype = p1
pos = 0,0
scale = .833,1.07
sprpriority = 1
ownpal = 1
vel = 5.2,-.85

[State 0, pal]
type = palfx
trigger1 = time = 6
time = 14
sinadd = 80,80,80,28

[State 0, hit]
type = hitdef
trigger1 = !movecontact
attr = A, SP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = MA
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 13
ground.hittime = 13
ground.velocity = -3
guard.velocity = -2.5
air.type = High
air.hittime = 13
air.velocity = -8,-3*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 16
guard.kill = 0
p2facing = 1
numhits = 1

[state 4100, 1]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, vel]
type = parentvarset
trigger1 = movehit = 1
var(45) = 3
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = movecontact
trigger2 = animelemtime(2) = 0
value = 20000

[State 0, end]
type = statetypeset
trigger1 = root,movetype = H
trigger2 = movecontact
trigger3 = animelem = 2
movetype = I

[State 0, end]
type = DestroySelf
trigger1 = pos x <= -240 || pos x >= 240
trigger2 = root,movetype = H
trigger3 = time = 30

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(弾2)
[Statedef 1061]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1061
sprpriority = 2

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, vel]
type = velset
trigger1 = !time
x = 5.2
y = -.5

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, explod]
type = explod
trigger1 = !numexplod(1065)
trigger1 = animelemtime(2) = 0 && anim = 1061
anim = 1065
id = 1065
postype = p1
pos = 0,0
scale = .833,1.07
sprpriority = 1
ownpal = 1
vel = 5.2,-.5

[State 0, pal]
type = palfx
trigger1 = time = 6
time = 14
sinadd = 80,80,80,28

[State 0, hit]
type = hitdef
trigger1 = !movecontact
attr = A, SP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = MA
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 13
ground.hittime = 13
ground.velocity = -3
guard.velocity = -2.5
air.type = High
air.hittime = 13
air.velocity = -8,-3*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 16
guard.kill = 0
p2facing = 1
numhits = 1

[state 4100, 1]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, vel]
type = parentvarset
trigger1 = movehit = 1
var(45) = 3
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = movecontact
trigger2 = animelemtime(2) = 0
value = 20000

[State 0, end]
type = statetypeset
trigger1 = root,movetype = H
trigger2 = movecontact
trigger3 = animelem = 2
movetype = I

[State 0, end]
type = DestroySelf
trigger1 = pos x <= -240 || pos x >= 240
trigger2 = root,movetype = H
trigger3 = time = 30

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(弾3)
[Statedef 1062]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1062
sprpriority = 2

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, vel]
type = velset
trigger1 = !time
x = 5.2

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, explod]
type = explod
trigger1 = !numexplod(1065)
trigger1 = animelemtime(2) = 0 && anim = 1062
anim = 1065
id = 1065
postype = p1
pos = 0,0
scale = .833,1.07
sprpriority = 1
ownpal = 1
vel = 5.2,0

[State 0, pal]
type = palfx
trigger1 = time = 6
time = 14
sinadd = 80,80,80,28

[State 0, hit]
type = hitdef
trigger1 = !movecontact
attr = A, SP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = MA
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 13
ground.hittime = 13
ground.velocity = -3
guard.velocity = -2.5
air.type = High
air.hittime = 13
air.velocity = -8,-3*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 16
guard.kill = 0
p2facing = 1
numhits = 1

[state 4100, 1]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, vel]
type = parentvarset
trigger1 = movehit = 1
var(45) = 3
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = movecontact
trigger2 = animelemtime(2) = 0
value = 20000

[State 0, end]
type = statetypeset
trigger1 = root,movetype = H
trigger2 = movecontact
trigger3 = animelem = 2
movetype = I

[State 0, end]
type = DestroySelf
trigger1 = pos x <= -240 || pos x >= 240
trigger2 = root,movetype = H
trigger3 = time = 30

;---------------------------------------------------------------------------
;エメラルドスプラッシュ(弾4)
[Statedef 1063]
type = A
movetype = A
physics = N
ctrl = 0
anim = 1063
sprpriority = 2

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, vel]
type = velset
trigger1 = !time
x = 5.2
y = .5

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, explod]
type = explod
trigger1 = !numexplod(1065)
trigger1 = animelemtime(2) = 0 && anim = 1063
anim = 1065
id = 1065
postype = p1
pos = 0,0
scale = .833,1.07
sprpriority = 1
ownpal = 1
vel = 5.2,.5

[State 0, pal]
type = palfx
trigger1 = time = 6
time = 14
sinadd = 80,80,80,28

[State 0, hit]
type = hitdef
trigger1 = !movecontact
attr = A, SP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = MA
animtype = Middle
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = -1
guardsound = -1
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 13
ground.hittime = 13
ground.velocity = -3
guard.velocity = -2.5
air.type = High
air.hittime = 13
air.velocity = -8,-3*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
airguard.velocity = -3,-4*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 0
air.fall = 1
fall.recover = 1
fall.recovertime = 16
guard.kill = 0
p2facing = 1
numhits = 1

[state 4100, 1]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, vel]
type = parentvarset
trigger1 = movehit = 1
var(45) = 3
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, end]
type = changeanim
trigger1 = movecontact
trigger2 = animelemtime(2) = 0
value = 20000

[State 0, end]
type = statetypeset
trigger1 = root,movetype = H
trigger2 = movecontact
trigger3 = animelem = 2
movetype = I

[State 0, end]
type = DestroySelf
trigger1 = pos x <= -240 || pos x >= 240
trigger2 = root,movetype = H
trigger3 = time = 30

;==============================================================================
;法皇の結界(Main/Ground)
[Statedef 1100]
type = S
movetype = I
physics = N
ctrl = 0
anim = 195+(random%4)
velset = 0,0
poweradd = 0
sprpriority = 0
facep2 = 1

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 220
trigger2 = prevstateno = 410
trigger3 = prevstateno = 420
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 0, var]
type = varset
trigger1 = !time
var(6) = (var(6)|256)

[State 0, pos]
type = posset
trigger1 = !time
y = 0

;AI
[State 0, ctrl]
type = changestate
triggerall = var(59)
trigger1 = var(36) = 1000
trigger1 = !numhelper(1157)
trigger1 = time = 9
value = 1
ctrl = 0

;AI
[State 0, ctrl]
type = changestate
triggerall = var(59)
triggerall = time = 9
trigger1 = var(36) = 1031
trigger2 = var(36) = -20
trigger3 = var(36) = -10040
value = 1
ctrl = 0

;AI
[State 0, ctrl]
type = changestate
triggerall = var(59)
trigger1 = var(36) = 1011
trigger1 = numhelper(1155)
trigger1 = time = 9
value = 215
ctrl = 0

;AI
[State 0, ctrl]
type = changestate
triggerall = var(59)
trigger1 = var(36) = -1010
trigger1 = time = 9
value = 10900
ctrl = 0

[State 0, ctrl]
type = ctrlset
trigger1 = time = 9
value = 1

;---------------------------------------------------------------------------
;法皇の結界(Main/Air)
[Statedef 1101]
type = A
movetype = I
physics = N
ctrl = 0
anim = 20910
poweradd = 0
sprpriority = 0

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = p2dist x < 0

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 620
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse(var(5),.5,.6)

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, pos]
type = changestate
trigger1 = pos y >= 0
trigger1 = vel y > 0
value = 52

;---------------------------------------------------------------------------
;法皇の結界(スタンド)
[Statedef 1150]
type = U
movetype = I
physics = N
ctrl = 0
anim = 11100
velset = 0,0
sprpriority = -2

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, var]
type = varset
triggerall = !root,var(59)
trigger1 = !time
var(2) = ifelse(root,command = "214z",2,ifelse(root,command = "214y",1,ifelse(root,command = "214x",0,3)))

[State 1000, VarSet]
type = varset
triggerall = !root,var(59)
trigger1 = !time
triggerall = root,var(28)
var(2) = ifelse((root,var(28)&2**8),2,ifelse((root,var(28)&2**7),1,ifelse((root,var(28)&2**6),0,3)))

;AIデム後追撃(歩いてからor起き)
[State 0, var]
type = varset
triggerall = root,var(59)
triggerall = !time
trigger1 = root,var(36) = 1000
trigger2 = root,var(36) = -20
var(2) = ifelse(!numhelper(1156),1,2)

;AIデム後追撃(歩いてから2)
[State 0, var]
type = varset
triggerall = root,var(59)
trigger1 = !time
trigger1 = root,var(36) = 1011
var(2) = ifelse(!numhelper(1155),0,1)

;AI
[State 1000, VarSet]
type = varset
triggerall = root,var(59)
triggerall = !time
trigger1 = !root,var(36)
trigger2 = root,var(36) = -10040
var(2) = ifelse(!numhelper(1155),0,ifelse(!numhelper(1156),1,2))

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA;,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, var]
type = parentvarset
trigger1 = root,var(44) != 2
var(44) = 1

[State 0, snd]
type = playsnd
trigger1 = time = 6
value = 6,7

;結界設置
[state 0, helper]
type = helper
trigger1 = animelem = 4
helpertype = normal
stateno = 1155
id = 1155+var(2)
postype = p1
pos = 18-(ifelse(var(2)=3,0,var(2)*25)),-70
ownpal = 0
keyctrl = 0
pausemovetime = 0
supermovetime = 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;法皇の結界(スタンド)Air
[Statedef 1151]
type = U
movetype = I
physics = N
ctrl = 0
anim = 11100
velset = 0,0
sprpriority = -2

[State 0, btr]
type = bindtoroot
trigger1 = !time
pos = 0,10
time = 1

[State 0, var]
type = varset
triggerall = !root,var(59)
trigger1 = !time
var(2) = ifelse(root,command = "214z",2,ifelse(root,command = "214y",1,ifelse(root,command = "214x",0,3)))

[State 1000, VarSet]
type = varset
triggerall = !root,var(59)
trigger1 = !time
triggerall = root,var(28)
var(2) = ifelse((root,var(28)&2**8),2,ifelse((root,var(28)&2**7),1,ifelse((root,var(28)&2**6),0,3)))

;AIデム後追撃
[State 0, var]
type = varset
triggerall = root,var(59)
trigger1 = !time
trigger1 = root,var(36) = 1000
var(2) = 0

;AIデム後追撃(画面端)
[State 0, var]
type = varset
triggerall = root,var(59)
trigger1 = !time
trigger1 = root,var(36) = 1100
var(2) = 0

;AI
[State 1000, VarSet]
type = varset
triggerall = root,var(59)
triggerall = !time
trigger1 = !root,var(36)
trigger2 = root,var(36) = -140
var(2) = ifelse(!numhelper(1156),1,ifelse(!numhelper(1155),0,2))

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA;,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, var]
type = parentvarset
trigger1 = root,var(44) != 2
var(44) = 1

[State 0, snd]
type = playsnd
trigger1 = time = 6
value = 6,7

;結界設置
[state 0, helper]
type = helper
trigger1 = animelem = 4
helpertype = normal
stateno = 1155
id = 1155+var(2)
postype = p1
pos = 18-(ifelse(var(2)=3,0,var(2)*25)),-70
ownpal = 0
keyctrl = 0
pausemovetime = 0
supermovetime = 0

[State 0, end]
type = changestate
trigger1 = !animtime
value = 10000

;---------------------------------------------------------------------------
;法皇の結界(結界/設置)
[Statedef 1155]
type = A
movetype = I
physics = N
ctrl = 0
anim = 11152
velset = 0,0
sprpriority = 1

[State 0, var]
type = varset
trigger1 = !time
var(2) = parent,var(2)

[State 0, var]
type = parentvaradd
trigger1 = !time
var(54) = ifelse(var(2)=3,3,1)

[State 0, end]
type = changestate
triggerall = !root,var(59)
triggerall = time >= 4
trigger1 = var(2)=0 && root,command != "holdx"
trigger2 = var(2)=1 && root,command != "holdy"
trigger3 = var(2)=2 && root,command != "holdz"
trigger4 = var(2)=3 && root,command != "holdb"
trigger5 = root,var(9) = 2
trigger6 = root,stateno = 801
trigger7 = roundstate != 2
value = 1156

;kkk

;AI連携用a
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36)
triggerall = time >= 4
triggerall = var(2)=0
trigger1 = root,var(36) = 1000 || root,var(36) = 1002 || root,var(36) = 1005 || (root,var(36) = 1100&&!root,fvar(33));デム
trigger2 = root,var(36) = 1011;デム後近中後
trigger3 = root,var(36) = 1032;デム後お仕置き
trigger3 = enemynear(root,var(48)),stateno = 13222
trigger3 = enemynear(root,var(48)),time >= 24
trigger4 = root,var(36) = 1100;画面端デム後Son強後
trigger4 = root,stateno = 10220
trigger4 = root,animelemtime(13) >= 0 && root,movecontact
trigger4 = root,fvar(33) = 2
trigger5 = (root,var(36) = [1115,1116]);デム後お仕置き
trigger5 = enemynear(root,var(48)),stateno = 13222
trigger5 = enemynear(root,var(48)),time >= 24
trigger6 = (root,var(36) = [1115,1116]);対AIモード専用コン(お仕置き+二回20M締め)
trigger6 = root,stateno = 3610
trigger6 = root,animelemtime(11) >= 33
trigger7 = root,var(36) = -1010 && root,stateno = 10630
trigger8 = root,var(36) = -11
Trigger8 = (root,p2dist x = [-25,-15])
trigger9 = root,var(36) = 1025
Trigger9 = helper(50000),var(17) < 18
value = 1156

;AI連携用b
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36)
triggerall = time >= 4
triggerall = var(2)=1
trigger1 = (root,var(36) = [1001,1005]);デム
trigger1 = root,stateno = 50 && root,prevstateno = 42
trigger2 = root,var(36) = 1011;デム後近中後
trigger3 = (root,var(36) = [1100,1110]);画面端デム後Son強後
trigger3 = root,stateno = 10220
trigger3 = root,animelemtime(13) >= 0 && root,movecontact
trigger3 = root,fvar(33) = 1 || root,fvar(33) = 3
trigger4 = (root,var(36) = [1115,1116]);デム後お仕置き
trigger4 = enemynear(root,var(48)),stateno = 13222
trigger4 = enemynear(root,var(48)),time >= 24
trigger5 = (root,var(36) = [1115,1116]);対AIモード専用コン(お仕置き+二回20M締め)
trigger5 = root,stateno = 3610
trigger5 = root,animelemtime(11) >= 32
value = 1156

;AI連携用c
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36)
triggerall = time >= 4
triggerall = var(2)=2
trigger1 = root,var(36) = 1011 || root,var(36) = 1031 || root,var(36) = 1115;蹴り二回後
trigger1 = root,stateno = 210 && root,animelemtime(4) >= 0
trigger2 = root,var(36) = 1002
trigger2 = root,stateno = 10610 && root,movecontact
trigger3 = root,var(36) = 1020;ルート1020(二回20M)
trigger3 = helper(10000),animelemtime(16) >= 35
trigger4 = root,var(36) = 1005;ルート1005
trigger4 = parent,stateno = 1251 && parent,time >= 170
trigger4 = p2stateno = 1280 && (p2dist x = [-100,100])
trigger5 = root,var(36) = 1014;ルート1014
trigger5 = parent,stateno = 1251 && parent,time >= 170
trigger5 = (p2stateno = [1280,1282]) && (p2dist x = [-100,100])
value = 1156

;AI起き攻め
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36) < 0
triggerall = time >= 4
trigger1 = root,var(36) = -1 || root,var(36) = -10
trigger1 = root,movecontact || (root,stateno=10400)
trigger1 = (root,stateno = 10630 || root,stateno = 10400) && (p2dist x = [-80,80])
value = 1156

;AI起き攻め(消しとく)
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = time >= 4
trigger1 = root,var(11) && (p2dist x != [-80,80])
value = 1156

;AI崩し空D
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36) < 0
triggerall = time >= 4
trigger1 = root,var(36) = -1101
value = 1156

;AI立ち回り時の結界
[State 0, end]
type = changestate
triggerall = root,var(59) = 4
triggerall = !root,var(36) || root,var(36) = -11101
triggerall = time >= 4

triggerall = P2StateType != L
triggerall = P2stateno != 5120
triggerall = P2stateno != 5201

triggerall = (P2Dist x = [-45,55+(inguarddist)*50+(enemynear(root,var(48)),vel x > 5*(-1*(enemynear(var(48)),facing=-1)))*10])
triggerall = (P2Dist y = [-15+(enemynear(root,var(48)),vel y > 5)*15,90+(enemynear(root,var(48)),vel y < -5)*15]) || (root,inguarddist)
trigger1 = random < 60+(root,p2movetype!=I)*200+(!enemynear(root,var(48)),ctrl&&(p2stateno!=[0,159]))*100+(root,stateno=[120,159])*300+(root,inguarddist&&root,var(59)=7)*500+(!root,ctrl&&root,stateno!=21)*300
value = 1156

;AI待ち伏せ状態
[State 0, end]
type = changestate
triggerall = root,var(59) >= 7
triggerall = !root,var(36) || root,var(36) = -11101
triggerall = time >= 4

triggerall = P2StateType != L
triggerall = P2stateno != 5120
triggerall = P2stateno != 5201

triggerall = (P2Dist x = [-45,55+(root,inguarddist)*50+(enemynear(root,var(48)),vel x > 5*(-1*(enemynear(var(48)),facing=-1)))*10])
triggerall = (P2Dist y = [-15+(enemynear(root,var(48)),vel y > 5)*15,90+(enemynear(root,var(48)),vel y < -5)*15]) || (root,inguarddist)
trigger1 = (root,p2movetype=A)*300+(!enemynear(root,var(48)),ctrl&&(p2stateno!=[0,159]))*300+(root,stateno=[120,159])*300+(root,inguarddist&&root,var(59)=7)*300+(root,p2stateno=105&&enemynear(root,var(48)),time > 10)*250
value = 1156

;強制
[State 0, end]
type = changestate
triggerall = root,var(59) >= 7
triggerall = !root,var(36) || root,var(36) = -11101
triggerall = time >= 4
trigger1 = time > 900
value = 1156

[State 4010, 1]
type = varset
trigger1 = !root,var(36)
var(40) = 0
[State 4010, 1]
type = varadd
trigger1 = root,var(36) > 0
var(40) = 1

;AI強制
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = time >= 4
trigger1 = root,var(9) = 2
trigger2 = root,stateno = 801
trigger3 = roundstate != 2
trigger4 = root,var(36) = -1000
trigger5 = root,stateno = 300
trigger6 = rootdist x > 300
trigger7 = var(40) = 1
value = 1156

[State 4010, 1]
type = NotHitBy
trigger1 = (root,stateno = [150,152])
value = SCA
time = 1
ignorehitpause = 1

[State 4010, 1]
type = NotHitBy
trigger1 = !(root,stateno = [150,152])
value = , NT, ST, HT, NP, SP, HP
time = 1
ignorehitpause = 1

[State 4012, 1]
type = HitOverride
trigger1 = !time
attr = SCA, NA, SA, HA
stateno = 9530
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
trigger1 = root,stateno != [120,159]
value = 1160

[State 0, end]
type = varset
trigger1 = var(0) 
var(0) = 0

[state -2, debug]
type = DisplayToClipboard
trigger1 = 1
text = "x=%f y=%f"
params = p2dist x,p2dist y
ignorehitpause = 1

;---------------------------------------------------------------------------
;法皇の結界(結界/発動)
[Statedef 1156]
type = A
movetype = A
physics = N
anim = 11150
sprpriority = 3

[State 0, scale]
type = parentvaradd
trigger1 = prevstateno = 1155 && !time
var(54) = ifelse(var(2)=3,-3,-1)

[State 0, var]
type = varset
trigger1 = root,var(9) = 2
var(0) = 1

[State 0, var]
type = statetypeset
trigger1 = time >= 15
movetype = I

[State 0, snd]
type = playsnd
trigger1 = time = 4
value = 6,8
channel = 2

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, scale]
type = varadd
trigger1 = 1
var(5) = 1

[State 0, scale]
type = varset
trigger1 = time < 50
fvar(10) = 1-(.02*time)

[State 0, scale]
type = varset
trigger1 = time < 50
fvar(11) = 1-(.02*time)

[State 0, scale]
type = varset
trigger1 = time < 12
fvar(10) = .02+time*.08

[State 0, scale]
type = varset
trigger1 = time < 12
fvar(11) = .02+time*.08

[State 0, scale]
type = varset
trigger1 = time >= 12
fvar(10) = 1-(.017*(time-12))

[State 0, scale]
type = varset
trigger1 = time >= 12
fvar(11) = 1-(.017*(time-12))

[State 0, scalef]
type = angledraw
trigger1 = 1
scale = fvar(10),fvar(11)

[State 0, hit]
type = hitdef
trigger1 = !movecontact
;trigger1 = time = [4,7]
attr = A, SP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = MA
animtype = Middle
air.animtype = low
fall.animtype = low
pausetime = 0,70
guard.pausetime = 0,23
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 20,0
ground.type = Low
ground.slidetime = 1
ground.hittime = 1
ground.velocity = 0,0
guard.velocity = 0
air.type = Low
air.hittime = 1
air.velocity = -1,-6*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 80
palfx.sinadd = 96,96,96,4
fall = 0
air.fall = 1
fall.recovertime = 84
guard.kill = 0
numhits = 1

[state -2, var]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 0, var]
type = varset
trigger1 = movehit = 1
var(10) = 1

[State 0, power]
type = poweradd
trigger1 = var(10)
value = 40

[State 0, var]
type = varset
trigger1 = 1
var(10) = 0

[state 4100, 1]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = movecontact = 1
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

;痺れエフェクト1
[State 0, explod]
type = explod
trigger1 = movehit = 1
anim = 6060
id = 6060
postype = p2
pos = 0,-55
bindtime = -1
removetime = 100
scale = 1.4,1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

;痺れエフェクト2
[State 0, explod]
type = explod
trigger1 = movehit = 1
anim = 6061
id = 6060
postype = p2
pos = 0,-85
bindtime = -1
removetime = 100
scale = 1,.9
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

;痺れエフェクト3
[State 0, explod]
type = explod
trigger1 = movehit = 1
anim = 6062
id = 6060
postype = p2
pos = 0,-20
bindtime = -1
removetime = 100
scale = 1,.9
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, end]
type = changestate
trigger1 = movecontact
trigger1 = time = 15
value = 1157

[State 0, end]
type = DestroySelf
trigger1 = time = 70

[State 0, end]
type = changestate
trigger1 = root,movetype = H
trigger1 = root,stateno != [120,159]
value = 1160

;---------------------------------------------------------------------------
;法皇の結界(結界/hit)
[Statedef 1157]
type = A
movetype = I
physics = N
;anim = 1155
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = root,var(9) = 2
var(0) = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,9
channel = 2

[State 0, scale]
type = angledraw
trigger1 = time < 10
scale = 1+time*.12,1+time*.12

[State 0, scale]
type = angledraw
trigger1 = time = [10,14]
scale = 2.2-(time-10)*.05,2.2-(time-10)*.05

[State 0, scale]
type = angledraw
trigger1 = time > 14
scale = 2,2

[State 0, assert]
type = assertspecial
trigger1 = time >= 28
trigger1 = !(time%2)
flag = Invisible

[State 0, explod]
type = removeexplod
triggerall = numexplod(6060)
trigger1 = enemynear,statetype = L
id = 6060

[State 0, anim]
type = changeanim
trigger1 = time = 70
value = 20000

[State 0, end]
type = DestroySelf
trigger1 = time = 162
trigger2 = anim = 20000
trigger2 = var(0)

;---------------------------------------------------------------------------
;法皇の結界(結界/消滅)
[Statedef 1160]
type = A
movetype = A
physics = N
anim = 11150
sprpriority = 3

[State 0, scale]
type = parentvaradd
trigger1 = prevstateno = 1155 && !time
var(54) = ifelse(var(2)=3,-3,-1)

[state -2, debug]
type = DisplayToClipboard
trigger1 = 1
text = "x = %f y = %f"
params = fvar(20),fvar(21)
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, scale]
type = varset
trigger1 = prevstateno != 1156
fvar(10) = 1
[State 0, scale]
type = varset
trigger1 = prevstateno != 1156
fvar(11) = 1

[State 0, scale]
type = varset
trigger1 = 1
fvar(20) = fvar(10)-(.02*time)
[State 0, scale]
type = varset
trigger1 = 1
fvar(21) = fvar(11)-(.02*time)

[State 0, scale]
type = angledraw
trigger1 = time < 50
scale = fvar(20),fvar(21)

[State 0, anim]
type = changeanim
trigger1 = time = 50
value = 20000

[State 0, end]
type = DestroySelf
trigger1 = time = 51
trigger2 = fvar(20) <= 0

;==============================================================================
;タイラップスネーク(Main)
[Statedef 1200]
type = S
movetype = I
physics = S
ctrl = 0
anim = (195+random%4)
velset = 0,0
sprpriority = 0
facep2 = 1

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 220
trigger2 = prevstateno = 410
trigger3 = prevstateno = 420
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 0, var]
type = varset
trigger1 = !time
var(6) = (var(6)|256)

[State 0, pos]
type = posset
trigger1 = !time
y = 0

;AI
[State 0, state]
type = changestate
triggerall = var(59)
trigger1 = time = 9
value = 1
ctrl = 0

[State 0, ctrl]
type = ctrlset
trigger1 = time = 9
value = 1

[State 0, state]
type = changestate
trigger1 = ctrl
value = 196
ctrl = 1

;---------------------------------------------------------------------------
;タイラップスネーク(スタンド/溜め)
[Statedef 1250]
type = U
movetype = I
physics = N
ctrl = 0
anim = 1250
velset = 0,0
sprpriority = -2

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 0, var]
type = varset
triggerall = !root,var(59)
trigger1 = !time
var(2) = ifelse(root,command = "214z",2,ifelse(root,command = "214y",1,0))

[State 1000, VarSet]
type = varset
triggerall = !root,var(59)
trigger1 = !time
triggerall = root,var(28)
var(2) = ifelse((root,var(28)&2**5),2,ifelse((root,var(28)&2**4),1,0))

[State 1000, VarSet]
type = varset
triggerall = root,var(59)
trigger1 = !time
var(2) = 2

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, width]
type = width
trigger1 = 1
value = 15,15

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, var]
type = varset
trigger1 = !time
var(11) = 0

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, snd]
type = playsnd
trigger1 = !time
value = 6,8

[State 0, end]
type = changestate
triggerall = !root,var(59)
triggerall = time >= 9
trigger1 = var(2)=0 && root,command != "holdx" && root,command != "holdb"
trigger2 = var(2)=1 && root,command != "holdy"
trigger3 = var(2)=2 && root,command != "holdz"
trigger4 = roundstate != 2
value = 1251

;AI連係
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36) >= 0 || root,var(36) <= -10000
triggerall = time >= 9
trigger1 = var(2)=2
value = 1251

;AI連係
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = root,var(36) = -1250
triggerall = time >= 9
triggerall = root,stateno = 50;root,vel y > 0
trigger1 = var(2)=2
value = 1251

;AI強制
[State 0, end]
type = changestate
triggerall = root,var(59)
triggerall = time >= 9
trigger1 = roundstate != 2
trigger2 = p2statetype = A
value = 1251

;---------------------------------------------------------------------------
;タイラップスネーク(スタンド/発射)
[Statedef 1251]
type = U
movetype = A
physics = N
ctrl = 0
anim = 1251

[State 0, state]
type = statetypeset
trigger1 = time = 10
movetype = I
ignorehitpause = 1

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[state 0, helper]
type = width
trigger1 = var(11)
edge = 80,0

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, nhb]
type = nothitby
trigger1 = !var(11)
value = ,AT

[State 0, nhb]
type = nothitby
trigger1 = var(11)
value = SCA

[State 0, end]
type = changestate
trigger1 = !var(11)
trigger1 = root,movetype = H
value = 9505

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = animelem = 4
value = 6,10

;上半身
[state 0, helper]
type = helper
trigger1 = animelem = 4
helpertype = normal
stateno = 1260
id = 1260
postype = p1
pos = 73,0
ownpal = 0
keyctrl = 0
pausemovetime = 0
supermovetime = 0

[State 0, var]
type = parentvarset
trigger1 = 1
var(11) = var(11)

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = time >= 40
trigger1 = !var(11)
value = 1252

;---------------------------------------------------------------------------
;タイラップスネーク(スタンド/終了)
[Statedef 1252]
type = U
movetype = I
physics = N
ctrl = 0
anim = 1252

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[state 0, helper]
type = helper
trigger1 = !numhelper(1255)
trigger1 = !time
helpertype = normal
stateno = 1255
id = 1255
postype = p1
pos = 0,0
ownpal = 0
keyctrl = 0
pausemovetime = 0
supermovetime = 0

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = animelem = 3
value = 0,15

[State 0, assert]
type = assertspecial
trigger1 = time >= 7
trigger1 = !(time%2)
flag = Invisible

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, scale]
type = angledraw
trigger1 = time >= 7
scale = (const(size.xscale)-(.08*(time-7))),(const(size.yscale)+(.06*(time-7)))

[State 0, anim]
type = changeanim
trigger1 = time >= 19
value = 20000

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = time >= 19
value = 10000

;---------------------------------------------------------------------------
;タイラップスネーク(上半身/発射)
[Statedef 1260]
type = U
movetype = A
physics = N
ctrl = 0
anim = 1260
velset = 6,0
sprpriority = 1

[State 0, vel]
type = varset
trigger1 = !time
var(54) = 0

[State 0, var]
type = parentvarset
trigger1 = movehit = 1
var(10) = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time < 18
fvar(0) = 1+time*.75

[State 0, var]
type = varset
trigger1 = time >= 18
fvar(0) = 12.56-(time-18)*.75

;発光ヘルパー
[state -2, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "kirakira3"
stateno = 40002
id = 40002
postype = p1
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

;紐
[State 0, explod]
type = explod
trigger1 = !time && facing = 1
anim = 1261
id = 1261
postype = p1
pos = -14,0
bindtime = -1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 2
ownpal = 0

;紐
[State 0, explod]
type = explod
trigger1 = !time && facing = -1
anim = 1261+(facing=-1)
id = 1261
postype = p1
pos = -14,0
bindtime = -1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 2
ownpal = 0

;紐
[State 0, explod]
type = explod
trigger1 = time = 18 && facing = -1
anim = 1262
id = 1262
postype = p1
pos = -114,0
bindtime = 1
removetime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = 2
ownpal = 0

[State 0, hit]
type = hitdef
triggerall = !movecontact
trigger1 = animelem = 1
trigger2 = animelem = 2
attr = S,SA
priority = 4,Miss
hitflag = MF
guardflag = L
pausetime = 0,0
sparkno = -1
sparkxy = 0,-20
guard.sparkno = s6010
hitsound = s0,16
guardsound = s0,9
getpower = 0,0
givepower = 20,0
ground.slidetime = 24
ground.hittime = 24
p1stateno = 1261
p2stateno = 1280
p2facing = 1
fall = 1
id = 1200
nochainid = 1200
numhits = 0

[State 0, hit]
type = hitdef
triggerall = p2stateno = 5000
triggerall = !movecontact
trigger1 = animelem = 1
trigger2 = animelem = 2
attr = S,SA
priority = 4,Miss
hitflag = MAF
guardflag = L
pausetime = 0,0
sparkno = -1
sparkxy = 0,-20
guard.sparkno = s6010
hitsound = s0,16
guardsound = s0,9
getpower = 0,0
givepower = 20,0
ground.slidetime = 24
ground.hittime = 24
p1stateno = 1261
p2stateno = 1280
p2facing = 1
fall = 1
id = 1200
nochainid = 1200
numhits = 0

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(1261)
id = 1261
scale = fvar(0),const(size.yscale)

[State 0, vel]
type = velset
trigger1 = time = 18
x = -6

[State 0, state]
type = statetypeset
trigger1 = time = 18
movetype = I
ignorehitpause = 1

[State 0, remove]
type = removeexplod
trigger1 = root,movetype = H
trigger2 = parent,stateno = 1252 || parent,stateno = 11202
trigger3 = time = 36
id = 1261

[State 0, remove]
type = removeexplod
trigger1 = root,movetype = H
trigger2 = parent,stateno = 1252 || parent,stateno = 11202
trigger3 = time = 36
id = 1262

[State 0, end]
type = DestroySelf
trigger1 = root,movetype = H
trigger2 = parent,stateno = 1252 || parent,stateno = 11202 || parent,stateno = 10000

;---------------------------------------------------------------------------
;タイラップスネーク(上半身/拘束)
[Statedef 1261]
type = S
movetype = A
physics = N
ctrl = 0
anim = 1270
velset = 0,0
sprpriority = 2

[State 0, vel]
type = varset
trigger1 = !time
var(54) = 0

[State 0, assert]
type = screenbound
trigger1 = 1
value = 1
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
triggerall = numexplod(1261)
trigger1 = !time
id = 1261
postype = p1
pos = -48,0

;発光ヘルパー
[state -2, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "kirakira3"
stateno = 40002
id = 40002
postype = p1
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varset
trigger1 = !time
fvar(1) = fvar(0)

[State 0, snd]
type = playsnd
trigger1 = !time
value = 6,11

[State 0, pos]
type = posadd
trigger1 = !time
x = 35

[State 0, explod]
type = explod
trigger1 = !time
anim = 1271
id = 1271
postype = p1
pos = 0,0
bindtime = -1
scale = const(size.xscale),const(size.yscale)
sprpriority = -1
ownpal = 0

[State 0, target]
type = targetbind
triggerall = numtarget(1200)
triggerall = target,alive
trigger1 = time < 51
trigger1 = var(54) < 8
pos = 0,-3
time = 1

[State 0, target]
type = targetbind
triggerall = numtarget(1200)
triggerall = target,alive
trigger1 = time = [51,ifelse(root,var(0),100,165))
trigger1 = var(54) < 8
pos = ifelse(time%10<5,-1,1),-3
time = 1

[State 0, snd]
type = playsnd
trigger1 = time = 51
trigger2 = time = 66
trigger3 = time = 81
trigger4 = time = 96
trigger5 = time = 111
trigger6 = time = 126
trigger7 = time = 141
value = 6,12
channel = 2

[State 0, snd]
type = stopsnd
trigger1 = time = ifelse(root,var(0),95,160)
trigger2 = anim = 1260
channel = 2

[State 0, var]
type = parentvarset
trigger1 = !time
var(11) = 1

[State 0, life]
type = targetlifeadd
triggerall = numtarget
trigger1 = animelem = 15
value = ceil(ifelse((-7*root,fvar(0))>-7,-7,(-7*root,fvar(0))))
kill = 1

[State 0, vel]
type = varset
trigger1 = root,movehit
trigger2 = numhelper(11250)
trigger2 = helper(11250),movehit
var(55) = 1

[State 0, vel]
type = varadd
triggerall = numtarget
triggerall = !var(55)
trigger1 = target,command = "fwd"
trigger2 = target,command = "back"
var(54) = 1

[State 0, target]
type = targetstate
triggerall = numtarget
trigger1 = var(54) >= 8
value = 1270

[State 0, target]
type = targetstate
triggerall = numtarget
trigger1 = time = [0,ifelse(root,var(0),100,165))
trigger1 = target,alive
trigger1 = var(54) < 8
value = 1280

[State 0, target]
type = targetstate
triggerall = numtarget
trigger1 = target,alive
trigger1 = time = ifelse(root,var(0),100,165)
value = 1281
persistent = 0

[State 0, target]
type = targetstate
triggerall = numtarget
trigger1 = !target,alive
value = 1290
persistent = 0

[State 0, state]
type = statetypeset
trigger1 = time = ifelse(root,var(0),100,165)
trigger2 = numtarget
trigger2 = !target,alive
movetype = I
ignorehitpause = 1
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = time = ifelse(root,var(0),100,165)
trigger2 = numtarget
trigger2 = !target,alive
trigger3 = var(54) >= 8
value = 1260
persistent = 0

[State 0, pos]
type = posadd
trigger1 = anim = 1260
x = -35
persistent = 0

[State 0, vel]
type = velset
trigger1 = anim = 1260
x = -7
persistent = 0

[State 0, var]
type = varadd
trigger1 = anim = 1260
var(0) = 1

[State 0, var]
type = varset
trigger1 = anim = 1260
fvar(0) = fvar(1)-(var(0)*.88)

[State 0, explod]
type = modifyexplod
triggerall = numexplod(1261)
trigger1 = anim = 1260
id = 1261
postype = p1
pos = -14,0
scale = fvar(0),const(size.yscale)

[State 0, var]
type = parentvarset
trigger1 = fvar(0) <= 0
var(11) = 0

[State 0, explod]
type = removeexplod
trigger1 = fvar(0) <= 0
id = 1261

[State 0, explod]
type = removeexplod
trigger1 = parent,Ishelper(10000)
trigger1 = parent,stateno = 1251
trigger2 = !parent,Ishelper
trigger2 = parent,stateno = 11202
id = 1271

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, end]
type = changestate
trigger1 = fvar(0) <= 0
value = 1262

;-------------------------------------------------------------------------
;終了
[Statedef 1262]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 20000

[State 0, end]
type = destroyself
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = target,stateno != [1280,1285]

;-------------------------------------------------------------------------
;相手もどり
[Statedef 1270]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0

[State 1051, 2]
type = posadd
trigger1 = time = 0
x = -50

[State 1051, 2]
type = posset
trigger1 = time = 0
y = 0

[State 1051, 2]
type = Changeanim
trigger1 = time = 0
value = 47

[State 1051, 2]
type = selfstate
trigger1 = time >= 1
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;画面固定
[Statedef 1255]
type = U
movetype = I
physics = N
ctrl = 0
anim = 20000
velset = 0,0
sprpriority = -4

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 1,0

[State 0, end]
type = destroyself
trigger1 = !numhelper(1260)

;---------------------------------------------------------------------------
;敵拘束
[Statedef 1280]
type = S
movetype = H
physics = N
ctrl = 0
anim = 5070
velset = 0,0
sprpriority = 0

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 0, anim]
type = changeanim
trigger1 = 1
value = anim
elem = 1

;---------------------------------------------------------------------------
;敵横吹っ飛び（生存時）
[Statedef 1281]
type = A
movetype = H
physics = N
anim = 5030
velset = -5,-8

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, nhb]
type = null;nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = .3

[State 0, push]
type = playerpush
trigger1 = vel y < -2
value = 0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = SelfAnimExist(5900)
value = 5900
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = anim = 5030
trigger1 = vel y < 0
value = 5030
elem = 1

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, end]
type = changestate
trigger1 = backedgebodydist <= 10
value = 1282

[State 0, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5114

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 5114]
type    = L
movetype= H
physics = N

[State 0, 1]
type = DestroySelf
trigger1 = IsHelper
trigger1 = time = 0

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 14

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 1223, 自分のステートへ]
type = SelfState
trigger1 = time = 40
value = 5081

;---------------------------------------------------------------------------
;敵横吹っ飛び2（生存時）
[Statedef 1285]
type = A
movetype = H
physics = N
anim = 5030
velset = -5,-8

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, nhb]
type = null;nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = .3

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = SelfAnimExist(5900)
value = 5900
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = anim = 5030
trigger1 = vel y < 0
value = 5030
elem = 1

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, end]
type = changestate
trigger1 = backedgebodydist <= 10
value = 1282

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;敵横吹っ飛び3-1（生存時）
[Statedef 1286]
type = A
movetype = H
physics = N
velset = 0,0

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = ChangeState
trigger1 = HitShakeOver
value = 1287

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
;敵横吹っ飛び3-2
[Statedef 1287]
type = A
movetype = H
physics = N
anim = 5030

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, nhb]
type = null;nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, hitvel]
type = hitvelset
trigger1 = !time
x = 1
y = 1

[State 0, push]
type = playerpush
trigger1 = 1
value = 1

[State 0, anim]
type = changeanim
trigger1 = anim = 5030
trigger1 = vel y < 0
value = 5030
elem = 1

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, end]
type = changestate
trigger1 = backedgebodydist <= 10
value = 1283

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 10
value = 5100

;---------------------------------------------------------------------------
;敵横吹っ飛び（壁激突）
[Statedef 1282]
type = A
movetype = H
physics = N
anim = 5012
velset = 0,0

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, shake]
type = envshake
trigger1 = !time
time = 10
freq = 85
ampl = -5

[State 0, anim]
type = changeanim
trigger1 = time < 10
value = anim

[State 0, anim]
type = changeanim
trigger1 = time = 10
value = 5050

[State 0, vel]
type = velset
trigger1 = time = 10
x = 1
y = -3

[State 0, turn]
type = turn
trigger1 = time = 10

[State 0, vel]
type = veladd
trigger1 = time > 10
y = .4

[State 5040, 5] ;Recover near ground
type = SelfState
;triggerall = prevstateno = 1281
triggerall = time >= 10
triggerall = Pos Y >= -20
triggerall = alive
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5040, 6]; Recover in mid air
type = SelfState
;triggerall = prevstateno = 1281
triggerall = time >= 10
triggerall = alive
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 0, end]
type = changestate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5114

;---------------------------------------------------------------------------
;敵横吹っ飛び2（壁激突）
[Statedef 1283]
type = A
movetype = H
physics = N
anim = 5012
velset = 0,0

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, shake]
type = envshake
trigger1 = !time
time = 10
freq = 85
ampl = -5

[State 0, anim]
type = changeanim
trigger1 = time < 10
value = anim

[State 0, anim]
type = changeanim
trigger1 = time = 10
value = 5050

[State 0, vel]
type = velset
trigger1 = time = 10
x = 1
y = -2

[State 0, turn]
type = turn
trigger1 = time = 10

[State 0, vel]
type = veladd
trigger1 = time > 10
y = .4

[State 5040, 5] ;Recover near ground
type = SelfState
;triggerall = prevstateno = 1281
triggerall = time >= 10
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5040, 6]; Recover in mid air
type = SelfState
;triggerall = prevstateno = 1281
triggerall = time >= 10
triggerall = Vel Y > 0
triggerall = alive
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;敵吹っ飛び（死亡時）
[Statedef 1290]
type = A
movetype = H
physics = N
anim = 5030
velset = -8,-8

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, nhb]
type = null;nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = .44

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, anim]
type = changeanim
trigger1 = anim = 5030
trigger1 = !animtime
trigger1 = SelfAnimExist(5035)
value = 5035
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100
;==============================================================================
;敵吹っ飛び
[Statedef 2000]
type = A
movetype = H
physics = N
anim = 5030
velset = -9,-4

[State 0, anim]
type = changeanim
trigger1 = anim = 5030 && !animtime
trigger1 = SelfAnimExist(5035)
value = 5035

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, vel]
type = veladd
trigger1 = 1
y = .36

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, end]
type = changestate
trigger1 = backedgebodydist <= 10
value = 2001

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;敵吹っ飛び（壁激突）
[Statedef 2001]
type = A
movetype = H
physics = N
anim = 5012
velset = 0,0

[State 0, shake]
type = envshake
trigger1 = !time
time = 10
freq = 85
ampl = -5

[State 0, anim]
type = changeanim
trigger1 = time < 6
value = anim

[State 0, anim]
type = changeanim
trigger1 = time = 6
value = 5050

[State 0, vel]
type = velset
trigger1 = time = 6
x = 2
y = -4

[State 0, turn]
type = turn
trigger1 = time = 6

[State 0, vel]
type = veladd
trigger1 = time > 6
y = .36

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;==============================================================================
;半径20Mエメラルドスプラッシュ(Main.Ver)
[Statedef 3000]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195+(random%4)
velset = 0,0
sprpriority = 0
facep2 = 1

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 220
trigger2 = prevstateno = 410
trigger3 = prevstateno = 420
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 0, var]
type = varset
trigger1 = !time
var(6) = (var(6)|256)

[State 0, nhb]
type = nothitby
trigger1 = time = [14,31]
value = SCA
time = 1

[State 0, end]
type = changestate
trigger1 = time = 9
value = 196

;------------------------------------------------------------------------------
;半径20M(Stand)
[Statedef 3050]
type = S
movetype = A
physics = N
ctrl = 0
anim = 3050
sprpriority = -2

[State 0, vel]
type = varset
trigger1 = !time
fvar(32) = 0
ignorehitpause = 1

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 1100, VarSet]
type = VarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(4) = root,fvar(3)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4) < .1
trigger2 = NumTarget
trigger2 = target,statetype = A && target,gethitvar(groundtype)!=3
trigger3 = movetype = H
fvar(4) = 0

[State -2, CornerPush]
type = PosAdd
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
trigger1 = StateType != A || (StateType = A && !var(8))
trigger1 = root,fvar(5)
x = -fvar(4)

[State -2, CornerPush]
type = VarSet
trigger1 = (!var(8) || var(43)) && fvar(4)
trigger1 = NumHelper(10000)
trigger1 = !NumHelper(7000) && !NumHelper(8000) && !root,NumHelper(7000) && !root,NumHelper(8000)
fvar(4) = fvar(4)*.75

[State 1100, VarSet]
type = ParentVarSet
triggerall = !root,var(8)
trigger1 = Time = 0
fvar(3) = 0

[State 1100, VarSet]
type = VarSet
trigger1 = fvar(4)
trigger1 = Time = 0
fvar(3) = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 9500
attr = SCA,NA,SA,HA,NP,SP,HP
time = -1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, spr]
type = sprpriority
trigger1 = 1
value = -2

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA
time = 1

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, hit]
type = hitdef
triggerall = !movecontact
trigger1 = animelem = 2
trigger2 = animelem = 3
attr = S, HA
damage = 0
priority = 5,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = -9,-72
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0*!IsHelper,0
givepower = 0*!IsHelper,0
ground.type = High
ground.slidetime = 14
ground.hittime = 14
ground.velocity = -6
guard.velocity = -5.5
air.type = High
air.velocity = -2,-5*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 14
fall = 0
air.fall = 1
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, end]
type = parentvaradd
trigger1 = movehit = 1
var(40) = 1

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 8.3
ignorehitpause = 1

;コーナープッシュ処理
[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = !fvar(3)
fvar(5) = 0

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = numtarget
trigger1 = target,BackEdgeBodyDist <= 5 || target,FrontEdgeBodyDist <= 5
fvar(5) = 1

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = movecontact = 1
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = fvar(3) = [0,.1]
trigger2 = NumTarget
trigger2 = target,statetype = A && target,stateno != [5070,5071]
trigger3 = root,fvar(3)
fvar(3) = 0

[State -2, CornerPush]
type = PosAdd
triggerall = IsHelper
triggerall = fvar(3)
triggerall = fvar(5)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
x = -fvar(3)

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
triggerall = fvar(3)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
fvar(3) = fvar(3)*.75

[state 4100, 1]
type = envcolor
trigger1 = movehit
trigger1 = helper(7520),var(46)
value = 0,0,0
time = 1
persistent = 0
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 17
value = 3,6
channel = 0

[State 0, super]
type = superpause
trigger1 = time = 17
time = 30
movetime = 30
anim = -1
sound = s0,21
darken = 0
p2defmul = 1
poweradd = -1000

[State 0, explod]
type = explod
trigger1 = time = 17
anim = 7100
id = 7100
pos = 0,ceil(-83*const(size.yscale))
postype = p1
scale = .8,.8
sprpriority = 5
pausemovetime = 999999
supermovetime = 999999

[state 0, helper]
type = helper
trigger1 = time = 17
helpertype = normal
name = "super"
stateno = 7000
id = 7000
pos = 0,0
postype = p1
pausemovetime = 999999
supermovetime = 999999

[State 0, snd]
type = playsnd
trigger1 = animelemtime(16) = 0
value = 3,2
channel = 0

[State 0, snd]
type = playsnd
trigger1 = animelemtime(16) = [5,40]
trigger1 = !(time%5) || (time = [35,37])
value = 6,3
channel = ifelse(animelemtime(16)<=37,3,random<5000)

[State 0, snd]
type = null;playsnd
trigger1 = animelemtime(16) = 5
trigger2 = animelemtime(16) = 9
trigger3 = animelemtime(16) = 13
trigger4 = animelemtime(16) = 17
trigger5 = animelemtime(16) = 21
trigger6 = animelemtime(16) = 25
trigger7 = animelemtime(16) = 29
trigger8 = animelemtime(16) = 33
trigger9 = animelemtime(16) = 37
trigger10 = animelemtime(16) = 41
trigger11 = animelemtime(16) = 45
value = 6,3
;channel = 3

[state 0, helper]
type = helper
trigger1 = animelemtime(16) = 0
trigger2 = animelemtime(16) = 3
trigger3 = animelemtime(16) = 6
trigger4 = animelemtime(16) = 9
trigger5 = animelemtime(16) = 12
trigger6 = animelemtime(16) = 15
trigger7 = animelemtime(16) = 18
trigger8 = animelemtime(16) = 21
trigger9 = animelemtime(16) = 24
trigger10 = animelemtime(16) = 27
trigger11 = animelemtime(16) = 30
trigger12 = animelemtime(16) = 33
trigger13 = animelemtime(16) = 36
helpertype = normal
name = "20m emesp"
stateno = 3060
id = 3060+(fvar(32)>0)
postype = p1
pos = ceil(-43*const(size.xscale)),ceil(-77-(random%20))
ownpal = 1

[state 0, helper]
type = helper
trigger1 = animelemtime(16) = 0
trigger2 = animelemtime(16) = 1
trigger3 = animelemtime(16) = 8
trigger4 = animelemtime(16) = 9
trigger5 = animelemtime(16) = 15
trigger6 = animelemtime(16) = 18
trigger7 = animelemtime(16) = 19
trigger8 = animelemtime(16) = 26
trigger9 = animelemtime(16) = 27
trigger10 = animelemtime(16) = 32
trigger11 = animelemtime(16) = 33
helpertype = normal
name = "20m emesp"
stateno = 3060
id = 3060+(fvar(32)>0)
postype = p1
pos = ceil(-43*const(size.xscale)),ceil(-77-(random%20))
ownpal = 1

[state 0, helper]
type = helper
trigger1 = animelemtime(16) = 17
trigger2 = animelemtime(16) = 25
trigger3 = animelemtime(16) = 38
helpertype = normal
name = "20m emesp"
stateno = 3061
id = 3060+(fvar(32)>0)
postype = p1
pos = ceil(-43*const(size.xscale)),ceil(-77-(random%20))
ownpal = 1

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = animelemtime(16) = 38
value = 9001

;---------------------------------------------------------------------------
;半径20M(弾)
[Statedef 3060]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 3

[State 0, pal]
type = varset
trigger1 = parent,Ishelper(10000)
trigger1 = (parent,stateno = [3600,3999])
var(30) = 1

[State 0, pal]
type = palfx
trigger1 = time = (random%5)
time = 14
sinadd = 80,80,80,28

[State 0, var]
type = varrandom
trigger1 = !time
v = 10
range = 0,29

[State 0, var]
type = varset
trigger1 = !time
var(11) = (var(10)%5)

[State 0, anim]
type = changeanim
trigger1 = !time
value = 3090+floor(var(10)/10)

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, vel]
type = velset
trigger1 = !time
x = 34
y = -2+var(11)*2.625

[State 0, vel]
type = velset
triggerall = !root,var(59)
trigger1 = !time
trigger1 = !parent,Ishelper
trigger1 = parent,stateno != 3901
trigger1 = parent,command = "holdfwd"
x = 34
y = -2+var(11)*1.3

;AI
[State 0, vel]
type = velset
triggerall = root,var(59)
triggerall = !time
triggerall = !parent,Ishelper
triggerall = parent,stateno != 3901
trigger1 = root,var(36) = 1005 || root,var(36) = 1020
trigger2 = root,var(36) = -11 && root,p2statetype != C
x = 34
y = -2+var(11)*1.3

[State 0, vel]
type = velset
triggerall = !root,var(59)
trigger1 = !time
trigger1 = !parent,Ishelper
trigger1 = parent,stateno != 3901
trigger1 = parent,command = "holdback"
x = 34
y = -12+var(11)*6

;AI
[State 0, vel]
type = velset
triggerall = root,var(59)
triggerall = !time
triggerall = !parent,Ishelper
triggerall = parent,stateno != 3901
trigger1 = root,var(36) = -11 && root,p2bodydist y < -80
x = 34
y = -12+var(11)*6

[State 0, explod]
type = explod
trigger1 = !time
anim = (3062+(floor(var(10)/10)*10))-(vel y <=-4)-(vel y <=-8)+(vel y >=4)+(vel y >=8)
id = 3060
postype = p1
pos = 0,0
sprpriority = 4
ownpal = 1
bindtime = -1

[State 0, hit]
type = hitdef
trigger1 = !var(30)
attr = A, HP
damage = ceil(ifelse((14*root,fvar(0))<7,7,(14*root,fvar(0)))),ceil(ifelse((14*root,fvar(0)*.25)<7,7,(14*root,fvar(0)*.25)))
priority = 5,Hit
hitflag = MAF
guardflag = MA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,2
guard.pausetime = 0,0
sparkno = s6004
sparkxy = 5,0
guard.sparkno = s6010
hitsound = -1;s0,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 19
ground.hittime = 19
ground.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
airguard.velocity = -4,-3
air.type = High
air.hittime = 5
air.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 1
air.fall = 1
fall.recover = 1
fall.recovertime = 8
guard.kill = 0
yaccel = .36
persistent = 0
p2facing = 1
id = 3060

[State 0, hit]
type = hitdef
trigger1 = var(30)
attr = A, HP
damage = ceil(ifelse((14*.25*root,fvar(0))<7,7,(14*.25*root,fvar(0)))),ceil(ifelse((14*.25*root,fvar(0)*.25)<7,7,(14*.25*root,fvar(0)*.25)))
priority = 5,Hit
hitflag = MAF
guardflag = MA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,2
guard.pausetime = 0,0
sparkno = s6004
sparkxy = 5,0
guard.sparkno = s6010
hitsound = -1;s0,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 19
ground.hittime = 19
ground.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
airguard.velocity = -4,-3
air.type = High
air.hittime = 5
air.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 1
air.fall = 1
fall.recover = 1
fall.recovertime = 8
guard.kill = 0
yaccel = .36
persistent = 0
p2facing = 1
id = 3060

[State 0, vel]
type = parentvaradd
trigger1 = !parent,ishelper
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, vel]
type = parentvarset
trigger1 = numtarget
fvar(32) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, end]
type = statetypeset
trigger1 = movecontact = 1
movetype = I

[state 4100, 1]
type = envcolor
trigger1 = movehit = 1
trigger1 = helper(7520),var(46)
value = 255,255,255
time = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(45) = 1
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, vel]
type = parentvarset
trigger1 = !parent,ishelper
trigger1 = movehit = 1
var(55) = 1
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = !parent,ishelper
trigger1 = moveguarded = 1
var(55) = 2
ignorehitpause = 1

[State 0, end]
type = removeexplod
trigger1 = pos x <= -280 || pos x >= 280
trigger2 = pos y >= 40
trigger3 = movecontact = 1
id = 3060

[State 0, end]
type = changeanim
trigger1 = movecontact = 1
value = 20000

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, end]
type = DestroySelf
triggerall = (!numtarget)
trigger1 = pos x <= -280 || pos x >= 280
trigger2 = pos y >= 40

[State 0, end]
type = DestroySelf
triggerall = (numtarget)
triggerall = Ishelper(3061)
triggerall = numhelper(3060)
truggerall = helper(3060),numtarget
trigger1 = movecontact >= 2
trigger2 = pos x <= -280 || pos x >= 280
trigger3 = pos y >= 40

;---------------------------------------------------------------------------
;半径20M(弾)2
[Statedef 3061]
type = A
movetype = A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 3

[state -2, debug]
type = DisplayToClipboard
trigger1 = 1
text = "%d"
params = id
ignorehitpause = 1

[State 0, pal]
type = varset
trigger1 = parent,Ishelper(10000)
trigger1 = (parent,stateno = [3600,3999])
var(30) = 1

[State 0, pal]
type = palfx
trigger1 = time = (random%5)
time = 14
sinadd = 80,80,80,28

[State 0, var]
type = varrandom
trigger1 = !time
v = 10
range = 0,29

[State 0, var]
type = varset
trigger1 = !time
var(11) = (var(10)%5)

[State 0, anim]
type = changeanim
trigger1 = !time
value = 3090+floor(var(10)/10)

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, vel]
type = velset
trigger1 = !time
x = 34
y = -2+var(11)*2.625

[State 0, vel]
type = velset
triggerall = !root,var(59)
trigger1 = !time
trigger1 = !parent,Ishelper
trigger1 = parent,stateno != 3901
trigger1 = parent,command = "holdfwd"
x = 34
y = -2+var(11)*1.3

;AI
[State 0, vel]
type = velset
triggerall = root,var(59)
triggerall = !time
triggerall = !parent,Ishelper
triggerall = parent,stateno != 3901
trigger1 = root,var(36) = 1005 || root,var(36) = 1020
trigger2 = root,var(36) = -11 && root,p2statetype != C
x = 34
y = -2+var(11)*1.3

[State 0, vel]
type = velset
triggerall = !root,var(59)
trigger1 = !time
trigger1 = !parent,Ishelper
trigger1 = parent,stateno != 3901
trigger1 = parent,command = "holdback"
x = 34
y = -12+var(11)*6

;AI
[State 0, vel]
type = velset
triggerall = root,var(59)
triggerall = !time
triggerall = !parent,Ishelper
triggerall = parent,stateno != 3901
trigger1 = root,var(36) = -11 && root,p2bodydist y < -80
x = 34
y = -12+var(11)*6

[State 0, explod]
type = explod
trigger1 = !time
anim = (3062+(floor(var(10)/10)*10))-(vel y <=-4)-(vel y <=-8)+(vel y >=4)+(vel y >=8)
id = 3060
postype = p1
pos = 0,0
sprpriority = 4
ownpal = 1
bindtime = -1

[State 0, hit]
type = hitdef
trigger1 = !var(30)
attr = A, HP
damage = ceil(ifelse((7*root,fvar(0))<7,7,(7*root,fvar(0)))),ceil(ifelse((7*.25*root,fvar(0)*.25)<7,7,(7*.25*root,fvar(0)*.25)))
priority = 5,Hit
hitflag = MAF
guardflag = MA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,2
guard.pausetime = 0,0
sparkno = s6004
sparkxy = 5,0
guard.sparkno = s6010
hitsound = -1;s0,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 19
ground.hittime = 19
ground.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
airguard.velocity = -4,-3
air.type = High
air.hittime = 5
air.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 1
air.fall = 1
fall.recover = 1
fall.recovertime = 8
guard.kill = 0
yaccel = .36
persistent = 0
p2facing = 1
id = 3060

[State 0, hit]
type = hitdef
trigger1 = var(30)
attr = A, HP
damage = ceil(ifelse((7*.25*root,fvar(0))<7,7,(7*.25*root,fvar(0)))),ceil(ifelse((7*.25*root,fvar(0)*.25)<7,7,(7*.25*root,fvar(0)*.25)))
priority = 5,Hit
hitflag = MAF
guardflag = MA
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,2
guard.pausetime = 0,0
sparkno = s6004
sparkxy = 5,0
guard.sparkno = s6010
hitsound = -1;s0,5
guardsound = -1;s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 19
ground.hittime = 19
ground.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
airguard.velocity = -4,-3
air.type = High
air.hittime = 5
air.velocity = -6,-1;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
fall = 1
air.fall = 1
fall.recover = 1
fall.recovertime = 8
guard.kill = 0
yaccel = .36
persistent = 0
p2facing = 1
id = 3060

[State 0, vel]
type = parentvaradd
trigger1 = !parent,ishelper
trigger1 = movehit = 1
var(40) = 1

[State 0, vel]
type = parentvaradd
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, vel]
type = parentvarset
trigger1 = numtarget
fvar(32) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

[State 0, end]
type = statetypeset
trigger1 = movecontact = 1
movetype = I

[state 4100, 1]
type = envcolor
trigger1 = movehit = 1
trigger1 = helper(7520),var(46)
value = 255,255,255
time = 1

[State 0, vel]
type = parentvarset
trigger1 = movehit = 1
var(45) = 1
ignorehitpause = 1
[State 0, vel]
type = parentvarset
trigger1 = moveguarded = 1
var(45) = 2
ignorehitpause = 1

[State 0, end]
type = removeexplod
trigger1 = pos x <= -280 || pos x >= 280
trigger2 = pos y >= 40
trigger3 = movecontact = 1
id = 3060

[State 0, end]
type = changeanim
trigger1 = movecontact = 1
value = 20000

[State 10000, HitBy]
type = HitBy
trigger1 = 1
value = SCA, NP, SP, HP

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 10000, HitOverRide] 
type = HitOverRide
trigger1 = 1
slot = 0
stateno = 3064
attr = SCA, NP, SP, HP
time = -1

[State 0, end]
type = DestroySelf
triggerall = (!numtarget)
trigger1 = pos x <= -280 || pos x >= 280
trigger2 = pos y >= 40

[State 0, end]
type = DestroySelf
triggerall = (numtarget)
triggerall = Ishelper(3061)
triggerall = numhelper(3060)
truggerall = helper(3060),numtarget
trigger1 = movecontact >= 2
trigger2 = pos x <= -280 || pos x >= 280
trigger3 = pos y >= 40

;---------------------------------------------------------------------------
;エメラルド相殺
[Statedef 3064]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0,0
anim = 6200

[State 0, end]
type = removeexplod
trigger1 = 1
id = 3060

[State 0, end]
type = DestroySelf
trigger1 = !animtime

;---------------------------------------------------------------------------
;半径20M(弾)オラムダ
[Statedef 3065]
type = A
movetype = I
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2

[State 0, var]
type = varrandom
trigger1 = !time
v = 10
range = 0,29

[State 0, var]
type = varset
trigger1 = !time
var(11) = (var(10)%5)

[State 0, anim]
type = changeanim
trigger1 = !time
value = 3060+(floor(var(10)/10)*10)+var(11)

[State 0, explod]
type = explod
trigger1 = !time
anim = 6050
id = 6050
postype = p1
pos = 0,0
scale = .5,.5
sprpriority = 3
ownpal = 1

[State 0, vel]
type = velset
trigger1 = !time
x = 34
y = -2+var(11)*2

[State 0, end]
type = DestroySelf
trigger1 = pos x <= -240 || pos x >= 240
trigger2 = pos y >= 40
;==============================================================================
;インディーズアーム(Main.Ver)
[Statedef 3100]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195+(random%4)
velset = 0,0
sprpriority = 0
facep2 = 1

[State -2, CornerPush]
type = posadd
trigger1 = prevstateno = 220
trigger2 = prevstateno = 410
trigger3 = prevstateno = 420
x = (fvar(3)+(fvar(3)*.25)+1)
persistent = 0

[State 0, var]
type = varset
trigger1 = !time
var(6) = (var(6)|256)

[State 0, nhb]
type = nothitby
trigger1 = time = [10,12]
value = SCA
time = 1

[State 0, end]
type = changestate
trigger1 = time = 12
value = 196

;------------------------------------------------------------------------------
;インディーズアーム(Stand)
[Statedef 3150]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3150
velset = 0,0
sprpriority = -2

[State 0, turn]
type = turn
trigger1 = time <= 1
trigger1 = facing != root,facing

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 0, var]
type = varset
triggerall = !root,var(59)
trigger1 = !time
var(2) = ifelse(root,command="214aa1",0,ifelse(root,command="214aa2",1,ifelse(root,command="214aa3",2,3)))

[State 0, var]
type = varset
triggerall = !root,var(59)
trigger1 = !time
triggerall = root,var(28)
var(2) = ifelse((root,var(28)&2**12),0,ifelse((root,var(28)&2**13),1,ifelse((root,var(28)&2**14),2,3)))

;スタンドが出る通常技のヒットストップ中に入力した場合別パターンへ
[State 0, var]
type = varadd
triggerall = root,var(28)
triggerall = !time
trigger1 = prevstateno = 320
trigger2 = prevstateno = 510
trigger3 = prevstateno = 520
var(2) = 4

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = S
statetype = S
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = C
statetype = C
ignorehitpause = 1

[State 0, state]
type = statetypeset
trigger1 = parent,statetype = A
statetype = A
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, nhb]
type = nothitby
trigger1 = 1
value = ,AT

[State 0, var]
type = hitoverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 9500
slot = 1

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, nhb]
type = nothitby
trigger1 = animelemtime(9) >= 0
trigger1 = animelemtime(10) <= 20
value = SCA
time = 1

[State 0, spr]
type = sprpriority
trigger1 = 1
value = -2

[state 1, explod]
type = explod
trigger1 = !(gametime%5)
anim = 6200
id = 6200
postype = p1
pos = 0,-60
random = 60,110
sprpriority = 5
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, super]
type = superpause
trigger1 = animelem = 9
time = 30
movetime = 30
anim = -1
sound = s0,21
darken = 0
p2defmul = 1
poweradd = -1000

[State 0, explod]
type = explod
trigger1 = animelem = 9
anim = 7100
id = 7100
pos = ceil(33*const(size.xscale)),ceil(-11*const(size.yscale))
postype = p1
scale = .8,.8
sprpriority = 5
pausemovetime = 999999
supermovetime = 999999

[state 0, helper]
type = helper
trigger1 = animelem = 9
helpertype = normal
name = "super"
stateno = 7000
id = 7000
pos = 0,0
postype = p1
pausemovetime = 999999
supermovetime = 999999

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 0
helpertype = normal
name = "arm1"
stateno = 3160
id = 3160
postype = p1
pos = ceil(40*const(size.xscale)),ceil(-8*const(size.yscale))

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 1
helpertype = normal
name = "arm2"
stateno = 3161
id = 3160
postype = p1
pos = ceil(37*const(size.xscale)),ceil(-14*const(size.yscale))

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 2
helpertype = normal
name = "arm3"
stateno = 3162
id = 3160
postype = p1
pos = ceil(40*const(size.xscale)),ceil(-8*const(size.yscale))

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 3
helpertype = normal
name = "arm4"
stateno = 3163
id = 3160
postype = p1
pos = ceil(38*const(size.xscale)),ceil(-12*const(size.yscale))


[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 4
helpertype = normal
name = "arm5"
stateno = 3164
id = 3160
postype = p1
pos = ceil(38*const(size.xscale)),ceil(-12*const(size.yscale))

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = var(2) = 5
helpertype = normal
name = "arm5"
stateno = 3165
id = 3160
postype = p1
pos = ceil(38*const(size.xscale)),ceil(-12*const(size.yscale))

[state 0, helper]
type = helper
trigger1 = animelemtime(9) = 0
trigger1 = (var(2) = [6,7])
helpertype = normal
name = "arm6"
stateno = 3166
id = 3160
postype = p1
pos = ceil(38*const(size.xscale)),ceil(-12*const(size.yscale))


[State 10000, 1]
type = helper
trigger1 = !time
trigger1 = !numhelper(13105)
helpertype = normal
id = 13105
pos = 0,0
postype = p1
stateno = 13105
keyctrl = 0
ownpal = 0
bindtime = -1

[State 0, snd]
type = playsnd
trigger1 = animelemtime(9) = 2
value = 3,0
channel = 0

[State 0, var]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, var]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = hitadd
trigger1 = var(46)
value = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
trigger1 = animelemtime(10) = 160
value = 9001

;------------------------------------------------------------------------------
;インディーズアーム1-1(Stand/Arm1-1)
[Statedef 3160]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, var]
type = velset
trigger1 = !time
x = 2.4

;紐
[State 0, explod]
type = explod
trigger1 = time < 46
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 48
value = 13151

[State 0, var]
type = velset
trigger1 = time = 48
x = 2
y = -6

;紐
[State 0, explod]
type = explod
trigger1 = time = [48,118]
anim = 13181
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -2,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3170

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム1-2(Stand/Arm1-2)
[Statedef 3170]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -6
y = 18

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 24
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 24
x = -7.2
y = 0

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム2-1(Stand/Arm2-1)
[Statedef 3161]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13151

[State 0, vel]
type = velset
trigger1 = !time
x = 1
y = -3

;紐
[State 0, explod]
type = explod
trigger1 = time < 19
anim = 13181
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 21
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 21
x = 3
y = 0

;紐
[State 0, explod]
type = explod
trigger1 = time = [22,45]
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 48
value = 13158

[State 0, vel]
type = velset
trigger1 = time = 48
x = 4
y = 2

;紐
[State 0, explod]
type = explod
trigger1 = time = [49,59]
anim = 13188
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 62
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 62
x = 4
y = 0

;紐
[State 0, explod]
type = explod
trigger1 = time = [63,118]
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = -.2,-6;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -.2,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3171

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム2-2(Stand/Arm2-2)
[Statedef 3171]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, vel]
type = velset
trigger1 = !time
x = -12

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 19
value = 13158

[State 0, vel]
type = velset
trigger1 = time = 19
x = -12
y = -6

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 24
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 24
x = -9
y = 0

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 33
value = 13151

[State 0, vel]
type = velset
trigger1 = time = 33
x = -3
y = 9

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム3-1(Stand/Arm3-1)
[Statedef 3162]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, vel]
type = velset
trigger1 = !time
x = 4.2

;紐
[State 0, explod]
type = explod
trigger1 = time < 59
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 60
value = 13151

[State 0, vel]
type = velset
trigger1 = time = 60
x = 1
y = -3

;紐
[State 0, explod]
type = explod
trigger1 = time = [62,75]
anim = 13181
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 78
value = 13165

[State 0, vel]
type = velset
trigger1 = time = 78
x = -4.8
y = 0

;紐
[State 0, explod]
type = explod
trigger1 = time = [79,117]
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = -.2,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -.2,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3172

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム3-2(Stand/Arm3-2)
[Statedef 3172]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = 14.4
y = 0

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 14
value = 13152

[State 0, vel]
type = velset
trigger1 = time = 14
x = -3
y = 9

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 20
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 20
x = -12.6
y = 0

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム4-1(Stand/Arm4-1)
[Statedef 3163]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13154

[State 0, vel]
type = velset
trigger1 = !time
x = 4
y = -2.75;-4

;紐
[State 0, explod]
type = explod
trigger1 = time < 22;23
anim = 13184
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 24
value = 13165

[State 0, vel]
type = velset
trigger1 = time = 24
x = -4
y = 0

;紐
[State 0, explod]
type = explod
trigger1 = time = [25,45]
;trigger1 = time = [24,46]
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 48
value = 13158

[State 0, vel]
type = velset
trigger1 = time = 48
x = 4
y = 2.75

;紐
[State 0, explod]
type = explod
trigger1 = time = [48,70]
anim = 13188
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 72
value = 13167

[State 0, vel]
type = velset
trigger1 = time = 72
x = -2;-2
y = -4

;紐
[State 0, explod]
type = explod
trigger1 = time = [73,93]
;trigger1 = time = [73,95]
anim = 13190
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 96
value = 13163

[State 0, vel]
type = velset
trigger1 = time = 96
x = -2
y = 4;6

;紐
[State 0, explod]
type = explod
trigger1 = time = [97,117]
;trigger1 = time = [96,117]
anim = 13182
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%8)
trigger1 = var(20) < 9
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = -.2,-6;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = ifelse(var(20)>=8,-5,0),ifelse(var(20)>=8,-5,-2)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, end]
type = varadd
trigger1 = movehit = 1
var(20) = 1

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3173

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム4-2(Stand/Arm4-2)
[Statedef 3173]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = 6
y = -12

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 8
value = 13167

[State 0, vel]
type = velset
trigger1 = time = 8
x = 6
y = 12

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 16
value = 13158

[State 0, vel]
type = velset
trigger1 = time = 16
x = -12
y = -8.25

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 24
value = 13165

[State 0, vel]
type = velset
trigger1 = time = 24
x = 12
y = 0

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 32
value = 13154

[State 0, vel]
type = velset
trigger1 = time = 32
x = -12
y = 8.25

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム5-1(Stand/Arm5-1)
[Statedef 3164]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, var]
type = velset
trigger1 = !time
x = 4;2.4

;紐
[State 0, explod]
type = explod
trigger1 = time < 28
anim = 13186
id = 13180
removetime = 158-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 30
value = 13170

[State 0, var]
type = velset
trigger1 = time = 30
x = -4
y = -2.75;-4

;紐
[State 0, explod]
type = explod
trigger1 = time = [31,50]
anim = 13184
id = 13180
removetime = 158-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
facing = -1
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 52
value = 13154

[State 0, var]
type = velset
trigger1 = time = 52
x = 4
y = -2.75;-4

;紐
[State 0, explod]
type = explod
trigger1 = time = [52,70]
anim = 13184
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
facing = 1
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 72
value = 13158

[State 0, var]
type = velset
trigger1 = time = 72
x = 4
y = 2.75;-4

;紐
[State 0, explod]
type = explod
trigger1 = time = [72,118]
anim = 13188
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
facing = 1
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -.5,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3174

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム5-2(Stand/Arm5-2)
[Statedef 3174]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -12
y = -8.25

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 16
value = 13154

[State 0, vel]
type = velset
trigger1 = time = 16
x = -12
y = 8

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 23
value = 13170

[State 0, vel]
type = velset
trigger1 = time = 23
x = 12
y = 8

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 31
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 31
x = -12
y = 0

[State 0, vel]
type = posadd
trigger1 = time = 23
y = -5

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム6-1(Stand/Arm6-1)
[Statedef 3165]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, var]
type = velset
trigger1 = !time
x = 4;2.4

;紐
[State 0, explod]
type = explod
trigger1 = time < 14
anim = 13186
id = 13180
removetime = 158-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 15
value = 13154

[State 0, var]
type = velset
trigger1 = time = 15
y = -2.75;-4

;紐
[State 0, explod]
type = explod
trigger1 = time = [16,119]
anim = 13184
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
facing = 1
sprpriority = 1

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -.5,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3175

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム6-2(Stand/Arm6-2)
[Statedef 3175]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -12
y = 8.25

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 36
value = 13156

[State 0, vel]
type = velset
trigger1 = time = 36
x = -12
y = 0

[State 0, vel]
type = posadd
trigger1 = time = 36
x = 8
y = -9

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150
;------------------------------------------------------------------------------
;インディーズアーム7-1(Stand/Arm7-1)
[Statedef 3166]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
trigger2 = time = 42
trigger3 = time = 83
value = 13152

[State 0, var]
type = velset
trigger1 = !time
trigger2 = time = 42
trigger3 = time = 83
x = 2
y = -4

;紐
[State 0, explod]
type = explod
trigger1 = time < 20
trigger2 = time = [42,62]
trigger3 = time = [83,119]
anim = 13182
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 21
trigger2 = time = 63
value = 13160

[State 0, anim]
type = velset
trigger1 = time = 21
trigger2 = time = 63
y = 4

;紐
[State 0, explod]
type = explod
trigger1 = time = [21,41]
trigger2 = time = [63,82]
anim = 13190
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
facing = 1
sprpriority = 1

[State 0, var]
type = posadd
trigger1 = time = 21
trigger2 = time = 42
trigger3 = time = 63
trigger4 = time = 83
x = 4

;=======================================

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*root,fvar(0))<7,7,(36*root,fvar(0)))),ceil(ifelse((36*root,fvar(0)*.25)<7,7,(36*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -.5,-3;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3176

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3150

;------------------------------------------------------------------------------
;インディーズアーム7-2(Stand/Arm7-2)
[Statedef 3176]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = time = 1
x = -6
y = 12

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 13
trigger2 = time = 26
value = 13160

[State 0, vel]
type = velset
trigger1 = time = 13
trigger2 = time = 26
y = -12

[State 0, var]
type = posadd
trigger1 = time = 13
x = -12

[State 0, var]
type = posadd
trigger1 = time = 19
trigger2 = time = 26
trigger3 = time = 33
x = -4

;---------------------------------------
[State 0, anim]
type = changeanim
trigger1 = time = 19
trigger2 = time = 33
value = 13152

[State 0, vel]
type = velset
trigger1 = time = 19
trigger2 = time = 33
y = 12

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3150
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3150

;------------------------------------------------------------------------------
;デム版インディーズアーム1-1(Stand/Arm1-1)
[Statedef 3167]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13154

[State 0, var]
type = velset
trigger1 = !time
x = 4
y = -2.65

;紐
[State 0, explod]
type = explod
trigger1 = time < 118
anim = 13184
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*.25*root,fvar(0))<7,7,(36*.25*root,fvar(0)))),ceil(ifelse((36*.25*root,fvar(0)*.25)<7,7,(36*.25*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -2,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3177

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3700

;------------------------------------------------------------------------------
;インディーズアーム1-2(Stand/Arm1-2)
[Statedef 3177]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -12
y = 7.95

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3700

;------------------------------------------------------------------------------
;デム版インディーズアーム2-1(Stand/Arm2-1)
[Statedef 3168]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13155

[State 0, var]
type = velset
trigger1 = !time
x = 4
y = -1.45

;紐
[State 0, explod]
type = explod
trigger1 = time < 118
anim = 13185
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*.25*root,fvar(0))<7,7,(36*.25*root,fvar(0)))),ceil(ifelse((36*.25*root,fvar(0)*.25)<7,7,(36*.25*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -2,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3178

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3700

;------------------------------------------------------------------------------
;デム版インディーズアーム2-2(Stand/Arm2-2)
[Statedef 3178]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -12
y = 4.35

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3700

;------------------------------------------------------------------------------
;デム版インディーズアーム3-1(Stand/Arm3-1)
[Statedef 3169]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, snd]
type = playsnd
trigger1 = time = 1
value = 6,6

;=======================================
[State 0, anim]
type = changeanim
trigger1 = !time
value = 13156

[State 0, var]
type = velset
trigger1 = !time
x = 4

;紐
[State 0, explod]
type = explod
trigger1 = time < 118
anim = 13186
id = 13180
removetime = 157-ceil(time/3)*4
scale = const(size.xscale),const(size.yscale)
sprpriority = 1

[State 0, hit]
type = hitdef
trigger1 = time
trigger1 = !(time%6)
attr = A, HA
damage = ceil(ifelse((36*.25*root,fvar(0))<7,7,(36*.25*root,fvar(0)))),ceil(ifelse((36*.25*root,fvar(0)*.25)<7,7,(36*.25*root,fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,0
sparkno = s6004
sparkxy = 0,0
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 0,0
givepower = 10,0
ground.type = High
ground.slidetime = 17
ground.hittime = 17
ground.velocity = 0,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
guard.velocity = -8
ground.type = High
air.hittime = 17
air.velocity = -2,-4;*(1.0-ifelse(root,var(40)>0,root,var(40)*.125,0))*(root,var(40)<=7)
palfx.color = 108
palfx.time = 40
palfx.sinadd = 96,96,96,4
fall = 1
air.fall = 0
guard.kill = 0
yaccel = .36
p2facing = 1

[State 0, vel]
type = parentvarset
trigger1 = parent,ishelper(10000)
trigger1 = movehit = 1
var(46) = 1
ignorehitpause = 1

[State 0, scale]
type = parentvarset
trigger1 = parent,Ishelper(10000)
trigger1 = movecontact = 1
var(21) = 1

;痺れエフェクト2
[State 0, explod]
type = explod
triggerall = !numexplod(6061)
trigger1 = movehit
anim = 6061
id = 6061
postype = p2
pos = 0,-55
bindtime = -1
removetime = 80
scale = 1,1.1
sprpriority = 5
ownpal = 1
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = changestate
trigger1 = time = 120
value = 3179

[State 0, end]
type = DestroySelf
trigger1 = parent,stateno != 3700

;------------------------------------------------------------------------------
;デム版インディーズアーム3-2(Stand/Arm1-2)
[Statedef 3179]
type = A
movetype = A
physics = N
ctrl = 0
sprpriority = 3

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

;=======================================
[State 0, vel]
type = velset
trigger1 = !time
x = -12

;=======================================

[State 0, explod]
type = removeexplod
triggerall = numexplod(6061)
trigger1 = enemynear,statetype = L
id = 6061

[State 0, explod]
type = removeexplod
trigger1 = parent,stateno != 3700
id = 13180

[State 0, end]
type = DestroySelf
trigger1 = time = 40
trigger2 = parent,stateno != 3700

;===========================================================================
;STAND_CRASH
[Statedef 4000]
type = U
movetype = H
physics = N
velset = 0,0

[State 0, pos]
type = posadd
trigger1 = !time
x = -15

[State 0, var]
type = varadd
trigger1 = !time
var(52) = 27
ignorehitpause = 1

[State 0, pause]
type = pause
trigger1 = time = 1;!time
time = 6
movetime = 6

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,22

[State 0, explod]
type = explod
trigger1 = !time
anim = 7600
id = 7600
pos = 160,120
postype = left
bindtime = -1
removetime = 8
scale = .833,1.08
sprpriority = -20
ownpal = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = numexplod(7600)
flag = NoFG
flag2 = NoBG

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),4000,4010)

[State 0, anim]
type = changeanim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 4030

[State 0, anim]
type = changeanim
triggerall = anim = 4030
trigger1 = !animtime
value = anim
elem = 3

[State 0, state]
type = statetypeset
trigger1 = !time
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, end]
type = changestate
triggerall = time > 1
trigger1 = !var(52)
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 4001

[State 0, end]
type = changestate
triggerall = time > 1
trigger1 = !var(52)
value = 4030

;---------------------------------------------------------------------------
;HITG_SLIDE
[Statedef 4001]
type = S
movetype = H
physics = S

[State 0, vel]
type = velset
trigger1 = !var(52)
x = -8
persistent = 0

[State 0, anim]
type = changeanim
triggerall = prevstateno = 4000
trigger1 = !var(52)
value = 5006 + (GetHitVar(groundtype)=2)*10

[State 0, vel]
type = velmul
trigger1 = !var(52)
x = .9

[State 0, vel]
type = velset
trigger1 = !var(53)
x = 0

[State 0, defence]
type = defencemulset
trigger1 = !var(53)
value = 1

[State 0, explod]
type = explod
trigger1 = !var(52)
anim = 8030
id = 8030
pos = 0,0
postype = p1
scale = const(size.xscale),const(size.yscale)
sprpriority = 5
ownpal = 1
persistent = 0

[State 0, end]
type = changestate
trigger1 = !var(53)
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;HITA_UP (initial going up)
[Statedef 4030]
type = A
movetype = H
physics = N
ctrl = 0

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, hitvel]
type = hitvelset
trigger1 = prevstateno = 4000
trigger1 = !time
x = 1
y = 1

[State 0, vel]
type = velmul
trigger1 = prevstateno = 4000
trigger1 = !time
y = 1.1

[State 0, vel]
type = velset
trigger1 = prevstateno = 4100
trigger1 = !time
x = -2.5
y = -2.5

[State 0, end]
type = changestate
triggerall = !HitFall
trigger1 = !var(53)
trigger2 = vel y > 0
trigger2 = pos y >= 10
value = 5040

[State 0, end]
type = changestate
triggerall = HitFall
trigger1 = !var(53)
trigger2 = vel y > 0
trigger2 = pos y >= 10
value = 5050

[State 0, end]
type = changestate
trigger1 = !animtime
value = 4035

;---------------------------------------------------------------------------
;HITA_UP_T (transition)
[Statedef 4035]
type = A
movetype = H
physics = N

[State 0, anim]
type = null;changeanim
trigger1 = !time
trigger1 = SelfAnimExist(5035)
trigger1 = anim != [5051,5059]
trigger1 = anim != 5090
value = 5035

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, end]
type = changestate
triggerall = !HitFall
trigger1 = !var(53)
trigger2 = !animtime
trigger3 = vel y > 0
trigger3 = pos y >= 10
trigger4 = !time
trigger4 = anim != 5035
value = 5040

[State 0, end]
type = changestate
triggerall = HitFall
trigger1 = !var(53)
trigger2 = !animtime
trigger3 = vel y > 0
trigger3 = pos y >= 10
trigger4 = !time
trigger4 = anim != 5035
value = 5050

;---------------------------------------------------------------------------
;HITG_SHAKE
[Statedef 4100]
type = S
movetype = H
physics = N
velset = 0,0

[State 0, pos]
type = posadd
trigger1 = !time
x = -15

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = statetype != A
value = 4100

[State 0, anim]
type = changeanim
trigger1 = !time
trigger1 = statetype = A
value = 4030

[State 0, var]
type = varadd
trigger1 = !time
var(52) = 27
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = !time
var(53) = 50
ignorehitpause = 1

[State 0, pause]
type = pause
trigger1 = time = 1;!time
time = 6
movetime = 6

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,22

[State 0, explod]
type = explod
trigger1 = !time
anim = 7600
id = 7600
pos = 160,120
postype = left
bindtime = -1
removetime = 8
scale = .833,1.08
sprpriority = -30
ownpal = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = numexplod(7600)
flag = NoFG
flag2 = NoBG

[State 0, anim]
type = changeanim
trigger1 = 1
value = anim

[State 0, state] ;State type gets set to aerial if getting hit up
type = statetypeset
trigger1 = !time
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = pos y != 0
statetype = A

[State 0, end]
type = changestate
triggerall = time > 1
trigger1 = !var(52)
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 4001

[State 0, end]
type = changestate
triggerall = time > 1
trigger1 = !var(52)
value = 4030

;===========================================================================
;スタンド消去
[Statedef 9000]
type = U
movetype = I
physics = N
ctrl = 0
velset = 0,0
sprpriority = -2

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = 1
value = anim
elem = animelemno(0)

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, pos]
type = posset
trigger1 = time = 1
y = 0

[State 0, snd]
type = playsnd
trigger1 = time = 20
value = 0,15

[State 0, assert]
type = assertspecial
trigger1 = (time = [8,32]) && !(time%2)
flag = Invisible

[State 0, scale]
type = angledraw
trigger1 = time > 20
scale = (const(size.xscale)-(.08*(time-20))),(const(size.yscale)+(.06*(time-20)))

[State 0, anim]
type = changeanim
trigger1 = !IsHelper
trigger1 = time = 32
value = 20000

[State 0, end]
type = changestate
trigger1 = IsHelper
trigger1 = time >= 32
value = 10000
;===========================================================================
;スタンド消去2
[Statedef 9001]
type = U
movetype = I
physics = N
ctrl = 0
velset = 0,0
sprpriority = -2

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 10000, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 1

[State 10000, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = 1
value = anim
elem = animelemno(0)

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, pos]
type = posset
trigger1 = time = 1
y = 0

[State 0, snd]
type = playsnd
trigger1 = time = 10
value = 0,15

[State 0, assert]
type = assertspecial
trigger1 = (time = [8,20]) && !(time%2)
flag = Invisible

[State 0, scale]
type = angledraw
trigger1 = time > 10
scale = (const(size.xscale)-(.08*(time-10))),(const(size.yscale)+(.06*(time-10)))

[State 0, anim]
type = changeanim
trigger1 = !IsHelper
trigger1 = time = 20
value = 20000

[State 0, end]
type = changestate
trigger1 = root,movetype = H
value = 9505

[State 0, end]
type = changestate
trigger1 = IsHelper
trigger1 = time >= 20
value = 10000

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

;コーナープッシュ処理
[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = !fvar(3)
fvar(5) = 0 

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = numtarget
trigger1 = target,BackEdgeBodyDist <= 5 || target,FrontEdgeBodyDist <= 5
fvar(5) = 1

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = movecontact
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
trigger1 = fvar(3) = [0,.1]
trigger2 = NumTarget
trigger2 = target,statetype = A && target,stateno != [5070,5071]
trigger3 = root,fvar(3)
fvar(3) = 0

[State -2, CornerPush]
type = PosAdd
triggerall = IsHelper
triggerall = fvar(3)
triggerall = fvar(5)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
x = -fvar(3)

[State -2, CornerPush]
type = VarSet
triggerall = IsHelper
triggerall = fvar(3)
triggerall = !numhelper(7000) && !numhelper(8000) && !root,numhelper(7000) && !root,NumHelper(8000)
trigger1 = !numtarget
trigger2 = numtarget
trigger2 = !target,gethitvar(hitshaketime)
fvar(3) = fvar(3)*.75

;---------------------------------------------------------------------------
;被ダメ時スタンド消去(スタンド被ダメ)
[Statedef 9500]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9500
velset = 0,0
sprpriority = -1

[State 12200, VarSet]
type = VarSet
trigger1 = time = 0
var(20) = GetHitVar(damage)

[State -1, Run Fwd]
type = ParentVarAdd
triggerall = root,var(1) = (0,88]
trigger1 = time = 0
var(1) = -2-ceil(var(20)*.25)
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, stopsnd]
type = stopsnd
trigger1 = time = 1
channel = 0

[State 0, end]
type = changestate
trigger1 = HitShakeOver
value = 9520

;---------------------------------------------------------------------------
;被ダメ時スタンド消去(本体被ダメ)
[Statedef 9505]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9500
velset = 0,0
sprpriority = -1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, stopsnd]
type = stopsnd
trigger1 = time = 1
channel = 0

[State 0, end]
type = changestate
trigger1 = root,HitShakeOver
value = 9520

;---------------------------------------------------------------------------
;スタンドクラッシュ時スタンド消去
[Statedef 9510]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9500
velset = 0,0
sprpriority = -1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, stopsnd]
type = stopsnd
trigger1 = time = 1
channel = 0

[State 0, end]
type = changestate
trigger1 = !root,var(52)
value = 9520

;---------------------------------------------------------------------------
;被ダメ時スタンド消去2
[Statedef 9520]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9501
velset = 0,0
sprpriority = -1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,15

[State 0, hitvel]
type = hitvelset
trigger1 = prevstateno = 9500
trigger1 = !time
x = 1
y = 1

[State 0, hitvel]
type = velset
trigger1 = prevstateno = 9505
trigger1 = !time
x = -2
y = -4

[State 0, pos]
type = posadd
trigger1 = !time
x = -5
y = -80

[State 0, pos]
type = posfreeze
trigger1 = time >= 4

[State 0, scale]
type = angledraw
trigger1 = time < 12
scale = (const(size.xscale)+(.08*time)),(const(size.yscale)-(.06*time))

[State 0, anim]
type = changeanim
trigger1 = time = 12
value = 20000

[State 0, end]
type = changestate
trigger1 = HitOver && time >= 12
value = 10000
;---------------------------------------------------------------------------
;結界消去被ダメ
[Statedef 9530]
type = U
movetype = H
physics = N
ctrl = 0
anim = 11150
velset = 0,0
sprpriority = -1

[State 0, scale]
type = parentvaradd
trigger1 = !time
var(54) = ifelse(var(2)=3,-3,-1)

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, vel]
type = veladd
trigger1 = 1
y = GetHitVar(yaccel)

[State 0, pos]
type = null;posadd
trigger1 = !time
x = -5
y = -80

[State 0, pos]
type = posfreeze
trigger1 = time >= 4

[State 0, scale]
type = angledraw
trigger1 = time < 12
scale = (const(size.xscale)+(.08*time)),(const(size.yscale)-(.06*time))

[State 0, anim]
type = changeanim
trigger1 = time = 12
value = 20000

[State 0, end]
type = destroyself
trigger1 = time >= 12

;===========================================================================
;ガークラ時スタンド消去
[Statedef 9600]
type = U
movetype = H
physics = N
ctrl = 0
anim = 9600
velset = -.6,0
sprpriority = 1

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, var]
type = parentvarset
trigger1 = !time
var(9) = 1

[State 0, pos]
type = posadd
trigger1 = !time
x = 15
y = -60

[State 0, stopsnd]
type = stopsnd
trigger1 = time = 1
channel = 0

[State 0, annim]
type = changeanim
trigger1 = root,stateno = 4100
value = 9600
elem = 1

[State 0, assert]
type = assertspecial
trigger1 = animelemtime(2) >= 0
trigger1 = !(time%2)
flag = invisible
ignorehitpause = 1

[State 0, end]
type = changestate
trigger1 = !animtime
value = 10000

;===========================================================================
;スタンド待機1
[Statedef 10000]
type = U
movetype = I
physics = N
anim = 20000
ctrl = 0
velset = 0,0
sprpriority = -1

[State 0, var];AI
type = parentvarset
trigger1 = !time
var(39) = 0
ignorehitpause = 1

[State 0, btr]
type = statetypeset
trigger1 = root,movetype = H
movetype = H
[State 0, btr]
type = statetypeset
trigger1 = root,movetype != H
movetype = I

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, var]
type = parentvarset
trigger1 = parent,var(9) = 2
trigger1 = !time
var(19) = 2

[State 0, var]
type = parentvarset
trigger1 = parent,var(9) = 2
trigger1 = !time
var(23) = 120

[State 0, var]
type = parentvarset
trigger1 = parent,var(9) != 0
var(9) = 0

[State 0, var]
type = parentvarset
trigger1 = !time
fvar(10) = 0

[State 0, var]
type = varset
trigger1 = !time
fvar(13) = 0

[State 0, var]
type = varset
trigger1 = !time
var(3) = 0

[State 0, var]
type = varset
trigger1 = !time
var(4) = 0

[State 0, var]
type = varset
trigger1 = !time
var(5) = 0

[State 0, var]
type = varset
trigger1 = !time
var(13) = 0

[State 0, var]
type = varset
trigger1 = !time
var(50) = 0

[State 0, var]
type = varset
trigger1 = !time
var(44) = 0

[State 0, var]
type = varset
trigger1 = !time
var(45) = 0

[State 0, var]
type = varset
trigger1 = !time
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, var]
type = varset
trigger1 = !time
fvar(10) = 0

;スパコン版エメラルドスプラッシュ用ヒット音
[State 0, snd]
type = playsnd
trigger1 = var(45)
value = 0,5+(var(45)=2)*4-(var(45)=3)*4
ignorehitpause = 1
channel = 2

[State 0, end]
type = parentvaradd
trigger1 = var(46)
var(40) = var(46)

[State 0, end]
type = varset
trigger1 = !time
trigger2 = var(45)
var(45) = 0

[State 0, end]
type = varset
trigger1 = var(46)
var(46) = 0

[State -2, CornerPush]
type = ParentVarSet
trigger1 = IsHelper
trigger1 = var(21)
trigger1 = time > 1
fvar(3) = 0
ignorehitpause = 1

[State 0, end]
type = varset
trigger1 = var(21)
var(21) = 0

[State 0, end]
type = changestate
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
value = ifelse(root,stateno=4000,9510,9600)

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 3000
trigger2 = root,stateno = 3100
value = root,stateno + 50

;即キャン(スタンドを使わない攻撃からのキャンセル)AI用

[State 0, end];即キャン（法王の結界）
type = changestate
triggerall = root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H

triggerall = P2StateType != L
triggerall = P2stateno != 5120
triggerall = P2stateno != 5201
;triggerall = enemynear(root,var(48)),prevstateno != [5120,5210]
;崩し
trigger1 = root,stateno = 210 && (root,time > 20 || root,var(59) >= 7)
trigger1 = root,var(36) = -1010
trigger1 = root,p2bodydist x < 30 || root,var(59) >= 7
trigger1 = root,var(41)= 1+4*(root,var(59)<7)
;空中hit 200
trigger2 = !numhelper(1155) || !numhelper(1156)
trigger2 = root,stateno = 200 && root,movehit
trigger2 = root,p2statetype = A
value = 1150

[State 0, end];即キャン（法王の結界Air）
type = changestate
triggerall = root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H

;triggerall = P2StateType != A
triggerall = P2StateType != L
triggerall = P2stateno != 5120
triggerall = P2stateno != 5201
;triggerall = enemynear(root,var(48)),prevstateno != [5120,5210]

trigger1 = root,stateno = 600
trigger1 = root,var(36) = 1000 || root,var(36) = 1100
trigger1 = (root,p2bodydist x <= 80)
trigger1 = root,movecontact >= 8
trigger2 = root,stateno = 610
trigger2 = root,var(36) = -140
trigger2 = root,animelemtime(5) >= 0
value = 1151

[State 0, end];即キャン（タイラップ）
type = changestate
triggerall = root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H

triggerall = P2StateType != A
triggerall = P2StateType != L
triggerall = P2stateno != 5120
triggerall = P2stateno != 5201
;triggerall = enemynear(root,var(48)),prevstateno != [5120,5210]

trigger1 = root,stateno = 215
trigger1 = root,var(36) = 1012
trigger1 = root,movecontact = 4
trigger2 = root,stateno = 210
trigger2 = root,var(36) = 1011 || root,var(36) = 1017 || root,var(36) = 10 && root,power<1000
trigger2 = root,movecontact = 4
trigger3 = root,stateno = 210 || root,stateno = 215
trigger3 = root,var(36) = 1101
trigger3 = root,movecontact = 4
trigger4 = power < 1000
trigger4 = root,stateno = 210
trigger4 = root,var(36) = -10001
trigger4 = root,movecontact = 4
value = 1250

[State 0, end];即キャン（エメラルドスプラッシュ）
type = changestate
triggerall = root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H

triggerall = P2stateno != 5120
triggerall = P2stateno != 5201
;triggerall = enemynear(root,var(48)),prevstateno != [5120,5210]
;崩し
trigger1 = root,stateno = 210
trigger1 = root,var(36) = -1000
trigger1 = root,movecontact = 4
trigger2 = root,stateno = 210 || root,stateno = 215
trigger2 = root,animelemtime(4) >= 1
trigger2 = root,var(12) = 1
trigger2 = !root,movecontact
value = 1050

;即キャン(スタンドを使わない攻撃からのキャンセル)

[State 0, end];即キャン（半径20M・エメラルドスプラッシュ）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H && power >= 1000
triggerall = root,command = "236aa" || root,command = "236b" || (root,var(28)&2**11)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 3050

[State 0, end];即キャン（インディーズアーム）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H && power >= 1000
triggerall = root,command = "214aa1" || root,command = "214aa2" || root,command = "214aa3" || root,command = "214aa4" || root,command = "214b" || (root,var(28)&2**12) || (root,var(28)&2**13) || (root,var(28)&2**14) || (root,var(28)&2**15)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 3150

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 3500 && root,time = 3
value = 3550

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1000
trigger2 = root,stateno = 1100
trigger3 = root,stateno = 1200
trigger4 = root,stateno = 1300
value = root,stateno + 50

[State 0, end];即キャン（タイラップスネーク）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall = root,command = "463214x" || root,command = "463214y" || root,command = "463214z" || root,command = "463214b" || (root,var(28)&2**3) || (root,var(28)&2**4) || (root,var(28)&2**5)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 1250

[State 0, end];即キャン（エメラルドスプラッシュ）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall = root,command = "236x" || root,command = "236y" || root,command = "236z" || root,command = "236b" || (root,var(28)&2**0) || (root,var(28)&2**1) || (root,var(28)&2**2)
triggerall = !(root,var(28)&2**11&&power>=1000)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 1050

[State 0, end];即キャン（法王の結界）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall=(root,command="214x"||root,var(28)&2**6)&&!numhelper(1155)&&!numhelper(1158)||(root,command="214y"||root,var(28)&2**7)&&!numhelper(1156)||(root,command="214z"||root,var(28)&2**8)&&!numhelper(1157)
triggerall = !(root,var(28)&2**12&&power>=1000)
triggerall = !(root,var(28)&2**13&&power>=1000)
triggerall = !(root,var(28)&2**14&&power>=1000)
triggerall = !(root,var(28)&2**15&&power>=1000)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 1150

[State 0, end];即キャン（法王の結界）bで出す場合(字数制限により分割)
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall=(root,command="214b"||root,var(28)&2**19)&&!numhelper(1155)&&!numhelper(1158)
triggerall = !(root,var(28)&2**12&&power>=1000)
triggerall = !(root,var(28)&2**13&&power>=1000)
triggerall = !(root,var(28)&2**14&&power>=1000)
triggerall = !(root,var(28)&2**15&&power>=1000)
trigger1 = root,stateno = 200
trigger2 = root,stateno = 210
trigger3 = root,stateno = 215
trigger4 = root,stateno = 220 && root,anim = 221
trigger5 = root,stateno = 400
trigger6 = root,stateno = 412 && !var(8)
trigger7 = root,stateno = 415
trigger8 = root,stateno = 422
value = 1150

[State 0, end];即キャン（法王の結界Air）
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall=(root,command="214x"||root,var(28)&2**6)&&!numhelper(1155)&&!numhelper(1158)||(root,command="214y"||root,var(28)&2**7)&&!numhelper(1156)||(root,command="214z"||root,var(28)&2**8)&&!numhelper(1157)
triggerall = !(root,var(28)&2**12&&power>=1000)
triggerall = !(root,var(28)&2**13&&power>=1000)
triggerall = !(root,var(28)&2**14&&power>=1000)
triggerall = !(root,var(28)&2**15&&power>=1000)
trigger1 = root,stateno = 600
trigger2 = root,stateno = 610
value = 1151

[State 0, end];即キャン（法王の結界Air）bで出す場合(字数制限により分割)
type = changestate
triggerall = !root,var(59)
triggerall = roundstate = 2
triggerall = root,movetype != H
triggerall=(root,command="214b"||root,var(28)&2**19)&&!numhelper(1155)&&!numhelper(1158)
triggerall = !(root,var(28)&2**12&&power>=1000)
triggerall = !(root,var(28)&2**13&&power>=1000)
triggerall = !(root,var(28)&2**14&&power>=1000)
triggerall = !(root,var(28)&2**15&&power>=1000)
trigger1 = root,stateno = 600
trigger2 = root,stateno = 610
value = 1151

[State 0, 4]
type = ChangeState
triggerall = !root,var(0)
triggerall = root,time = 1
trigger1 = root,stateno = 120 && root,statetype != A
trigger2 = root,stateno = [130,132]
trigger3 = root,stateno = 150
trigger4 = root,stateno = 152
trigger5 = root,stateno = 154; || root,stateno = 155
value = 125

[State 0, end]
type = changestate
triggerall = root,movetype != H
triggerall = root,time = 1
trigger1 = root,stateno = 1101
value = 1151

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 700 && root,time = 1
value = 750

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = !root,var(0)
trigger1 = root,stateno = 801 && root,time = 5
value = 850

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 220 && root,anim = 220 && root,time = 1
value = 320

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 410 && root,time = 1
value = 510

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 420 && root,time = 1
value = 520

[State 0, end]
type = changestate
triggerall = root,movetype != H
trigger1 = root,stateno = 620 && root,time = 1
value = 725

;発光ヘルパー
[state -2, helper]
type = helper
trigger1 = roundstate = 2
trigger1 = !numhelper(40001)
helpertype = normal
name = "kirakira2"
stateno = 40001
id = 40001
postype = p1
pos = 0,0
ownpal = 1
keyctrl = 0
pausemovetime = 999999
supermovetime = 999999

;---------------------------------------------------------------------------
;本体時ガード（スタンド）
[Statedef 125]
type = U
physics = U
sprpriority = 2

[State 1000, 0]
type = BindToParent
trigger1 = 1
pos = 0,0

[State 10000, Assert]
type = AssertSpecial
trigger1 = 1
flag = noshadow
ignorehitpause = 1

[State 100, 2]
type = turn
trigger1 = facing != root,facing

[State 120, 1]
type = ChangeAnim
triggerall = anim != 125
trigger1 = root,anim = 120
trigger2 = root,anim = 130
trigger3 = root,anim = 132
value = 125

[State 120, 1]
type = ChangeAnim
triggerall = anim != 126
trigger1 = root,anim = 121
trigger2 = root,anim = 131
value = 126

[State 120, 1]
type = ChangeAnim
trigger1 = root,anim = 150
value = 155
persistent = 0

[State 120, 1]
type = ChangeAnim
trigger1 = root,anim = 151
value = 156
persistent = 0

[State 120, 1]
type = ChangeAnim
trigger1 = root,anim = 152
value = 157
persistent = 0

[State 2600, ChangeState]
type = changeanim
trigger1 = root,stateno = [150,155];154
trigger1 = root,command = "holdback"
trigger1 = animelem = 4
value = anim
elem = 2
persistent = 1

[State 2600, ChangeState]
type = changeanim
triggerall = IsHelper
trigger1 = (parent,var(6)&128)
value = anim
elem = AnimElemNo(0)-!AnimElemTime(AnimElemNo(0))
persistent = 1

[State 2600, posfreeze]
type = posfreeze
triggerall = IsHelper
trigger1 = (parent,var(6)&128)

[State 120, 5]
type = ChangeState
triggerall = time > 1
triggerall = root,time = 1
trigger1 = root,stateno = 150
trigger2 = root,stateno = 152
trigger3 = root,stateno = 154
value = 125

[State 120, 5]
type = ChangeState
trigger1 = root,stateno != 120
trigger1 = root,stateno != [130,132]
trigger1 = root,stateno != 140
trigger1 = root,stateno != [150,155]
trigger2 = anim = 145 || anim = 146 || anim = 155 || anim = 156 || anim = 157
trigger2 = animtime = 0
value = 10000

;===========================================================================
;スタンド発現(Ground)
[Statedef 10900]
type = S
movetype = I
physics = S
anim = 10900
ctrl = 1-(var(59)>0)
sprpriority = -1

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,14

[State 0, snd]
type = playsnd
trigger1 = !time
value = 3,3
channel = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 8010
id = 8000
pos = -15,0
postype = p1
scale = 1,1
sprpriority = 3
ownpal = 1
shadow = 0,0,0
pausemovetime = 0
supermovetime = 0

[State 0, pos]
type = posadd
trigger1 = !time
x = 15

[State 0, var]
type = varset
trigger1 = !time
var(0) = 10000

[State 0, var]
type = varset
trigger1 = !time
var(19) = 40

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = (command = "x" || command = "b") && command != "holddown" && command = "holdfwd"
trigger1 = statetype != A
trigger1 = !time
value = 10202

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = (command = "x" || command = "b") && command != "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10200

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "y" && command != "holddown" && command = "holdfwd"
trigger1 = statetype != A
trigger1 = !time
value = 10211

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "y" && command != "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10210

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "z" && command != "holddown" && command = "holdback"
trigger1 = statetype != A
trigger1 = !time
value = 10221

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "z" && command != "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10220

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = (command = "x" || command = "b") && command = "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10400

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "y" && command = "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10410

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "z" && command = "holddown"
trigger1 = statetype != A
trigger1 = !time
value = 10420

;AI
[State 0, pos]
type = ctrlset
trigger1 = var(59)
trigger1 = !var(36)
value = 1

[State 0, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;スタンド発現(Air)
[Statedef 10910]
type = A
movetype = I
physics = N
anim = 10910
ctrl = 0
sprpriority = -1

[State 0, snd]
type = playsnd
trigger1 = !time
value = 0,14

[State 0, snd]
type = playsnd
trigger1 = !time
value = 3,3
channel = 0

[State 0, pos]
type = posadd
trigger1 = !time
x = 15

[State 0, var]
type = varset
trigger1 = !time
var(0) = 10000

[State 0, var]
type = varset
trigger1 = !time
var(19) = 40

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "x" || command = "y" || command = "z" || command = "b"
trigger1 = command = "holddown" && command = "holdfwd"
trigger1 = statetype = A
trigger1 = !time
value = 10630

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "x"
trigger1 = statetype = A
trigger1 = !time
value = 10600+(fvar(14)=1||fvar(14)=-1)*5

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "y"
trigger1 = statetype = A
trigger1 = !time
value = 10610

[State 0, end]
type = changestate
triggerall = !var(59)
trigger1 = command = "z"
trigger1 = statetype = A
trigger1 = !time
value = 10620+(fvar(14)=1||fvar(14)=-1)*5

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse((var(6)&8),.45,ifelse((var(6)&16),.5,.55))

[State 1100, ChangeState]
type = ChangeState
triggerall = !var(8)
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;---------------------------------------------------------------------------
;スタンド出現攻撃
[Statedef 10950]
type = S
movetype = A
physics = N
ctrl = 0
anim = 10950
poweradd = 40
velset = 0,0
sprpriority = -1
facep2 = 1

[State 0, pos]
type = posset
trigger1 = !time
y = 0

[State 0, pos]
type = posadd
trigger1 = !time
x = 15

[State 0, var]
type = varset
trigger1 = !time
var(0) = 10000

[State 0, var]
type = varset
trigger1 = !time
var(19) = 40

[State 0, snd]
type = playsnd
trigger1 = !time
value = 6,8

[State 0, snd]
type = playsnd
trigger1 = !time
value = 3,7
channel = 0

[State 0, snd]
type = playsnd
triggerall = !var(8)
trigger1 = animelem = 4
value = 6,2

[State 0, hit]
type = hitdef
triggerall = !var(8)
trigger1 = animelem = 4
attr = S, SA
damage = ceil(ifelse((49*fvar(0))<7,7,(49*fvar(0)))),ceil(ifelse((49*fvar(0)*.25)<7,7,(49*fvar(0)*.25)))
priority = 4,Hit
hitflag = MAF
guardflag = M
animtype = Heavy
air.animtype = Back
fall.animtype = Back
pausetime = 0,11
sparkno = s6004
sparkxy = -12,-88
guard.sparkno = s6010
hitsound = s0,5
guardsound = s0,9
getpower = 40,0
givepower = 20,0
ground.type = Low
ground.slidetime = 14
ground.hittime = 14
ground.velocity = -8.5
guard.velocity = -8
air.type = Low
air.velocity = -2,-6*(1.0-ifelse(var(40)>0,var(40)*.125,0))*(var(40)<=7)
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
air.hittime = 18
fall = 0
air.fall = 1
fall.recovertime = 48
guard.kill = 0
yaccel = .36
p2facing = 1

[State 220, CornerPush]
type = VarSet
trigger1 = !time
fvar(3) = 0
ignorehitpause = 1

[State 220, CornerPush]
type = VarSet
trigger1 = movecontact = 1
fvar(3) = 16
ignorehitpause = 1

[State 0, pos]
type = posfreeze
trigger1 = var(8) > 0

[State 0, end]
type = changestate
trigger1 = animelemtime(7) = 1
value = 196

;===========================================================================
;スタンド解除（Ground）
[Statedef 900]
type = S
movetype = I
physics = S
anim = 20900
ctrl = 1-(var(59)>0)
sprpriority = 0

[State 0, pos]
type = nothitby
trigger1 = time <= 4
value = SCA

[State 0, pos]
type = posadd
trigger1 = !time
x = -15

[State 0, var]
type = varset
trigger1 = !time
var(0) = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 10901
id = 10000
pos = 15,0
postype = p1
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = -1
ownpal = 1
shadow = 0,0,0
pausemovetime = 0
supermovetime = 0

;AI
[State 0, pos]
type = ctrlset
trigger1 = var(59)
trigger1 = !var(36)
value = 1

;---------------------------------------------------------------------------
;スタンド解除（Air）
[Statedef 910]
type = A
movetype = I
physics = N
ctrl = 0
anim = 44
sprpriority = 0

[State 0, pos]
type = posadd
trigger1 = !time
x = -15

[State 0, var]
type = varset
trigger1 = !time
var(0) = 0

[State 0, explod]
type = explod
trigger1 = !time
anim = 10901
id = 10000
pos = 15,0
postype = p1
scale = const(size.xscale),const(size.yscale)
bindtime = -1
sprpriority = -1
ownpal = 1
shadow = 0,0,0
pausemovetime = 0
supermovetime = 0

[State 3001, Width]
type = Width
trigger1 = 1
edge = 5,0

[State 4030, Gravity]
type = VelAdd
trigger1 = !var(8)
y = ifelse((var(6)&8),.4,.45)

[State -3, Variable Height]
type = PlayerPush
triggerall = statetype=A && movetype!=H && numenemy
triggerall = p2bodydist x = [-(enemynear,const(size.ground.back) + enemynear,const(size.ground.front)), 0]
trigger1 = p2statetype=S
trigger1 = p2dist y >= (enemynear,const(size.height) - 12); Value depends on each char
trigger2 = p2statetype=C
trigger2 = p2dist y >= (enemynear,const(size.height) - 28); Value depends on each char
trigger3 = p2statetype=L
trigger3 = p2dist y >= 12
value=0
ignorehitpause=1

[State 4030, ChangeState]
type = ChangeState
triggerall = !var(8)
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;===========================================================================
;本体待機状態
[Statedef 20000]
type = U
movetype = I
physics = N
anim = 20000
ctrl = 0
sprpriority = 0

[State 0, btr]
type = bindtoroot
trigger1 = 1
pos = -15,0

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, end]
type = changestate
triggerall = anim = 20000
triggerall = root,movetype != H
triggerall = root,anim != [5000,5999]
trigger1 = root,stateno = [10900,10950]
trigger2 = root,var(0)
value = 20001

;---------------------------------------------------------------------------
;スタンドモード時本体
[Statedef 20001]
type = U
movetype = I
physics = N
ctrl = 0
velset = 0,0

[State 0, anim]
type = changeanim
trigger1 = root,stateno = 10900
trigger2 = root,stateno = 10950
value = 20900
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = root,stateno = 10910
value = 20910
persistent = 0

[State 0, anim]
type = null;changeanim
trigger1 = anim = 20900
trigger1 = !animtime
value = 20001

[State 0, anim]
type = changeanim
trigger1 = root,var(8)
trigger2 = (root,var(6)&128)
value = anim
elem = animelemno(0)

[State 0, var]
type = parentvarset
trigger1 = 1
var(6) = (root,var(6)|128)

[State 0, anim]
type = changeanim
triggerall = animelemtime(2) = 2
trigger1 = anim = 5000 || anim = 5001 || anim = 5002
trigger2 = anim = 5010 || anim = 5011 || anim = 5012
trigger3 = anim = 5020 || anim = 5021 || anim = 5022
trigger4 = anim = 5030 || (anim = 5070 && root,stateno=5070)
value = anim
elem = ifelse(anim=5030,3,2)

[State 0, anim]
type = changeanim
triggerall = root,time
triggerall = anim != root,anim-10000
triggerall = SelfAnimExist(root,anim-10000)
trigger1 = root,anim = 10005
trigger2 = root,stateno = 0
trigger2 = anim != 12 && anim != 47 && anim != 20900
trigger2 = anim != [195,199]
trigger3 = root,stateno = 10
trigger4 = root,stateno = [12,159]
trigger5 = root,stateno = [5000,5999]
trigger6 = root,stateno = [800,820]
trigger7 = root,stateno = [3606,3610]
value = root,anim-10000

[State 0, anim]
type = changeanim
trigger1 = root,time = 1
trigger1 = root,stateno = 195
value = 195+(random%5)

[State 0, assert]
type = assertspecial
trigger1 = root,stateno = 3610
trigger1 = root,time = [80,310]
flag = Noshadow
ignorehitpause = 1

[State 0, anim]
type = changeanim
triggerall = anim != 0
trigger1 = root,statetype = S
trigger1 = anim = 12 && !animtime
trigger2 = root,stateno = 0 && root,prevstateno != 52 && root,anim = 10001
trigger3 = anim = 47 && !animtime
trigger4 = (root,statetype = S && root,stateno = 196 && (anim != [195,199])) || (root,stateno = [10200,10320])
trigger4 = (root,prevstateno != [100,105]) || ((anim=101||anim=106)&&!animtime)
value = 0

[State 0, anim]
type = changeanim
triggerall = anim != 11
trigger1 = root,statetype = C
trigger1 = anim = 10 && !animtime
trigger2 = root,stateno = 11 && anim != 10
trigger3 = anim != [195,199]
trigger3 = (root,statetype = C && root,stateno = 196 && (anim != [195,199])) || (root,stateno = [10400,10520])
trigger3 = (root,prevstateno != [100,105]) || ((anim=101||anim=106)&&!animtime)
value = 11

[State 0, anim]
type = changeanim
triggerall = anim != 47
trigger1 = root,stateno = 52
trigger1 = root,anim = 10050
value = 47

[State 0, anim]
type = changeanim
triggerall = anim = 100 || anim = 105
trigger1 = root,stateno = 196 || ((root,stateno = [10200,10420]) && !root,vel x)
value = anim+1

[State 0, anim]
type = changeanim
triggerall = anim != 20910
trigger1 = root,stateno = [10600,10635]
trigger2 = root,stateno = 11010
trigger3 = root,stateno = 11110
trigger4 = root,stateno = 3610
trigger5 = root,stateno = 4900
value = 20910

[State 0, anim]
type = changeanim
triggerall = anim != 20900
trigger1 = root,stateno = 10700
value = 20900

[State 0, anim]
type = changeanim
triggerall = anim != [195,199]
trigger1 = root,stateno = 11000
trigger2 = root,stateno = 11100
trigger3 = root,stateno = 11200
trigger4 = root,stateno = [3600,3605]
trigger5 = root,stateno = 3700
trigger6 = root,stateno = 3800
trigger7 = root,stateno = 3900
value = 195+random%5

[State 0, btr]
type = bindtoroot
trigger1 = root,movetype != H
trigger1 = root,stateno != [3800,3809]
trigger2 = root,movetype = H
trigger2 = root,hitshakeover
pos = -15,0

[State 0, nhb]
type = nothitby
trigger1 = 1
value = SCA

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1

[State 0, turn]
type = turn
trigger1 = facing != root,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = ifelse((root,stateno=[120,159])||(root,movetype=A),-1,2)

[State 0, pos]
type = posadd
trigger1 = !root,hitshakeover
x = 1*ifelse(time%2=0,-1,1)

;destroy
[State 0, end]
type = changestate
trigger1 = root,stateno = 900 
trigger2 = root,stateno = 910
trigger3 = root,stateno = 1300
trigger4 = root,stateno = 3500
trigger5 = root,anim < 10000
trigger6 = !root,var(0) && ((root,var(46)=gametime+1)||(anim!=root,anim-10000))
value = 20000

;Win
[State 0, anim]
type = changeanim
triggerall = anim != 196
trigger1 = root,stateno = 180
value = 196

;Lose
[State 0, end]
type = changestate
trigger1 = !root,alive
trigger1 = root,anim = [5000,5099]
value = 9500

;Time Up
[State 0, end]
type = changeanim
trigger1 = root,stateno = [170,175]
value = 170
persistent = 0

;//////////////////////////////////////////////////////////////////////////////
; Helper
;//////////////////////////////////////////////////////////////////////////////
;==============================================================================
;勝利時画面移動停止
[Statedef 6000]
ctrl = 0
anim = 20000

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = -160,0

[State 0, end]
type = DestroySelf
trigger1 = roundstate != [3,4]
trigger1 = root,movetype = H
;===========================================================================
;オラムダ時画面移動停止
[Statedef 6001]
ctrl = 0
anim = 20000

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = -160,0

[State 0, end]
type = DestroySelf
trigger1 = root,stateno != 4900

;===========================================================================
;4強ふっとばし時画面固定
[Statedef 6002]
ctrl = 0
anim = 20000

[State 0, screen]
type = screenbound
trigger1 = 1
value = 1
movecamera = -160,0

[State 0, end]
type = DestroySelf
trigger1 = !root,fvar(13) && !parent,Ishelper(10000)
trigger2 = !parent,fvar(13) && parent,Ishelper(10000)

;==============================================================================
;文字(ﾄﾞｷﾞｬ―z＿＿ﾝ)
[Statedef 6080]
ctrl = 0
anim = 20000

[State 0, explod]
type = explod
trigger1 = !time
anim = 6080
id = 6080
pos = 40,90
postype = back
scale = .84,1
ownpal = 1
sprpriority = -10

[State 0, explod]
type = explod
trigger1 = !time
anim = 6081
id = 6081
pos = 80,94
postype = back
scale = .84,1
ownpal = 1
sprpriority = -10

[State 0, explod]
type = explod
trigger1 = !time
anim = 6082
id = 6082
pos = 125,98
postype = back
scale = .84,1
ownpal = 1
sprpriority = -11

[State 0, explod]
type = explod
trigger1 = !time
anim = 6083
id = 6083
pos = 205,90
postype = back
scale = .84,1
ownpal = 1
sprpriority = -10

[State 0, explod]
type = explod
trigger1 = !time
anim = 6084
id = 6084
pos = 290,90
postype = back
scale = .84,1
ownpal = 1
sprpriority = -10

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(6080)
id = 6080
pos = 40,90
postype = back
scale = ifelse(time<20,(time*.042),.84),ifelse(time<20,(time*.05),1)

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(6081)
id = 6081
pos = 80,94
postype = back
scale = ifelse(time<20,(time*.042),.84),ifelse(time<20,(time*.05),1)

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(6082)
id = 6082
pos = 125,98
postype = back
scale = ifelse(time<20,(time*.042),.84),ifelse(time<20,(time*.05),1)

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(6083)
id = 6083
pos = 205,90
postype = back
scale = ifelse(time<20,(time*.042),.84),ifelse(time<20,(time*.05),1)

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(6084)
id = 6084
pos = 290,90
postype = back
scale = ifelse(time<20,(time*.042),.84),ifelse(time<20,(time*.05),1)

[State 0, end]
type = DestroySelf
trigger1 = time = 80

;===========================================================================
;スパコン背景
[Statedef 7000]
ctrl = 0
anim = 20000

[State 8000, AssertSpecial-1]
type = AssertSpecial
trigger1 = time <= 29
flag = NoFG
flag2 = NoBG

[State 0, explod]
type = explod
trigger1 = !time
anim = 7300
id = 7300
pos = 0,0
postype = back
removetime = 30
scale = .84,1.08
sprpriority = -20
pausemovetime = 30
supermovetime = 30

;cut in
[State 0, explod]
type = explod
trigger1 = time = 7
anim = 7000
id = 7000
pos = -20,170
postype = back
removetime = 23
sprpriority = -10
pausemovetime = 23
supermovetime = 23

[State 8000, ModifyExplod-3]
type = ModifyExplod
trigger1 = Numexplod(7000)
Id = 7000
postype = back
pos = ceil(-20+((random%16)*ifelse((time%6=[1,3]),-1,1))),ceil(170+((random%16)*ifelse((time%6=[1,3]),-1,1)))
scale = ifelse(time>=22,2,.2+((time-6)*.125))*.833,ifelse(time>=22,2,.2+((time-6)*.125))*1.07

[State 0, end]
type = DestroySelf
trigger1 = time = 31

;===========================================================================
;オラムダ背景（cut）
[Statedef 4950]
ctrl = 0
anim = 20000

;back
[State 0, assert]
type = assertspecial
trigger1 = time <= 32
flag = NoBG
flag2 = NoFG

;cut in
[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7001
id = 7001
pos = -200,100
postype = back
removetime = -1
scale = .84,1.08
sprpriority = -10
pausemovetime = 120
supermovetime = 120

;cut in
[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7002
id = 7001
pos = -200,100
postype = back
removetime = -1
scale = .84,1.08
sprpriority = -10
pausemovetime = 120
supermovetime = 120

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(7001)
trigger1 = time <= 20
id = 7001
pos = ceil(-200+(time*10)),110
postype = back

[State 0, explod]
type = removeexplod
trigger1 = root,stateno != 4900
id = 7001

[State 0, end]
type = DestroySelf
trigger1 = root,stateno != 4900

;==============================================================================
;メッセージアイコン
[Statedef 7500]
ctrl = 0
anim = 20000

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 10900
trigger2 = root,stateno = 10910
trigger3 = root,stateno = 10950
var(0) = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = root,var(0)
trigger1 = root,var(1) <= 20
trigger1 = root,var(9) != 2 && !root,var(23)
var(0) = 2
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
var(0) = 3
ignorehitpause = 1

;ファーストストライク判定
[State 0, var]
type = varset
trigger1 = root,movetype = H && (root,stateno != [120,159])
trigger2 = numpartner
trigger2 = partner,movetype = H && (partner,stateno != [120,159])
var(8) = 2
ignorehitpause = 1
[State 0, var]
type = varset
trigger1 = var(8) = 0
trigger1 = root,p2movetype = H && (root,p2stateno != [120,159])
trigger1 = root,var(40)
var(8) = 1
ignorehitpause = 1

[State 0, var];FIRST ATTACK!
type = varset
trigger1 = var(8) = 1
var(0) = 4
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 700
trigger2 = root,stateno = 10700
var(0) = 5
ignorehitpause = 1

[State 0, end]
type = changestate
trigger1 = roundstate = 2
trigger1 = time > 1
trigger1 = var(0)
value = 7500+var(0)

;------------------------------------------------------------------------------
;STAND ON
[Statedef 7501]
ctrl = 0
anim = 20000

[State 0, explod]
type = removeexplod
trigger1 = !time
trigger1 = numexplod(7500)
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7500
id = 7500
pos = -160,78
postype = left
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(-160+(time*10)),78
postype = left
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = 32,78
postype = left
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7505
id = 7500
pos = 160,78
postype = right
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(160-(time*10)),78
postype = right
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = -32,78
postype = right
id = 7500

[State 0, var]
type = varset
trigger1 = !root,var(0)
var(0) = 0
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = root,var(1) <= 20
trigger1 = root,var(9) != 2 && !root,var(23)
var(0) = 2
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
var(0) = 3
ignorehitpause = 1

;ファーストストライク判定
[State 0, var]
type = varset
trigger1 = root,movetype = H && (root,stateno != [120,159])
trigger2 = numpartner
trigger2 = partner,movetype = H && (partner,stateno != [120,159])
var(8) = 2
ignorehitpause = 1
[State 0, var]
type = varset
trigger1 = var(8) = 0
trigger1 = root,p2movetype = H && (root,p2stateno != [120,159])
trigger1 = root,var(40)
var(8) = 1
ignorehitpause = 1

[State 0, var];FIRST ATTACK!
type = varset
trigger1 = var(8) = 1
var(0) = 4
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 700
trigger2 = root,stateno = 10700
var(0) = 5
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 1
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

;------------------------------------------------------------------------------
;DANGER!
[Statedef 7502]
ctrl = 0
anim = 20000

[State 0, explod]
type = removeexplod
trigger1 = !time
trigger1 = numexplod(7500)
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7501
id = 7500
pos = -160,78
postype = left
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(-160+(time*10)),78
postype = left
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = 32,78
postype = left
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7506
id = 7500
pos = 160,78
postype = right
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(160-(time*10)),78
postype = right
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = -32,78
postype = right
id = 7500

[State 0, var]
type = varset
trigger1 = root,var(1) > 20
var(0) = 0
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 10900
trigger2 = root,stateno = 10910
var(0) = 1
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
var(0) = 3
ignorehitpause = 1

;ファーストストライク判定
[State 0, var]
type = varset
trigger1 = root,movetype = H && (root,stateno != [120,159])
trigger2 = numpartner
trigger2 = partner,movetype = H && (partner,stateno != [120,159])
var(8) = 2
ignorehitpause = 1
[State 0, var]
type = varset
trigger1 = var(8) = 0
trigger1 = root,p2movetype = H && (root,p2stateno != [120,159])
trigger1 = root,var(40)
var(8) = 1
ignorehitpause = 1

[State 0, var];FIRST ATTACK!
type = varset
trigger1 = var(8) = 1
var(0) = 4
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 700
trigger2 = root,stateno = 10700
var(0) = 5
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 2
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

;------------------------------------------------------------------------------
;STAND CRUSH
[Statedef 7503]
ctrl = 0
anim = 20000

[State 0, explod]
type = removeexplod
trigger1 = !time
trigger1 = numexplod(7500)
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7502
id = 7500
pos = -160,78
postype = left
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(-160+(time*10)),78
postype = left
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = 32,78
postype = left
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7507
id = 7500
pos = 160,78
postype = right
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(160-(time*10)),78
postype = right
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = -32,78
postype = right
id = 7500

[State 0, var]
type = varset
trigger1 = root,stateno != 4000
trigger1 = root,stateno != 4100
var(0) = 0
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 10900
trigger2 = root,stateno = 10910
var(0) = 1
ignorehitpause = 1

;ファーストストライク判定
[State 0, var]
type = varset
trigger1 = root,movetype = H && (root,stateno != [120,159])
trigger2 = numpartner
trigger2 = partner,movetype = H && (partner,stateno != [120,159])
var(8) = 2
ignorehitpause = 1
[State 0, var]
type = varset
trigger1 = var(8) = 0
trigger1 = root,p2movetype = H && (root,p2stateno != [120,159])
trigger1 = root,var(40)
var(8) = 1
ignorehitpause = 1

[State 0, var];FIRST ATTACK!
type = varset
trigger1 = var(8) = 1
var(0) = 4
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 700
trigger2 = root,stateno = 10700
var(0) = 5
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 3
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

;---------------------------------------------------------------------------
;FIRST ATTACK
[Statedef 7504]
ctrl = 0
anim = 20000

[State 0, var]
type = varset
trigger1 = !time
var(8) = 2
ignorehitpause = 1

[State 0, explod]
type = removeexplod
trigger1 = !time
trigger1 = numexplod(7500)
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7503
id = 7500
pos = -160,78
postype = left
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(-160+(time*10)),78
postype = left
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = 32,78
postype = left
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7508
id = 7500
pos = 160,78
postype = right
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(160-(time*10)),78
postype = right
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = -32,78
postype = right
id = 7500

[State 0, var]
type = varset
trigger1 = !time
var(0) = 0
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 10001
trigger2 = root,stateno = 10910
trigger3 = root,stateno = 10950
var(0) = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = root,var(1) <= 20
trigger1 = root,var(9) != 2 && !root,var(23)
var(0) = 2
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
var(0) = 3
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 700
trigger2 = root,stateno = 10700
var(0) = 5
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 4
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 4
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

;------------------------------------------------------------------------------
;GUARD CANCEL
[Statedef 7505]
ctrl = 0
anim = 20000

[State 0, explod]
type = removeexplod
trigger1 = !time
trigger1 = numexplod(7500)
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 1
trigger1 = !time
anim = 7504
id = 7500
pos = -160,78
postype = left
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(-160+(time*10)),78
postype = left
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 1
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = 32,78
postype = left
id = 7500

[State 0, explod]
type = explod
trigger1 = teamside = 2
trigger1 = !time
anim = 7509
id = 7500
pos = 160,78
postype = right
bindtime = -1
scale = .5,.5
sprpriority = 10
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time <= 20
pos = ceil(160-(time*10)),78
postype = right
id = 7500

[State 0, explod]
type = modifyexplod
trigger1 = teamside = 2
trigger1 = numexplod(7500)
trigger1 = time = 22
pos = -32,78
postype = right
id = 7500

[State 0, var]
type = varset
trigger1 = root,stateno != 700
trigger1 = root,stateno != 10700
var(0) = 0
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 10900
trigger2 = root,stateno = 10910
var(0) = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = root,var(1) <= 20
trigger1 = root,var(9) != 2 && !root,var(23)
var(0) = 2
ignorehitpause = 1

[State 0, var]
type = varset
triggerall = root,time = 1
trigger1 = root,stateno = 4000
trigger2 = root,stateno = 4100
var(0) = 3
ignorehitpause = 1

;ファーストストライク判定
[State 0, var]
type = varset
trigger1 = root,movetype = H && (root,stateno != [120,159])
trigger2 = numpartner
trigger2 = partner,movetype = H && (partner,stateno != [120,159])
var(8) = 2
ignorehitpause = 1
[State 0, var]
type = varset
trigger1 = var(8) = 0
trigger1 = root,p2movetype = H && (root,p2stateno != [120,159])
trigger1 = root,var(40)
var(8) = 1
ignorehitpause = 1

[State 0, var];FIRST ATTACK!
type = varset
trigger1 = var(8) = 1
var(0) = 4
ignorehitpause = 1

[State 0, end]
type = changestate
triggerall = roundstate = 2
triggerall = time > 1
trigger1 = var(0) && var(0) != 5
trigger2 = !var(0)
trigger2 = time > 60
value = 7500+var(0)

;---------------------------------------------------------------------------
;スタンドゲージ
[Statedef 20032]
ctrl = 0
anim = 20000
ownpal = 1

;config呼び出し
[State 6000, Helper]
type = Helper
trigger1 = time = 1
id = 7525
name = "config"
pos = -300,0
postype = Left
stateno = 7525
helpertype = normal
keyctrl = 0
ownpal = 1
ignorehitpause = 1
pausemovetime = 999999
supermovetime = 999999

[State 6000, Explod];ゲージ
type = Explod
trigger1 = !NumExplod(16001)
trigger1 = time >= 2
trigger1 = teamside = 1
anim = 16001
id = 16001
postype = L
pos = 140+var(4),48+var(5)
ownpal = 0
bindtime = -1
ignorehitpause = 1
sprpriority = -102
pausemovetime = -1
supermovetime = -1
facing = 1

[State 6000, Explod];ゲージ
type = Explod
trigger1 = !NumExplod(16001)
trigger1 = time >= 2
trigger1 = teamside = 2
anim = 16051
id = 16001
postype = R
pos = -140+var(4),48+var(5)
ownpal = 0
bindtime = -1
ignorehitpause = 1
sprpriority = -102
pausemovetime = -1
supermovetime = -1
facing = 1

[State 6000, Explod];枠
type = Explod
trigger1 = !NumExplod(16000)
trigger1 = time >= 2
anim = ifelse(teamside=1,16000,16050)
id = 16000
postype = Back
pos = 140+var(4),48+var(5)
ownpal = 1
bindtime = -1
ignorehitpause = 1
sprpriority = -101
pausemovetime = -1
supermovetime = -1
scale = .5,.5

[State 6000, Explod];STAND
type = Explod
trigger1 = root,var(0)
trigger1 = !NumExplod(6003)
trigger1 = time >= 2
anim = 7510
id = 6003
postype = Back
pos = ifelse(teamside=1,102,137)+var(4),51+var(5)
ownpal = 1
bindtime = -1
ignorehitpause = 1
sprpriority = -100
facing = ifelse(teamside=1,1,-1)
pausemovetime = -1
supermovetime = -1
scale = .5,.5

[State 6000, ModifyExplod]
type = ModifyExplod
trigger1 = NumExplod(16001)
Id = 16001
scale = ifelse(root,var(1)>=88,88.5,root,var(1)),1
ignorehitpause = 1

[State 20026, 0]
type = RemoveExplod
trigger1 = win
trigger2 = lose
id = 16000

[State 20026, 0]
type = RemoveExplod
trigger1 = win
trigger2 = lose
id = 16001

[state 0, var]
type = varadd
trigger1 = var(1)
var(1) = -1

[state 0, var]
type = varset
trigger1 = fvar(0) - root,var(1) > 0
var(1) = 8

[state 0, var]
type = varset
trigger1 = 1
fvar(0) = root,var(1)

[State 0, pal]
type = palfx
trigger1 = root,var(9) != 2 || (root,var(9) = 2 && !(time%4))
trigger1 = var(1) = 8 || var(1) = 4
trigger2 = root,var(1) <= 20
trigger2 = !var(1) && time%4=0
time = 2
add = 128,-256,-256

[State -3];スタンドの文字を消す
type = removeexplod
trigger1 = parent,var(0) = 0
trigger2 = win
trigger3 = lose
id = 6003

;×
[State 0, explod]
type = explod
trigger1 = root,var(20)
trigger1 = !numexplod(7522)
trigger1 = time > 0
anim = 7522
id = 7522
pos = ifelse(teamside=1,110,235)+var(4),46+var(5)
postype = left
bindtime = -1
scale = .5,.5
sprpriority = -100
ownpal = 1
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

[State 0, explod]
type = removeexplod
trigger1 = !root,var(20)
trigger1 = numexplod(7522)
trigger2 = win
trigger3 = lose
id = 7522

;●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●●
;アドガ用
[State 8500, 1]
type = varset
trigger1 = parent,stateno != [150,715]
var(16) = 0

[State 8500, 1]
type = varset
trigger1 = parent,stateno = 150
trigger2 = parent,stateno = 152
var(16) = parent,GetHitVar(ctrltime)

[State 8500, 1]
type = varset
trigger1 = parent,stateno != [150,715]
var(15) = 0

[State 8500, 1]
type = varadd
trigger1 = parent,stateno = 153
var(15) = 1

[State 8500, 1]
type = varset
trigger1 = parent,stateno != [150,715]
var(14) = 0

[State 8500, 1]
type = varadd
trigger1 = parent,stateno = 151
var(14) = 1

[State 8500, 1]
type = varset
trigger1 = parent,stateno != [150,715]
var(13) = 0

[State 8500, 1]
type = varset
trigger1 = parent,stateno = 150
trigger2 = parent,stateno = 152
var(13) = parent,GetHitVar(hittime)

;===========================================================================
;タンデム背景+エフェクト
[Statedef 8000]
ctrl = 0
anim = 20000
sprpriority = 5

;efe
[State 0, anim]
type = changeanim
trigger1 = time = 2
value = 8000

[State 0, anim]
type = changeanim
trigger1 = root,stateno != 3500
value = 8001
persistent = 0

[State 0, assert]
type = bindtoroot
trigger1 = 1
pos = 0,0

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow

;back
[State 0, assert]
type = assertspecial
trigger1 = time <= (root,fvar(9))-1
flag = NoBG
flag2 = NoFG

[State 0, explod]
type = explod
trigger1 = !time
anim = 7310
id = 7310
pos = 0,0
postype = back
removetime = (root,fvar(9))
scale = .842,1.08
sprpriority = -20
ownpal = 1
pausemovetime = (root,fvar(9))
supermovetime = (root,fvar(9))
ignorehitpause = 1

;cut in
[State 0, explod]
type = explod
trigger1 = !time
anim = 7000
id = 7000
pos = -200,100
postype = back
removetime = (root,fvar(9))
scale = .84,1.08
;scale = 1,1.08
sprpriority = -10
pausemovetime = (root,fvar(9))
supermovetime = (root,fvar(9))

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(7000)
trigger1 = time <= 10
id = 7000
pos = ceil(-200+(time*20)),110
postype = back

[State 0, end]
type = DestroySelf
trigger1 = anim = 8001 && !animtime

;===========================================================================
;勝利アイコン
[Statedef 9100]
ctrl = 0
anim = 20000

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "config"
stateno = 9105
id = 9105
pausemovetime = 999999
supermovetime = 999999

;「WIN」
[State 0, explod]
type = explod
triggerall = roundstate = 4
trigger1 = teamside = 1
trigger1 = time = 1
trigger1 = var(0)
anim = 9102
id = 9102
pos = -285,80
postype = left
sprpriority = 4

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9102)
trigger1 = time <= 20
id = 9102
pos = ceil(-285+(time*15)),80
postype = left

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9102)
trigger1 = time >= 81
id = 9102
pos = ceil(15-((time-80)*15)),80
postype = left


[State 0, explod]
type = explod
triggerall = roundstate = 4
trigger1 = teamside = 2
trigger1 = time = 1
trigger1 = var(0)
anim = 9102
id = 9103
pos = 100,80
postype = right
sprpriority = 4

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9103)
trigger1 = time <= 20
id = 9103
pos = ceil(100-(time*15)),80
postype = right

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9103)
trigger1 = time >= 81
id = 9103
pos = ceil(-170+((time-80)*15)),80
postype = right

[State 0, snd]
type = playsnd
trigger1 = time = 20
value = 0,28

;「To Be Continued...」
[State 0, explod]
type = explod
triggerall = roundstate = 4
triggerall = matchover
triggerall = teamside = 1
triggerall = time = 20
triggerall = var(1)
trigger1 = !root,fvar(11)
trigger2 = root,fvar(11)
trigger2 = numpartner
trigger2 = !partner,alive
anim = 9100
id = 9100
pos = 412,210
postype = left
scale = .8,.8
sprpriority = 150

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9100)
trigger1 = time <= 40
id = 9100
pos = ceil(412-((time-20)*20)),210
postype = left


[State 0, explod]
type = explod
triggerall = roundstate = 4
triggerall = matchover
triggerall = teamside = 2
triggerall = time = 20
triggerall = var(1)
trigger1 = !root,fvar(11)
trigger2 = root,fvar(11)
trigger2 = numpartner
trigger2 = !partner,alive
anim = 9101
id = 9101
pos = -412,210
postype = right
scale = .8,.8
sprpriority = 150

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9101)
trigger1 = time <= 40
id = 9101
pos = ceil(-412+((time-20)*20)),210
postype = right

;==============================================================================
;敗北演出
[Statedef 9200]
ctrl = 0
anim = 20000

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,19

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, assert]
type = assertspecial
trigger1 = time <= 60
flag = NoBG
flag2 = NoFG

[State 0, pal]
type = palfx
trigger1 = time = [10,34]
add = 5*(time-10),5*(time-10),5*(time-10)
time = 1
ignorehitpause = 1

[State 0, pal]
type = palfx
trigger1 = time > 34
add = 128,128,128
time = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time = 1
fvar(0) = 100
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time > 1
fvar(0) = ifelse(fvar(0)*.6<.3,.3,fvar(0)*.6)
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = 1
fvar(1) = fvar(0)
ignorehitpause = 1

;cut in
[State 0, explod]
type = explod
trigger1 = !time
anim = 9200
id = 9200
pos = 160,120
postype = back
bindtime = -1
removetime = 60
ownpal = 0
scale = 1.176,1.4
sprpriority = -25
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

;back1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8200
id = 8200
pos = 0,0
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8200
id = 8205
pos = 0,0
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back2
[State 0, explod]
type = explod
trigger1 = !time
anim = 8201
id = 8201
pos = 0,96
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8201
id = 8206
pos = 0,96
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back3
[State 0, explod]
type = explod
trigger1 = !time
anim = 8202
id = 8202
pos = 0,160
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8202
id = 8207
pos = 0,160
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back4
[State 0, explod]
type = explod
trigger1 = !time
anim = 8203
id = 8203
pos = 0,224
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8203
id = 8208
pos = 0,224
postype = back
bindtime = -1
removetime = 60
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9200)
id = 9200
pos = ceil(400-fvar(1)),120
postype = back
ignorehitpause = 1


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8200)
id = 8200
pos = -(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8201)
id = 8201
pos = -(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8202)
id = 8202
pos = -(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8203)
id = 8203
postype = back
pos = -(time*20)%512,224
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8205)
id = 8205
pos = 512-(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8206)
id = 8206
pos = 512-(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8207)
id = 8207
pos = 512-(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8208)
id = 8208
pos = 512-(time*20)%512,224
postype = back
ignorehitpause = 1


[State 0, explod]
type = removeexplod
trigger1 = time = 60
trigger2 = roundstate = 4
id = 9200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8201

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8202

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8203

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8205

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8206

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8207

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8208

[State 0, end]
type = DestroySelf
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)

;------------------------------------------------------------------------------
;敗北演出2(蜂の巣)
[Statedef 9201]
ctrl = 0
anim = 20000

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,19

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, var]
type = varset
trigger1 = !time
fvar(2) = 0
ignorehitpause = 1

[State 0, assert]
type = assertspecial
trigger1 = time <= 60
flag = NoBG
flag2 = NoFG

[State 0, pal]
type = palfx
trigger1 = time = [10,34]
add = 5*(time-10),5*(time-10),5*(time-10)
time = 1
ignorehitpause = 1

[State 0, pal]
type = palfx
trigger1 = time > 34
add = 128,128,128
time = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time = 1
fvar(0) = 100
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time > 1
fvar(0) = ifelse(fvar(0)*.6<.3,.3,fvar(0)*.6)
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = 1
fvar(1) = fvar(0)
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = time > 6
fvar(2) = fvar(0)
ignorehitpause = 1

;cut in
[State 0, explod]
type = explod
trigger1 = !time
anim = 9200
id = 9200
pos = 160,120
postype = back
bindtime = 0;-1
ownpal = 0
scale = 1.176,1.4
sprpriority = -25
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

;back1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8205
id = 8200
pos = 0,0
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8205
id = 8205
pos = 0,0
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back2
[State 0, explod]
type = explod
trigger1 = !time
anim = 8206
id = 8201
pos = 0,96
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8206
id = 8206
pos = 0,96
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back3
[State 0, explod]
type = explod
trigger1 = !time
anim = 8207
id = 8202
pos = 0,160
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8207
id = 8207
pos = 0,160
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back4
[State 0, explod]
type = explod
trigger1 = !time
anim = 8208
id = 8203
pos = 0,224
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8208
id = 8208
pos = 0,224
postype = back
bindtime = 0;-1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;穴
[State 0, var]
type = varrandom
trigger1 = time = 6
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 6
anim = 9110+var(10)
id = 9110
pos = 16,17
postype = back
bindtime = -1
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 6
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 6
anim = 9110+var(10)
id = 9111
pos = 24,117
postype = back
bindtime = -1
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 6
anim = 9110
id = 9112
pos = 9,212
postype = back
bindtime = -1
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 8
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 8
anim = 9110+var(10)
id = 9113
pos = 40,18
postype = back
bindtime = -1
ownpal = 0
sprpriority = -19
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 8
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 8
anim = 9110+var(10)
id = 9114
pos = 43,115
postype = back
bindtime = -1
ownpal = 0
sprpriority = -19
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 8
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 8
anim = 9110+var(10)
id = 9115
pos = 22,209
postype = back
bindtime = -1
ownpal = 0
sprpriority = -19
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 9
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 9
anim = 9110+var(10)
id = 9116
pos = 92,4
postype = back
bindtime = -1
ownpal = 0
sprpriority = -18
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 9
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 9
anim = 9110+var(10)
id = 9117
pos = 89,127
postype = back
bindtime = -1
ownpal = 0
sprpriority = -18
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 9
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 9
anim = 9110+var(10)
id = 9118
pos = 36,209
postype = back
bindtime = -1
ownpal = 0
sprpriority = -18
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 12
anim = 9111
id = 9119
pos = 119,38
postype = back
bindtime = -1
ownpal = 0
sprpriority = -17
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 12
anim = 9110
id = 9120
pos = 124,100
postype = back
bindtime = -1
ownpal = 0
sprpriority = -17
pausemovetime = 999999
supermovetime = 999999

[State 0, var]
type = varrandom
trigger1 = time = 12
v = 10
range = 0,1
[State 0, explod]
type = explod
trigger1 = time = 12
anim = 9110+var(10)
id = 9121
pos = 88,188
postype = back
bindtime = -1
ownpal = 0
sprpriority = -17
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 16
anim = 9111
id = 9122
pos = 133,112
postype = back
bindtime = -1
ownpal = 0
sprpriority = -16
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 16
anim = 9110
id = 9123
pos = 131,190
postype = back
bindtime = -1
ownpal = 0
sprpriority = -16
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 20
anim = 9112
id = 9124
pos = 191,68
postype = back
bindtime = -1
ownpal = 0
sprpriority = -15
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 20
anim = 9112
id = 9125
pos = 171,220
postype = back
bindtime = -1
ownpal = 0
sprpriority = -15
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 22
anim = 9110
id = 9126
pos = 184,220
postype = back
bindtime = -1
ownpal = 0
sprpriority = -14
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 26
anim = 9110
id = 9127
pos = 202,28
postype = back
bindtime = -1
ownpal = 0
sprpriority = -13
pausemovetime = 999999
supermovetime = 999999


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9200)
id = 9200
pos = ceil(400-fvar(1)),120
postype = back
ignorehitpause = 1


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8200)
id = 8200
pos = -(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8201)
id = 8201
pos = -(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8202)
id = 8202
pos = -(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8203)
id = 8203
postype = back
pos = -(time*20)%512,224
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8205)
id = 8205
pos = 512-(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8206)
id = 8206
pos = 512-(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8207)
id = 8207
pos = 512-(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8208)
id = 8208
pos = 512-(time*20)%512,224
postype = back
ignorehitpause = 1


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9110)
id = 9110
pos = ceil(16-fvar(2)),17
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9111)
id = 9111
pos = ceil(24-fvar(2)),117
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9112)
id = 9112
pos = ceil(9-fvar(2)),212
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9113)
id = 9113
pos = ceil(40-fvar(2)),18
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9114)
id = 9114
pos = ceil(43-fvar(2)),115
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9115)
id = 9115
pos = ceil(22-fvar(2)),209
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9116)
id = 9116
pos = ceil(92-fvar(2)),4
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9117)
id = 9117
pos = ceil(89-fvar(2)),127
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9118)
id = 9118
pos = ceil(36-fvar(2)),209
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9119)
id = 9119
pos = ceil(119-fvar(2)),38
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9120)
id = 9120
pos = ceil(124-fvar(2)),100
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9121)
id = 9121
pos = ceil(81-fvar(2)),188
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9122)
id = 9122
pos = ceil(133-fvar(2)),112
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9123)
id = 9123
pos = ceil(131-fvar(2)),190
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9124)
id = 9124
pos = ceil(191-fvar(2)),68
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9125)
id = 9125
pos = ceil(171-fvar(2)),220
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9126)
id = 9126
pos = ceil(184-fvar(2)),220
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9127)
id = 9127
pos = ceil(202-fvar(2)),28
postype = back
ignorehitpause = 1


[State 0, explod]
type = removeexplod
trigger1 = time = 60
trigger2 = roundstate = 4
id = 9200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8201

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8202

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8203

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8205

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8206

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8207

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8208

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9110

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9111

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9112

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9113

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9114

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9115

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9116

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9117

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9118

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9119

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9120

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9121

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9122

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9123

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9124

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9125

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9126

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9127

[State 0, end]
type = DestroySelf
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)

;------------------------------------------------------------------------------
;敗北演出3(血)
[Statedef 9202]
ctrl = 0
anim = 20000

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,19

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, assert]
type = assertspecial
trigger1 = time <= 60
flag = NoBG
flag2 = NoFG

[State 0, pal]
type = palfx
trigger1 = time = [10,34]
add = 5*(time-10),5*(time-10),5*(time-10)
time = 1
ignorehitpause = 1

[State 0, pal]
type = palfx
trigger1 = time > 34
add = 128,128,128
time = 1
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time = 1
fvar(0) = 100
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time = 1
fvar(2) = 0
ignorehitpause = 1

[State 0, var]
type = varset
trigger1 = time > 1
fvar(0) = ifelse(fvar(0)*.6<.3,.3,fvar(0)*.6)
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = 1
fvar(1) = fvar(0)
ignorehitpause = 1

[State 0, var]
type = varadd
trigger1 = time >= 6
fvar(2) = fvar(0)
ignorehitpause = 1


;cut in
[State 0, explod]
type = explod
trigger1 = !time
anim = 9200
id = 9200
pos = 160,120
postype = back
bindtime = -1
ownpal = 0
scale = 1.176,1.4
sprpriority = -25
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1

;back1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8205
id = 8200
pos = 0,0
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8205
id = 8205
pos = 0,0
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back2
[State 0, explod]
type = explod
trigger1 = !time
anim = 8206
id = 8201
pos = 0,96
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8206
id = 8206
pos = 0,96
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back3
[State 0, explod]
type = explod
trigger1 = !time
anim = 8207
id = 8202
pos = 0,160
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8207
id = 8207
pos = 0,160
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back4
[State 0, explod]
type = explod
trigger1 = !time
anim = 8208
id = 8203
pos = 0,224
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8208
id = 8208
pos = 0,224
postype = back
bindtime = -1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;血
[State 0, explod]
type = explod
trigger1 = time = 3
anim = 9150+random%3
id = 9150
pos = 42,9
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 4
anim = 9150+random%3
id = 9151
pos = 18,122
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 5
anim = 9150+random%3
id = 9152
pos = 24,196
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 6
anim = 9150+random%3
id = 9153
pos = 180,55
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 7
anim = 9150+random%3
id = 9154
pos = 30,103
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 8
anim = 9150+random%3
id = 9155
pos = 68,172
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 9
anim = 9150+random%3
id = 9156
pos = 206,44
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 10
anim = 9150+random%3
id = 9157
pos = 49,106
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 11
anim = 9150+random%3
id = 9158
pos = 156,230
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 12
anim = 9150+random%3
id = 9159
pos = 130,138
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 13
anim = 9150+random%3
id = 9160
pos = 191,227
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999

[State 0, explod]
type = explod
trigger1 = time = 14
anim = 9150+random%3
id = 9161
pos = 128,115
postype = back
bindtime = -1
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
ownpal = 0
sprpriority = -20
pausemovetime = 999999
supermovetime = 999999


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9200)
id = 9200
pos = ceil(400-fvar(1)),120
postype = back
ignorehitpause = 1


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8200)
id = 8200
pos = -(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8201)
id = 8201
pos = -(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8202)
id = 8202
pos = -(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8203)
id = 8203
postype = back
pos = -(time*20)%512,224
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8205)
id = 8205
pos = 512-(time*8)%512,0
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8206)
id = 8206
pos = 512-(time*12)%512,96
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8207)
id = 8207
pos = 512-(time*16)%512,160
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8208)
id = 8208
pos = 512-(time*20)%512,224
postype = back
ignorehitpause = 1


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9150)
id = 9150
pos = ceil(42-fvar(2)),9
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9151)
id = 9151
pos = ceil(18-fvar(2)),122
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9152)
id = 9152
pos = ceil(24-fvar(2)),196
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9153)
id = 9153
pos = ceil(180-fvar(2)),55
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9154)
id = 9154
pos = ceil(30-fvar(2)),103
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9155)
id = 9155
pos = ceil(68-fvar(2)),172
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9156)
id = 9156
pos = ceil(206-fvar(2)),44
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9157)
id = 9157
pos = ceil(49-fvar(2)),106
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9158)
id = 9158
pos = ceil(156-fvar(2)),230
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9159)
id = 9159
pos = ceil(166-fvar(2)),138
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9160)
id = 9160
pos = ceil(191-fvar(2)),227
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(9161)
id = 9161
pos = ceil(128-fvar(2)),115
postype = back
ignorehitpause = 1



[State 0, explod]
type = removeexplod
trigger1 = time = 60
trigger2 = roundstate = 4
id = 9200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8200

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8201

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8202

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8203

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8205

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8206

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8207

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 8208

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9150

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9151

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9152

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9153

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9154

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9155

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9156

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9157

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9158

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9159

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9160

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)
id = 9161

[State 0, end]
type = DestroySelf
trigger1 = roundstate = 4
trigger2 = !numexplod(9200)

;---------------------------------------------------------------------------
;敗北時演出（横切断）
[Statedef 9203]
ctrl = 0
anim = 20000
type = A
movetype = I
physics = N

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,19

[State 9000, 1]
type = turn
trigger1 = time = 0
trigger1 = facing != root,facing

[State 9000, Assert]
type = AssertSpecial
trigger1 = time < 60
flag = NoFG
flag2 = NoBG

[State 9000, EnvColor]
type = palfx
trigger1 = time = (10,35)
add = 5*(time-10),5*(time-10),5*(time-10)
time = 1
persistent = 1
ignorehitpause = 1

[State 9000, EnvColor]
type = palfx
trigger1 = time >= 35
add = 128,128,128
time = 1
persistent = 1
ignorehitpause = 1

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 9000, 1

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 9000, 1

[State 9000, VarSet]
type = VarSet
trigger1 = time = 1
fvar(38) = 170

[State 9000, VarSet]
type = VarSet
trigger1 = 1
fvar(38) = ifelse(fvar(38)*.6<.33,.33,fvar(38)*.6)

[State 9000, VarAdd]
type = VarAdd
trigger1 = 1
fvar(39) = fvar(38)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(39) = -2.7*root,const(size.xscale)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = 1
fvar(37) = fvar(38)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(37) = 2.7*root,const(size.xscale)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(36) = -.32*root,const(size.yscale)
;fvar(36) = -.55*root,const(size.yscale)
ignorehitpause = 1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9201
id = 7911
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9202
id = 7912
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9203
id = 7911
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9204
id = 7912
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8205
id = 8730
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8206
id = 8731
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8207
id = 8732
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8208
id = 8733
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8205
id = 8735
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8206
id = 8736
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8207
id = 8737
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8208
id = 8738
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(7911)
Id = 7911
postype = back
pos = ceil(400-fvar(39)),ceil(120-fvar(36))
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(7912)
Id = 7912
postype = back
pos = ceil(400-fvar(37)),ceil(120+fvar(36))
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8730)
Id = 8730
postype = back
pos = -(time*8)%512,-8
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8731)
Id = 8731
postype = back
pos = -(time*12)%512,88
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8732)
Id = 8732
postype = back
pos = -(time*16)%512,152
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8733)
Id = 8733
postype = back
pos = -(time*20)%512,216
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8735)
Id = 8735
postype = back
pos = 512-(time*8)%512,-8
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8736)
Id = 8736
postype = back
pos = 512-(time*12)%512,88
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8737)
Id = 8737
postype = back
pos = 512-(time*16)%512,152
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8738)
Id = 8738
postype = back
pos = 512-(time*20)%512,216
ignorehitpause = 1

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 60
trigger2 = RoundState = 4
id = 7911

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 60
trigger2 = RoundState = 4
id = 7912

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8730

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8731

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8732

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8733

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8735

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8736

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8737

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8738

[State 9000, DestroySelf]
type = DestroySelf
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)

;---------------------------------------------------------------------------
;敗北時演出（縦切断）
[Statedef 9204]
ctrl = 0
anim = 20000
type = A
movetype = I
physics = N

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 0,19

[State 9000, 1]
type = turn
trigger1 = time = 0
trigger1 = facing != root,facing

[State 9000, Assert]
type = AssertSpecial
trigger1 = time < 60
flag = NoFG
flag2 = NoBG

[State 9000, EnvColor]
type = palfx
trigger1 = time = (10,35)
add = 5*(time-10),5*(time-10),5*(time-10)
time = 1
persistent = 1
ignorehitpause = 1

[State 9000, EnvColor]
type = palfx
trigger1 = time >= 35
add = 128,128,128
time = 1
persistent = 1
ignorehitpause = 1

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 9000, 1

[State 9001, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = 9000, 1

[State 9000, VarSet]
type = VarSet
trigger1 = time = 1
fvar(38) = 170

[State 9000, VarSet]
type = VarSet
trigger1 = 1
fvar(38) = ifelse(fvar(38)*.6<.33,.33,fvar(38)*.6)

[State 9000, VarAdd]
type = VarAdd
trigger1 = 1
fvar(39) = fvar(38)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(39) = .78*root,const(size.xscale)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = 1
fvar(37) = fvar(38)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(37) = -.78*root,const(size.xscale)
ignorehitpause = 1

[State 9000, VarAdd]
type = VarAdd
trigger1 = time >= 6
fvar(36) = 3*root,const(size.yscale)
ignorehitpause = 1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9201
id = 7911
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9203
id = 7912
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9202
id = 7911
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 9204
id = 7912
pos = 160,120
postype = back
sprpriority = -90
ownpal = 0
bindtime = -1
removetime = 60
scale = 1.4*root,const(size.xscale),1.4*root,const(size.yscale)
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8205
id = 8730
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8206
id = 8731
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8207
id = 8732
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8208
id = 8733
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8205
id = 8735
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8206
id = 8736
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8207
id = 8737
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, Explod]
type = Explod
trigger1 = Time = 0
anim = 8208
id = 8738
pos = 0,0
postype = back
sprpriority = -105
ownpal = 0
bindtime = -1
removetime = 60
pausemovetime = -1
supermovetime = -1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(7911)
Id = 7911
postype = back
pos = ceil(400-fvar(39)),ceil(120+fvar(36))
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(7912)
Id = 7912
postype = back
pos = ceil(400-fvar(37)),ceil(120-fvar(36))
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8730)
Id = 8730
postype = back
pos = -(time*8)%512,-8
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8731)
Id = 8731
postype = back
pos = -(time*12)%512,88
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8732)
Id = 8732
postype = back
pos = -(time*16)%512,152
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8733)
Id = 8733
postype = back
pos = -(time*20)%512,216
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8735)
Id = 8735
postype = back
pos = 512-(time*8)%512,-8
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8736)
Id = 8736
postype = back
pos = 512-(time*12)%512,88
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8737)
Id = 8737
postype = back
pos = 512-(time*16)%512,152
ignorehitpause = 1

[State 9000, ModifyExplod]
type = ModifyExplod
trigger1 = Numexplod(8738)
Id = 8738
postype = back
pos = 512-(time*20)%512,216
ignorehitpause = 1

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 60
trigger2 = RoundState = 4
id = 7911

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = time = 60
trigger2 = RoundState = 4
id = 7912

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8730

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8731

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8732

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8733

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8735

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8736

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8737

[State 9000, RemoveExplod]
type = RemoveExplod
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)
id = 8738

[State 9000, DestroySelf]
type = DestroySelf
trigger1 = RoundState = 4
trigger2 = !NumExplod(7911)

;------------------------------------------------------------------------------
;超必殺背景（縦）
[Statedef 9300]
ctrl = 0
anim = 20000

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = NoBG
flag2 = NoFG

;back1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8210
id = 8210
pos = 0,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8210
id = 8215
pos = 0,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back2
[State 0, explod]
type = explod
trigger1 = !time
anim = 8211
id = 8211
pos = 107,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8211
id = 8216
pos = 107,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back3
[State 0, explod]
type = explod
trigger1 = !time
anim = 8212
id = 8212
pos = 214,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8212
id = 8217
pos = 214,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back4
[State 0, explod]
type = explod
trigger1 = !time
anim = 8213
id = 8213
pos = 320,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8213
id = 8218
pos = 320,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8210)
id = 8210
pos = 0,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8211)
id = 8211
pos = 107,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8212)
id = 8212
pos = 214,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8213)
id = 8213
postype = back
pos = 320,-(time*8)%512
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8215)
id = 8215
pos = 0,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8216)
id = 8216
pos = 107,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8217)
id = 8217
pos = 214,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8218)
id = 8218
pos = 320,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8210

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8211

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8212

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8213

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8215

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8216

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8217

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802
id = 8218

[State 0, end]
type = DestroySelf
trigger1 = roundstate = 4
trigger2 = root,stateno != 3802

;===========================================================================
;タンデムコマンド記憶helper
[Statedef 30000]
type = U
movetype = I
physics = N
ctrl = 0
anim = 20000

[State 0, var]
type = varset
trigger1 = root,var(22) = [1,60]
trigger1 = !var(root,var(22)-1)
var(root,var(22)-1) = root,var(21)

[State 0, var]
type = varset
trigger1 = root,var(22) = [61,100]
trigger1 = !var(root,var(22)-61)
fvar(root,var(22)-1) = root,var(21)

[State 0, var]
type = parentvarset
trigger1 = parent,var(5) = [0,59]
var(4) = var(parent,var(5))

[State 0, var]
type = parentvarset
trigger1 = parent,var(5) = [60,99]
var(4) = fvar(parent,var(5)-60)

[State 0, state]
type = parentvarset
trigger1 = !time
var(38) = -1
[State 0, state]
type = parentvarset
trigger1 = parent,stateno = 3551
var(38) = 0
persistent = 0
[State 0, state]
type = parentvaradd
trigger1 = var(38) >= 0
var(38) = 1

[State 0, end]
type = DestroySelf
triggerall = time > 1
trigger1 = parent,stateno = 10000
trigger2 = root,movetype = H
trigger3 = parent,movetype = H

;===========================================================================
;スタンド発光helper(Son.Ver)
[Statedef 40000]
type = U
movetype = I
physics = N
ctrl = 0
anim = 20000

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btp]
type = bindtoparent
trigger1 = 1
pos = 0,0

[State 0, btp]
type = null;bindtoparent
trigger1 = root,movetype != H
trigger2 = root,movetype = H
trigger2 = root,hitshakeover
pos = 0,0

[State 0, pos]
type = null;posadd
trigger1 = !root,hitshakeover
x = 1*ifelse(time%2=0,-1,1)

[State 0, turn]
type = turn
trigger1 = facing != parent,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = ifelse((root,stateno=[800,802]),-1,-1+(root,movetype=A||root,stateno=[11100,11201])*4);3
;---------------------------------------
;緑
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 4
time = 64
sinadd = 40,56,40,128
;青
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 5
time = 64
sinadd = 48,48,64,128
;水色
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 6
time = 64
sinadd = 40,44,48,128
;赤
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 1
time = 64
sinadd = 56,40,40,128
;黒
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 2
time = 64
sinadd = 48,48,48,128
;緑2
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 3
time = 64
sinadd = 120,60,0,128;sinadd = 40,56,40,128

;---------------------------------------

[State 0, anim]
type = changeanim
triggerAll = parent,var(0)
triggerAll = SelfAnimExist(parent,anim+30000)
trigger1 = anim != parent,anim+30000
trigger2 = parent,animelem = 1
trigger3 = anim = parent,anim+30000
trigger3 = animelemno(0) != parent,animelemno(0)
value = parent,anim+30000
elem = parent,animelemno(0)

[State 0, anim]
type = changeanim
trigger1 = !parent,var(0)
trigger2 = parent,anim = 20000
trigger3 = parent,stateno = 3610
value = 20000

[State 0, ang]
type = AngleDraw
trigger1 = root,stateno = 3610
trigger1 = root,time = [90,310]
scale = (const(size.xscale))*.5,(const(size.yscale))*.5

;--------------------------------------------------------------------
;スタンド発光helper(Soff.Ver)
[Statedef 40001]
type = U
movetype = I
physics = N
ctrl = 0
anim = 20000

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btp]
type = bindtoparent
trigger1 = 1
pos = 0,0

[State 0, turn]
type = turn
trigger1 = facing != parent,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = ifelse((parent,anim=[300,799])&&(parent,anim!=725),3,ifelse(root,var(9)=2,3,0))

;---------------------------------------
;緑
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 4
time = 64
sinadd = 40,56,40,128
;青
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 5
time = 64
sinadd = 48,48,64,128
;水色
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 6
time = 64
sinadd = 40,44,48,128
;赤
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 1
time = 64
sinadd = 56,40,40,128
;黒
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 2
time = 64
sinadd = 48,48,48,128
;緑2
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 3
time = 64
sinadd = 120,60,0,128;sinadd = 40,56,40,128

;---------------------------------------

[State 0, anim]
type = changeanim
triggerAll = parent,anim != 20000
triggerAll = SelfAnimExist(parent,anim+30000)
trigger1 = anim != parent,anim+30000
trigger2 = parent,animelem = 1
trigger3 = anim = parent,anim+30000
trigger3 = animelemno(0) != parent,animelemno(0)
value = parent,anim+30000
elem = parent,animelemno(0)

[State -2, CornerPush]
type = VarSet
trigger1 = 1
var(8) = root,var(8)
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = var(8) > 0
value = anim
elem = animelemno(0)
ignorehitpause = 1

[State 0, anim]
type = changeanim
trigger1 = parent,anim = 20000
trigger2 = parent,stateno = [9000,10000]
trigger3 = parent,stateno = 1051 && time > 40
trigger4 = parent,stateno = 1252 && time > 6
trigger5 = parent,stateno = 13203
value = 20000

;--------------------------------------------------------------------
;スタンド発光helper(Soff.Ver2(タイラップ))
[Statedef 40002]
type = U
movetype = I
physics = N
ctrl = 0
anim = parent,anim+30000

;destroy
[State 0, end]
type = DestroySelf
trigger1 = anim != parent,anim+30000
trigger2 = !numhelper(1260)

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btp]
type = bindtoparent
trigger1 = 1
pos = 0,0

[State 0, turn]
type = turn
trigger1 = facing != parent,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = 3

;---------------------------------------
;緑
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 4
time = 64
sinadd = 40,56,40,128
;青
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 5
time = 64
sinadd = 48,48,64,128
;水色
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 6
time = 64
sinadd = 40,44,48,128
;赤
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 1
time = 64
sinadd = 56,40,40,128
;黒
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 2
time = 64
sinadd = 48,48,48,128
;緑2
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 3
time = 64
sinadd = 120,60,0,128;sinadd = 40,56,40,128

;---------------------------------------

[State 0, anim]
type = changeanim
trigger1 = anim = parent,anim+30000
trigger1 = animelemno(0) != parent,animelemno(0)
value = anim
elem = parent,animelemno(0)

;--------------------------------------------------------------------
;スタンド発光helper(Soff.Ver3(お仕置き))
[Statedef 40003]
type = U
movetype = I
physics = N
ctrl = 0
anim = parent,anim+30000

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btp]
type = bindtoparent
trigger1 = 1
pos = 0,0

[State 0, turn]
type = turn
trigger1 = facing != parent,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = 4

;---------------------------------------
;緑
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 4
time = 64
sinadd = 40,56,40,128
;青
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 5
time = 64
sinadd = 48,48,64,128
;水色
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 6
time = 64
sinadd = 40,44,48,128
;赤
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 1
time = 64
sinadd = 56,40,40,128
;黒
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 2
time = 64
sinadd = 48,48,48,128
;緑2
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 3
time = 64
sinadd = 120,60,0,128;sinadd = 40,56,40,128

;---------------------------------------

[State 0, anim]
type = changeanim
triggerAll = SelfAnimExist(parent,anim+30000)
trigger1 = anim != parent,anim+30000
trigger2 = anim = parent,anim+30000
trigger2 = animelemno(0) != parent,animelemno(0)
value = parent,anim+30000
elem = parent,animelemno(0)

;destroy
[State 0, end]
type = DestroySelf
trigger1 = anim != parent,anim+30000
trigger2 = parent,time = 150

;--------------------------------------------------------------------
;スタンド発光helper(Soff.Ver4(タンデム))
[Statedef 40004]
type = U
movetype = I
physics = N
ctrl = 0
anim = parent,anim+30000

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = Noshadow
ignorehitpause = 1

[State 0, btp]
type = bindtoparent
trigger1 = 1
pos = 0,0

[State 0, turn]
type = turn
trigger1 = facing != parent,facing

[State 0, spr]
type = sprpriority
trigger1 = 1
value = 3

;---------------------------------------
;緑
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 4
time = 64
sinadd = 40,56,40,128
;青
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 5
time = 64
sinadd = 48,48,64,128
;水色
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 6
time = 64
sinadd = 40,44,48,128
;赤
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 1
time = 64
sinadd = 56,40,40,128
;黒
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 2
time = 64
sinadd = 48,48,48,128
;緑2
[State 0, pal]
type = palfx
trigger1 = !(gametime%64)
trigger1 = root,palno = 3
time = 64
sinadd = 120,60,0,128;sinadd = 40,56,40,128

;---------------------------------------

[State 0, anim]
type = changeanim
triggerAll = SelfAnimExist(parent,anim+30000)
trigger1 = anim != parent,anim+30000
trigger2 = anim = parent,anim+30000
trigger2 = animelemno(0) != parent,animelemno(0)
value = parent,anim+30000
elem = parent,animelemno(0)

;destroy
[State 0, end]
type = DestroySelf
trigger1 = anim != parent,anim+30000
trigger2 = parent,time = 400

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 890]
type    = A
movetype= H
physics = N

[State 1000, 0]
type = HitFallSet
trigger1 = time = 0
value = 0

[State 5040, 1]
type = SelfState
trigger1 = time = 0
value = 5040
;---------------------------------------------------------------------------
; HIT_TRIP2 (fall through air)
[Statedef 895]
type    = L
movetype= H
physics = N
anim = 5070
velset = 0,0

[State 5071, 1]
type = VelSet
trigger1 = Time = 0
x = -10

[State 5071, 2]
type = VelMul
trigger1 = 1
x = .88

[State 5071, 1]
type = VelSet
trigger1 = Time = 16
x = 0

[State 5071, 4] ;Hit ground
type = SelfState
trigger1 = Time = 16
value = 5110

;===========================================================================
[Statedef 4900];オラムダ合戦
type = S
movetype = A
physics = N
sprpriority = 0
velset = 0,0

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "oramuda back"
stateno = 9301
id = 9301
postype = back
trigger1 = id > enemy,id

[state 0, helper]
type = helper
trigger1 = !time
helpertype = normal
name = "oramuda cut"
stateno = 4950
id = 4950
postype = back

[State 0, end]
type = nothitby
trigger1 = 1
value = SCA

[State 0, end]
type = playsnd
trigger1 = !time
value = 4,3

[State 0, end]
type = changeanim
trigger1 = time < 30
value = anim
elem = animelemno(0)

[State 0, end]
type = changeanim
trigger1 = time = 30
value = 14900

[State 0, snd]
type = playsnd
trigger1 = animelemtime(11) = [0,220]
trigger1 = !(time%40)
value = 6,13
channel = 3

[state 0, helper]
type = helper
trigger1 = animelemtime(11) = 0
trigger2 = animelemtime(11) = 1
trigger3 = animelemtime(11) = 4
trigger4 = animelemtime(11) = 5
trigger5 = animelemtime(11) = 9
trigger6 = animelemtime(11) = 10
trigger7 = animelemtime(11) = 14
trigger8 = animelemtime(11) = 15
trigger9 = animelemtime(11) = 19
trigger10 = animelemtime(11) = 20
trigger11 = animelemtime(11) = 24
trigger12 = animelemtime(11) = 25
trigger13 = animelemtime(11) = 29
trigger14 = animelemtime(11) = 30
trigger15 = animelemtime(11) = 34
trigger16 = animelemtime(11) = 35
trigger17 = animelemtime(11) = 39
trigger18 = animelemtime(11) = 40
trigger19 = animelemtime(11) = 44
trigger20 = animelemtime(11) = 45
trigger21 = animelemtime(11) = 49
trigger22 = animelemtime(11) = 50
trigger23 = animelemtime(11) = 54
trigger24 = animelemtime(11) = 55
trigger25 = animelemtime(11) = 59
trigger26 = animelemtime(11) = 60
trigger27 = animelemtime(11) = 64
trigger28 = animelemtime(11) = 65
trigger29 = animelemtime(11) = 69
trigger30 = animelemtime(11) = 70
trigger31 = animelemtime(11) = 74
trigger32 = animelemtime(11) = 75
trigger33 = animelemtime(11) = 79
trigger34 = animelemtime(11) = 80
trigger35 = animelemtime(11) = 84
trigger36 = animelemtime(11) = 85
trigger37 = animelemtime(11) = 89
trigger38 = animelemtime(11) = 90
trigger39 = animelemtime(11) = 94
trigger40 = animelemtime(11) = 95
trigger41 = animelemtime(11) = 99
trigger42 = animelemtime(11) = 100
trigger43 = animelemtime(11) = 104
trigger44 = animelemtime(11) = 105
trigger45 = animelemtime(11) = 109
trigger46 = animelemtime(11) = 110
trigger47 = animelemtime(11) = 114
trigger48 = animelemtime(11) = 115
trigger49 = animelemtime(11) = 119
trigger50 = animelemtime(11) = 120
trigger51 = animelemtime(11) = 124
trigger52 = animelemtime(11) = 125
trigger53 = animelemtime(11) = 129
trigger54 = animelemtime(11) = 130
trigger55 = animelemtime(11) = 134
trigger56 = animelemtime(11) = 135
trigger57 = animelemtime(11) = 139
trigger58 = animelemtime(11) = 140
trigger59 = animelemtime(11) = 144
trigger60 = animelemtime(11) = 145
trigger61 = animelemtime(11) = 149
trigger62 = animelemtime(11) = 150
trigger63 = animelemtime(11) = 154
trigger64 = animelemtime(11) = 155
trigger65 = animelemtime(11) = 159
trigger66 = animelemtime(11) = 160
trigger67 = animelemtime(11) = 165
trigger68 = animelemtime(11) = 171
trigger69 = animelemtime(11) = 176
trigger70 = animelemtime(11) = 182
trigger71 = animelemtime(11) = 188
trigger72 = animelemtime(11) = 193
trigger73 = animelemtime(11) = 199
trigger74 = animelemtime(11) = 204
trigger75 = animelemtime(11) = 210
trigger76 = animelemtime(11) = 216
trigger77 = animelemtime(11) = 221
helpertype = normal
name = "oramudasp"
stateno = 3065
id = 3065+animelemtime(11)
postype = p1
pos = ceil(-33*const(size.xscale)),ceil(-(95-random%21)*const(size.yscale))
ownpal = 1

[State 0, end]
type = playsnd
triggerall = anim = 14900
trigger1 = animelemtime(11) > 0
trigger1 = !(gametime%10)
value = 0,5

[State 0, end]
type = explod
triggerall = anim = 14900
trigger1 = !enemy,numexplod(6004)
trigger1 = animelemtime(11) > 0
trigger1 = !(gametime%5)
pos = ceil(P2BodyDist X*.5),-60
postype = p1
anim = 6004
random = 24,24
sprpriority = 3
pausemovetime = 0
supermovetime = 0

[State 0, vel]
type = velset
trigger1 = time = 35
y = -.1

[State 0, var]
type = varset
trigger1 = !time
var(49) = 0

[State 0, var]
type = varadd
triggerall = time > 35
trigger1 = command = "x"
trigger2 = command = "y"
trigger3 = command = "z"
var(49) = 1

[State 0, change];勝利
type = changestate
trigger1 = time = 250
trigger1 = var(49) > enemy,var(49)
value = 4910

[State 0, change];敗北
type = changestate
trigger1 = time = 250
trigger1 = var(49) < enemy,var(49)
value = 4920

[State 0, change];同じ
type = changestate
trigger1 = time = 250
trigger1 = var(49) = enemy,var(49)
value = 4910
;------------------------------------------------------------------------------
;オラムダ勝利（落下）
[Statedef 4910]
ctrl = 0
anim = 10044
physics = A
type = A

[State 0, end]
type = nothitby
trigger1 = 1
value = SCA

;---------------------------------------------------------------------------
;オラムダ敗北（吹っ飛び）
[Statedef 4920]
type = A
movetype = H
physics = N
anim = 5030
velset = -10,-8

[State 0, screen]
type = screenbound
trigger1 = 1
value = 0

[State 0, nhb]
type = null;nothitby
trigger1 = 1
value = SCA

[State 0, vel]
type = veladd
trigger1 = 1
y = .44

[State 0, push]
type = playerpush
trigger1 = 1
value = 0

[State 0, anim]
type = changeanim
trigger1 = anim = 5030 && !animtime
trigger1 = SelfAnimExist(5035)
value = 5035
persistent = 0

[State 0, anim]
type = changeanim
trigger1 = vel y > 0
value = 5050
persistent = 0

[State 0, end]
type = changestate
trigger1 = backedgebodydist <= 10
value = 4921

[State 5040, 5] ;Recover near ground
type = SelfState
triggerall = time >= 10
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5040, 6]; Recover in mid air
type = SelfState
triggerall = time >= 10
triggerall = Vel Y > -1
triggerall = alive
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;---------------------------------------------------------------------------
;敵横吹っ飛び（壁激突）
[Statedef 4921]
type = A
movetype = H
physics = N
anim = 5012
velset = 0,0

[State 0, screen]
type = screenbound
trigger1 = 1
value = 0
;movecamera = 1,0

[State 0, shake]
type = envshake
trigger1 = !time
time = 10
freq = 85
ampl = -5

[State 0, anim]
type = changeanim
trigger1 = time < 10
value = anim

[State 0, anim]
type = changeanim
trigger1 = time = 10
value = 5050

[State 0, vel]
type = velset
trigger1 = time = 10
x = 2.2
y = -4.8

[State 0, turn]
type = turn
trigger1 = time = 10

[State 0, vel]
type = veladd
trigger1 = time > 10
y = .4

[State 5040, 5] ;Recover near ground
type = SelfState
triggerall = time >= 10
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5040, 6]; Recover in mid air
type = SelfState
triggerall = time >= 10
triggerall = Vel Y > -1
triggerall = alive
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 0, end]
type = selfstate
trigger1 = vel y > 0
trigger1 = pos y >= 0
value = 5100

;------------------------------------------------------------------------------
;背景（縦）
[Statedef 9301]
ctrl = 0
anim = 20000

[State 0, turn]
type = turn
trigger1 = !time
trigger1 = facing != root,facing

[State 0, assert]
type = assertspecial
trigger1 = 1
flag = NoBG
flag2 = NoFG

;back1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8210
id = 8210
pos = 0,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8210
id = 8215
pos = 0,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back2
[State 0, explod]
type = explod
trigger1 = !time
anim = 8211
id = 8211
pos = 107,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8211
id = 8216
pos = 107,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back3
[State 0, explod]
type = explod
trigger1 = !time
anim = 8212
id = 8212
pos = 214,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8212
id = 8217
pos = 214,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999

;back4
[State 0, explod]
type = explod
trigger1 = !time
anim = 8213
id = 8213
pos = 320,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
[State 0, explod]
type = explod
trigger1 = !time
anim = 8213
id = 8218
pos = 320,0
postype = back
bindtime = -1
scale = .84,1
ownpal = 0
sprpriority = -30
pausemovetime = 999999
supermovetime = 999999


[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8210)
id = 8210
pos = 0,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8211)
id = 8211
pos = 107,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8212)
id = 8212
pos = 214,-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8213)
id = 8213
postype = back
pos = 320,-(time*8)%512
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8215)
id = 8215
pos = 0,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8216)
id = 8216
pos = 107,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8217)
id = 8217
pos = 214,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = modifyexplod
trigger1 = numexplod(8218)
id = 8218
pos = 320,512-(time*8)%512
postype = back
ignorehitpause = 1

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8210

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8211

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8212

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8213

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8215

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8216

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8217

[State 0, explod]
type = removeexplod
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900
id = 8218

[State 0, end]
type = DestroySelf
trigger1 = roundstate = 4
trigger2 = root,stateno != 4900

;-------------------------------------------------------------------------
;AI起動用ヘルパー
[Statedef 50000]
anim=20000;なにも表示しないｱﾆﾒでもいいけど入れなくても全然問題ない
ctrl=0

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

;----------------------------------------------------------------------------------
; AIフラグセット
;----------------------------------------------------------------------------------
[State 10000,プレイヤー判定]
type=varset
trigger1=command="up"&&root,command="up"
trigger2=command="down"&&root,command="down"
trigger3=command="back"&&root,command="back"
trigger4=command="fwd"&&root,command="fwd"
trigger5=command="a"&&root,command="a"
trigger6=command="b"&&root,command="b"
trigger7=command="c"&&root,command="c"
trigger8=command="x"&&root,command="x"
trigger9=command="y"&&root,command="y"
trigger10=command="z"&&root,command="z"
trigger11=command="start"&&root,command="start"
var(59)=-1

[State 10000,ﾌﾗｸﾞON]
type=varset
triggerall=var(59)!=-1
trigger1=root,command="up"
trigger2=root,command="down"
trigger3=root,command="back"
trigger4=root,command="fwd"
trigger5=root,command="a"
trigger6=root,command="b"
trigger7=root,command="c"
trigger8=root,command="x"
trigger9=root,command="y"
trigger10=root,command="z"
trigger11=root,command="start"
var(59)=1

;----------------------------------------------------------------------------------
; 当て投げ
;----------------------------------------------------------------------------------

;----------------------------------------------------------------------------------
; コンボ分岐
;----------------------------------------------------------------------------------
;Soff始動

;タイラップ後
[State -1, コンボ分岐];
type = parentvarset
triggerall = root,var(36) = 35
trigger1 = root,stateno = 10210
trigger2 = root,fvar(18)
trigger3 = root,p2statetype != A
var(36) = 0
ignorehitpause = 1

;タイラップ後
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,stateno = 1200 || root,stateno = 1 || root,var(36)=1
trigger1 = root,var(11)
var(36) = 21
ignorehitpause = 1

;タイラップ後
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,stateno = 200 && root,movehit = 2
trigger1 = root,var(36) = 21
var(36) = 22
ignorehitpause = 1

[State -1, コンボ分岐];J攻から
type = parentvarset
triggerall = roundstate = 2 && root,movecontact = 2 && !root,Ishelper
triggerall = !root,var(36)
triggerall = !root,var(39)
triggerall = !root,var(11)
triggerall = root,p2statetype != A
;triggerall = random < 500+(root,movehit)*300
trigger1 = root,stateno = 610 && root,vel x >= 0
trigger2 = root,stateno = 620 && root,vel x >= 0
var(36) = ifelse(root,movehit||random<600||root,p2bodydist x > 45,1,-1020*!(root,var(59)>=7))
ignorehitpause = 1

[State -1, コンボ分岐];屈弱ヒットからD(屈)中＞デム
type = parentvarset
triggerall = roundstate = 2 && root,movehit = 2 && !root,Ishelper
;Triggerall = !root,var(12);(root,p2statetype=S)
triggerall = (!root,var(36) || root,var(36) = 1 || root,var(36) = -1008)
triggerall = !root,var(39)
;triggerall = root,prevstateno != [100,105]
triggerall = ((random < 800-(root,prevstateno = [100,105])*500)||(root,var(59)=7)||(root,var(36)=-1008)) && root,p2bodydist x < 65
trigger1 = root,stateno = 400 || (root,stateno = 410 && root,p2bodydist x < 42+(facing*(helper(60000+(facing=-1)*10),pos x-pos x)<125)*14)
;trigger1 = power >= 970
var(36) = 10
ignorehitpause = 1

[State -1, コンボ分岐];(D)弱ヒットから
type = parentvarset
triggerall = root,var(59) >= 7
triggerall = roundstate = 2 && root,movecontact = 2 && !root,Ishelper
Triggerall = (root,p2statetype!=A)
triggerall = root,var(36) <= 0
triggerall = !root,var(39)
triggerall = ((root,prevstateno = [100,105]) || root,var(36)<=0)
trigger1 = root,stateno = 200
var(36) = 30
ignorehitpause = 1

[State -1, コンボ分岐];弱対空から
type = parentvarset
triggerall = root,var(59)
triggerall = roundstate = 2 && root,movehit = 2 && !root,Ishelper
Triggerall = (root,p2statetype=A)
triggerall = !root,var(36)
triggerall = !root,var(39)
triggerall = root,prevstateno != [100,105]
trigger1 = root,stateno = 200
var(36) = 35
ignorehitpause = 1

;----------------------------------------------------------------------------------
;Son始動

[State -1, コンボ分岐];J攻から
type = parentvarset
triggerall = roundstate = 2 && root,movecontact = 2 && !root,Ishelper
triggerall = !root,var(36)
triggerall = !root,var(39)
triggerall = root,p2statetype != A
;triggerall = random < 500+(root,movehit)*300
trigger1 = (root,stateno = [10600,10625])
trigger1 = (root,prevstateno != [110,116])
var(36) = ifelse(root,movehit||random<400||root,p2bodydist x > 45,120,-1020*!(root,var(59)=7))
ignorehitpause = 1

[State -1, コンボ分岐];D弱＞弱＞Ｄ弱……
type = parentvarset
triggerall = root,var(59) = 7
triggerall = roundstate = 2 && root,movecontact = 2 && !root,Ishelper
Triggerall = (root,p2statetype=S)
triggerall = !root,var(36) || root,var(36) = 30
triggerall = !root,var(39)
;triggerall = root,prevstateno != [100,105]
trigger1 = root,prevstateno = 100
trigger1 = root,stateno = 10200
trigger2 = root,prevstateno = 10900
trigger2 = root,stateno = 10200
trigger2 = root,p2bodydist x < 55
var(36) = 100
ignorehitpause = 1

;空Dから当たった
[State -1, コンボ分岐]
type = parentvarset
triggerall = roundstate = 2 && root,movehit = 2 && !root,Ishelper
Triggerall = root,p2statetype!=A
triggerall = !root,var(36)
triggerall = !root,var(39)
triggerall = root,prevstateno = [110,111]
trigger1 = (root,stateno = [10610,10625])
trigger1 = root,p2bodydist x < 60 && pos y >= -20
var(36) = 110
ignorehitpause = 1

;----------------------------------------------------------------------------------
:デム後 (画面端)
[State -1, コンボ分岐];;デム後J攻へ
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = (root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)<60)
triggerall = !root,var(39)
trigger1 = root,stateno = 43; && p2statetype = S
var(36) = 1100
ignorehitpause = 1

:デム後 (AC)
[State -1, コンボ分岐];;デム後J攻へ
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = !root,var(36)
triggerall = root,var(39) = 10000 || root,var(39) = 10002
trigger1 = root,stateno = 43; && p2statetype = S
var(36) = 1000
ignorehitpause = 1

:デム後 (魅せ？)
[State -1, コンボ分岐];;デム後SonJD攻へ
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1000
trigger1 = power < 1000 && random < 800
trigger1 = root,stateno = 400 && root,time = 1
var(36) = 1002
ignorehitpause = 1

[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
trigger1 = root,var(36) = 1002
trigger1 = root,stateno = 900
var(36) = 1016
ignorehitpause = 1
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
trigger1 = root,var(36) = 1016
trigger1 = root,stateno = 610
var(36) = 1017
ignorehitpause = 1

:デム後
[State -1, コンボ分岐]
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1000
trigger1 = root,stateno = 42; && p2statetype = S
var(36) = 1001
ignorehitpause = 1

;中結界hit後の判断

;1001時超必殺で殺し切る
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1001
trigger1 = root,stateno = 42; && p2statetype = S
trigger1 = power>800 && p2life<250 && random<600+(power/10)
var(36) = 1005
ignorehitpause = 1

;2ゲージ有なら別ルートへ
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
trigger1 = root,var(36) = 1001
trigger1 = root,stateno = 50 && root,time = 20
var(36) = ifelse(power>2000&&(random<700||(root,life<=300||p2life<180||power>3000)),1020+(random<350+(power>=2500&&root,life>p2life))*10,1010)
ignorehitpause = 1

;遠中hit後1011 1031へ
[State -1, コンボ分岐x];
type = parentvaradd
triggerall = roundstate = 2 && !root,Ishelper && root,movecontact = 2
triggerall = root,var(36) = 1010 || root,var(36) = 1030
trigger1 = root,stateno = 210
var(36) = 1+ifelse(root,var(59)=7&&root,var(36)=1030&&(power >= 3000 && (root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)<170) && random < 500+(power/10)*350),84,0)
ignorehitpause = 1

:画面端2(3)ゲージ(対AI)
[State -1, コンボ分岐]
type = null;parentvarset
triggerall = root,var(59) = 7
triggerall = roundstate = 2 && !root,Ishelper && root,movecontact = 2
triggerall = root,var(36) = 1031;1011
trigger1 = numhelper(60000)
trigger1 = root,fvar(33) = 1
trigger1 = root,stateno = 215
trigger1 = (root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)<40)
trigger1 = power >= 2000
var(36) = ifelse((power >= 3000 && random < 500+(power/10)*350),1115,1116)
ignorehitpause = 1

;２回近中後半径20Mへいく場合
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper && root,movecontact = 2
triggerall = root,var(36) = 1011
trigger1 = root,fvar(33) = 2
trigger1 = root,stateno = 215
trigger1 = power>1000&&random<400+(power/10)+(facing*(helper(60000+(facing=-1)*10),pos x-pos x)<100)*300+(p2life<170)*500
var(36) = 1015
ignorehitpause = 1

;タイラップ後
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
trigger1 = root,stateno = 1200
trigger1 = root,var(36) = 1011
trigger2 = !root,var(36) && (root,p2stateno = 1280 && root,p2movetype = H)
var(36) = 1012
ignorehitpause = 1

;２回近中後
[State -1, コンボ分岐];
type = null;parentvarset
triggerall = roundstate = 2 && !root,Ishelper && root,movecontact = 2
triggerall = root,var(36) = 1011
trigger1 = root,fvar(33) = 3
trigger1 = root,stateno = 215
var(36) = 1012
ignorehitpause = 1

;５回近中後
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper; && root,movecontact = 2
triggerall = root,var(36) = 1012 || root,var(36) = 1017 || root,var(36) = 22
triggerall = numhelper(1260)
trigger1 = root,fvar(33) = 5 || helper(1260),time >= 120
var(36) = ifelse(helper(1260),fvar(0) <= 9.25,1013,23)
ignorehitpause = 1

;５回近中後(相手画面端&結界あり)
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper; && root,movecontact = 2
triggerall = root,var(36) = 1013
triggerall = numhelper(1260) && numhelper(1157)
trigger1 = root,fvar(33) = 5 || helper(1260),time >= 120
trigger1 = root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)
var(36) = 1014
ignorehitpause = 1

[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper; && root,movecontact = 2
triggerall = root,var(36) = 1014
triggerall = numhelper(1157)
trigger1 = helper(1157),movehit = 2
var(36) = 1025
ignorehitpause = 1

;--------------------------------
;お仕置き入れる
[State -1, コンボ分岐];
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1031
trigger1 = root,stateno = 3802
var(36) = 1032
ignorehitpause = 1

;----------------------------------------------------------------------------------
:デム後 (ABC)
[State -1, コンボ分岐];;デム後相手しゃがみなら屈弱へ
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = !root,var(36)
triggerall = (root,var(39) = [10000,10002])
trigger1 = root,stateno = 422; && p2statetype = S
var(36) = 1090
ignorehitpause = 1

;----------------------------------------------------------------------------------
:デム後(Bルート後)
[State -1, コンボ分岐];;デム後J攻へ
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = !root,var(36) || (root,var(39) = 10000&&root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)<60)
triggerall = root,var(39) = 10001 || root,var(39) = 10000
trigger1 = root,stateno = 42; && p2statetype = S
var(36) = 1100
ignorehitpause = 1

:ゲージ無or半径20M締め
[State -1, コンボ分岐]
type = parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1100
trigger1 = root,stateno = 10220 && root,animelemtime(12) = 0
trigger1 = root,fvar(33) = 3
var(36) = ifelse((power >= 1000 && random < 500+(power/10)+(p2life<150)*350),1110,1101)
ignorehitpause = 1

:2(3)ゲージ(対AI)
[State -1, コンボ分岐]
type = parentvarset
triggerall = root,var(59) = 7
triggerall = roundstate = 2 && !root,Ishelper
triggerall = root,var(36) = 1100
trigger1 = root,stateno = 11100 && root,time = 2
trigger1 = root,fvar(33) = 2
trigger1 = power >= 2000
var(36) = ifelse((power >= 3000 && random < 500+(power/10)*350),1115,1116)
ignorehitpause = 1

[state -2, debug]
type = DisplayToClipboard
trigger1 = 1
text = "front=%f,back=%f,9=%d,10=%d"
params = (root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x)),(-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)),var(9),var(10)
ignorehitpause = 1

;----------------------------------------------------------------------------------
;結界hit判定
[State -2, Combo]
type = VarSet
trigger1 = numhelper(1155)
trigger1 = helper(1155),movehit = 2
trigger1 = helper(1155),numtarget
trigger2 = numhelper(1156)
trigger2 = helper(1156),movehit = 2
trigger2 = helper(1156),numtarget
trigger3 = numhelper(1157)
trigger3 = helper(1157),movehit = 2
trigger3 = helper(1157),numtarget
var(17) = 70
ignorehitpause = 1
;結界ガード判定
[State -2, Combo]
type = VarSet
trigger1 = numhelper(1155)
trigger1 = helper(1155),moveguarded = 2
trigger2 = numhelper(1156)
trigger2 = helper(1156),moveguarded = 2
trigger3 = numhelper(1157)
trigger3 = helper(1157),moveguarded = 2
var(17) = -24
ignorehitpause = 1
;結界hit判定
[State -2, Combo]
type = Varadd
trigger1 = var(17)
var(17) = ifelse(var(17)>0,-1,1)
ignorehitpause = 1
;結界hit判定
[State -2, Combo]
type = VarSet
trigger1 = p2movetype != H
trigger2 = root,movecontact = 2 || helper(10000),movecontact = 2
var(17) = 0
ignorehitpause = 1

;----------------------------------------------------------------------------------
; 結界ヒット時の判断
;----------------------------------------------------------------------------------
;分岐待機
[State -1, ]
type = parentvarset
triggerall = roundstate = 2
triggerall = !root,var(36) || (root,var(36)=[-10420,-10210])
triggerall = !root,var(39)
trigger1 = var(17)
var(36) = -10000
ignorehitpause = 1

;相手地上とどめ(タイラップ)
[State -1, デム]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) > 20+(root,p2bodydist x/20)
triggerall = root,p2bodydist x < 152
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
;trigger1 = root,power >= 1000
trigger1 = root,p2life < 75
var(36) = -10025
ignorehitpause = 1

;相手地上とどめ(Sハイフィニ)
[State -1,ハイ]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) > 25+(root,p2bodydist x/8)
;triggerall = root,p2bodydist x > 80
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
trigger1 = root,power >= 1000
trigger1 = root,p2life < 150
var(36) = -10002
ignorehitpause = 1

;相手地上とどめ(Sエメ？)
[State -1, デム]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) > 25+(root,p2bodydist x/20)
triggerall = root,p2bodydist x > 55
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
trigger1 = root,power >= 1000
trigger1 = root,p2life < 100
var(36) = -10005
ignorehitpause = 1

;相手地上(延長デム)
[State -1, デム]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) > 45

triggerall = root,facing*(helper(60000+(root,facing=-1)*10),pos x-root,pos x) > 250
triggerall = root,p2bodydist x < 120
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
trigger1 = root,power >= 1000
trigger1 = !numhelper(1155) || !numhelper(1156)
;trigger1 = root,p2life - root,life > 500
var(36) = -10040
ignorehitpause = 1

;相手地上
[State -1, デム]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) > 10+(root,p2bodydist x/8)
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
;trigger1 = root,power >= 1000
var(36) = -10001
ignorehitpause = 1

;相手空中
[State -1, air]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
;triggerall = root,statetype != A
triggerall = root,p2statetype = A
triggerall = var(17) > 20
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
var(36) = -10010
ignorehitpause = 1

;相手地上&ガード(タイラップ)
[State -1, air]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype != A
triggerall = var(17) < -10
triggerall = (root,p2bodydist x = [60,150]) || (-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)<100)
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
trigger1 = random < 500
var(36) = -10030
ignorehitpause = 1

;相手空中&ガード
[State -1, air]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = root,p2statetype = A
triggerall = var(17) < -10
triggerall = root,p2bodydist x < 70 && root,p2bodydist y > -100
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
;trigger1 = root,power >= 1000
var(36) = -10015
ignorehitpause = 1

;逃げて結界
[State -3];
type=parentvarset
triggerall = roundstate = 2
triggerall = root,var(36) = -10000
triggerall = !root,var(39)
triggerall = root,statetype != A
triggerall = var(17) < 0
triggerall = root,p2bodydist x < 150
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time>0)
;trigger1 = root,power >= 1000
trigger1 = !(-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)<100)
var(36) = -10500

;----------------------------------------------------------------------------------
; 崩し　起き攻め　その他
;----------------------------------------------------------------------------------
[State -3];解除条件
type=parentVarset
triggerall=root,var(36) < 0
trigger1=root,MoveType=H && !(root,stateno = [0,159])
trigger2=root,stateno = 3500 && root,time = 2
Trigger3=(root,var(36)=[-1200,-1000]) || (root,var(36)=[-4,-2])
Trigger3=var(3) >= 10
Trigger4=root,var(36)=[-1200,-1000]
Trigger4=(root,p2statetype=L || root,p2statetype=A)
Trigger5=root,var(36)=[-1200,-1000]
Trigger5=(root,P2bodydist x > 120 || root,P2dist x < 0)
Trigger6=root,var(36)=-1020
trigger6=root,stateno=52 && root,p2movetype != H
Trigger7=root,var(36)=-1101
trigger7=(root,stateno=[10600,10625])
Trigger8=root,var(36)=-1200
trigger8=(root,stateno=115)
Trigger9=(root,var(36)=-1) && p2bodydist x > 90
;起き攻めとか
trigger10=(root,var(36) = [-11,-1])
trigger10=root,p2statetype = A || (root,P2bodydist x > 70&&root,p2movetype!=H)
trigger11=(root,var(36) = -11)
trigger11=(root,p2stateno = [150,159]) || (root,stateno = 52 && root,p2movetype != H)
trigger12=(root,var(36) = [-10001,-10000])
trigger12=(root,p2movetype!=H)||(root,stateno=10410&&root,time=1)||(root,p2statetype=A)
trigger13=(root,var(36) = -10010)
trigger13=(root,p2movetype!=H)||((root,stateno=11010||root,stateno=3610)&&root,time=1)||(root,p2statetype!=A||(enemynear(root,var(48)),canrecover))
trigger14=(root,var(36) = -10025)
trigger14=(root,stateno=11200)
trigger15=(root,var(36) = -10110)
trigger15=(root,stateno=110)
trigger16=(root,var(36) = [-10420,-10200])
trigger16=(root,stateno=11100 || root,stateno = 10520)
trigger17=(root,var(36) = -10500||root,var(36) = -41100)
trigger17=(root,stateno=1100)
var(36)=0

[State -3];解除条件2
type=parentVarset
triggerall=root,var(36) < 0
;セット
trigger1=(root,var(36) = [-101,-100])
trigger1=root,p2statetype = A || root,movetype = A || root,p2bodydist x > 130 || root,anim = 101
trigger2=(root,var(36) = -301 || root,var(36) = -1250 || root,var(36) = -3900)
trigger2=root,movetype != I  || (root,var(36) = -1250 && root,stateno = 52)
trigger3=(root,var(36) = -3900)
trigger3=root,p2bodydist x > 90
trigger4=(root,var(36) = -11000||root,var(36) = 1110)
trigger4=root,stateno = 11000||root,stateno = 3600
;町カキョ
trigger5=(root,var(36) = [-11101,-11100])
trigger5=root,p2bodydist x > 85
trigger6=root,var(36) = -11101
trigger6=!(root,fvar(18) && root,fvar(19))
trigger7=root,var(36) = -140
trigger7=root,stateno = 1100 || (root,vel y > 0 && root,pos y > -10)
trigger8=root,var(36) = -10105
trigger8=(root,anim = 106+root,var(0)) || (root,stateno = 1050)
var(36)=0

[State -3];解除条件(保険)
type=parentVarset
trigger1=root,var(36) = 1110
trigger1=root,stateno = 11000||root,stateno = 3600
trigger2=root,var(36) = 23
trigger2=root,stateno = 100 && root,facing = enemynear(root,var(48)),facing
var(36)=0

[State -3];解除条件(タッグ)
type=parentVarset
triggerall=(numpartner && !root,fvar(36))
triggerall=root,var(36) < 0
trigger1=root,time >60
trigger2=root,stateno = 11000 || root,stateno = 11200 || root,stateno = 3600
trigger3=root,stateno = 10520 || root,stateno = 10210 || root,stateno = 3900
var(36)=0

[State -3]
type=varset
trigger1 = !(root,ctrl || root,stateno = 196)
var(3) = 0
[State -3]
type=varadd
trigger1 = root,ctrl || root,stateno = 196
trigger1 = !((root,var(36) = (-1000,0)) && root,p2statetype = L && root,stateno != 50)
var(3) = 1

;起き攻め開始は-2で

;起き攻め後の判断
;攻撃も結界もヒット
[State -3]
type=parentvarset
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1= (root,p2movetype=H&&root,p2stateno>=5000)
trigger1= root,var(36) = -1 || root,var(36) = -10
trigger1= numhelper(1155)
trigger1= helper(1155),stateno = 1157
trigger1= (root,stateno = 10630||root,stateno = 10400) && root,movehit
trigger2= (root,p2movetype=H&&root,p2stateno>=5000)
trigger2= root,var(36) = -11
trigger2= numhelper(1155)
trigger2= helper(1155),stateno = 1157
trigger2= (root,stateno = 23&&root,p2bodydist x < 5)
var(36) = -2

;攻撃も結界もガード
[State -3]
type=parentvarset
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=(root,p2movetype=H&&(root,p2stateno=[150,159]))
trigger1=root,var(36) = -1 || root,var(36) = -10
trigger1= numhelper(1155)
trigger1= helper(1155),stateno = 1157
trigger1=(root,stateno = 10630||root,stateno = 10400) && root,moveguarded
trigger1=(root,p2bodydist x < 50)
var(36) = ifelse(random<750,-3,-4)

[State -3]
type=parentvarset
triggerall=!root,var(39)
trigger1=(root,var(36)=-3)
trigger1=(root,stateno=43)
var(36) = -5

;-------------------------------------------
;崩し
;屈弱とドリルの２択
[State -3];崩し選択
type=parentvarset
triggerall=root,var(36) = 0 || root,var(36) = 1 || root,var(36) = -1008
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=random<600;-(root,var(59)=7)*400
trigger1=root,stateno = 400 && (root,moveguarded = 2 || (root,movehit = 2 && (root,p2statetype=C||power<970)))
trigger2=root,stateno = 1000
trigger2=random<500-(root,var(59)=7)*300
var(36) = -1000

[State -3];崩し選択
type=parentvarset
triggerall=!root,var(59) >= 7
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=root,var(36) = -1000
trigger1=(root,movecontact = 2)
trigger1=(root,prevstateno = [100,105])
trigger1=root,stateno = 210
trigger1=random<140-(root,var(59)=7)*100
var(36) = -1002

[State -3];崩し選択
type=parentvarset
triggerall=!root,var(59) >= 7
triggerall=!root,var(39)
triggerall=root,var(36) = -1000
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=root,stateno = 1000
var(36) = -1001
[State -3];崩し選択
type=parentvarset
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=root,var(36) = -1001
trigger1=(root,movecontact = 2)
trigger1=(root,prevstateno != [100,105])
trigger1=root,stateno = 400
var(36) = ifelse(random<250+((root,p2stateno=[5000,5011]))*400,-1009,-1002)

[State -3]
type=parentvarset
triggerall=root,var(36) = -1009
trigger1=root,stateno = 400 && root,time=1
var(36) = -1008
;-------------------
;-1000D中後弱結界＞択

[State -3];崩し選択
type=parentvarset
triggerall=!root,var(39)
;triggerall=root,var(59) = 4
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=!(numhelper(1155))
trigger1=root,var(36) = -1000
trigger1=(root,movecontact = 2)
trigger1=(root,prevstateno = [100,105])
trigger1=root,stateno = 210
trigger1=(power>=1000 && root,var(59) = 4)
trigger2=!(numhelper(1155)&&numhelper(1156)&&numhelper(1157))
trigger2=root,var(36) <= 0
trigger2=(root,movecontact = 2)
;trigger2=(root,prevstateno = [100,105])
trigger2=root,stateno = 410
var(36) = -1010

;ドリル後の判断
;ドリルも結界もヒット
[State -3]
type=parentvarset
triggerall=!root,var(39)
;triggerall=root,var(59) = 4
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=(root,p2movetype=H)
trigger1=root,var(36) = -1010
trigger1= numhelper(1155)
trigger1= helper(1155),stateno = 1157
trigger1=root,stateno = 10630 && root,movehit
;trigger1=random<280-(root,var(59)=7)*100
var(36) = -1011

;-------------------------------------------
;ドリル
[State -3];崩し選択
type=parentvarset
triggerall=!root,var(59) > 7
triggerall=root,var(36) = -1000 || root,var(36) = -1008
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=random<300
trigger1=(root,prevstateno != [100,105])
trigger1=root,stateno = 400 && root,moveguarded = 2
var(36) = -1020

;ドリル2
[State -3];崩し選択
type=parentvarset
triggerall=!root,var(59) > 7
triggerall=!root,var(36)
triggerall=!root,var(39)
triggerall=!root,var(9)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
triggerall=(root,statetype!=A)
trigger1=root,p2bodydist x < 50
trigger1=random<100
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 100 && root,time > 2)
var(36) = -1020
;-------------------------------------------
;崩し(空D後)
;ガードされた
[State -3];崩し選択
type=parentvarset
;triggerall=root,var(59) != 7
triggerall=!var(40)
triggerall=!root,var(36)
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
;triggerall = !(root,fvar(17)+root,fvar(18)+root,fvar(19)>=1)
trigger1=root,pos y = [-40,0]
;trigger1=((root,stateno = 10610||root,stateno = 10625) && (root,prevstateno = [110,111])) && (root,moveguarded = 2)
trigger1 = (root,stateno = [10600,10625]) && (root,moveguarded = 2)
trigger1 = var(40) := 1
var(36) = ifelse((power>=2000||p2life<180)&&random<100+(root,var(59)=7)*400,-1110,ifelse(root,var(59)=7||(root,fvar(17)+root,fvar(18)+root,fvar(19)>=1),-1200,-1100))
;var(36) = ifelse(power>=1000&&random<100+(root,var(59)=7)*400+(p2life<180)*100,-1110,-1100*(root,var(59)!=7))

[State -3]
type=parentvarset
triggerall=root,var(59) != 7
triggerall=root,var(36) = -1100
triggerall=!root,var(39)
triggerall=!(root,p2statetype=L||root,p2statetype=A)
trigger1=root,stateno = 11110 && root,time = 2
var(36) = -1101

[State -3]
type=varset
trigger1 = root,statetype != A
var(40) = 0

;----------------------------------------------------------------------------------
; 硬直差
;----------------------------------------------------------------------------------
[State -1]
type = Varset
trigger1 = enemynear(root,var(48)),movetype = I
var(15) = 1
ignorehitpause = 1

[State -1]
type = Varset
trigger1 = var(15) = 1
trigger1 = root,movetype = H
trigger1 = root,stateno = 150 || root,stateno = 152
var(15) = 2
ignorehitpause = 1

[State -1]
type = Varset
trigger1 = var(15) = 2
trigger1 = enemynear(root,var(48)),movetype = A
trigger1 = root,stateno = 150 || root,stateno = 152
var(16) = root,p2stateno
ignorehitpause = 1

[State -1]
type = Varset
trigger1 = var(15) = 2
trigger1 = root,p2movetype != A
trigger1 = root,movetype != H
;trigger1 = var(16) := 0
var(15) = 0
ignosehitpause = 1
[State -1]
type = Varset
trigger1 = root,p2movetype != A
trigger1 = root,movetype != H
trigger2 = enemynear(root,var(48)),time = 1
trigger2 = enemynear(root,var(48)),movetype = A
var(16) = 0
ignosehitpause = 1

;-------------------------------------------
;セットプレイ的な
;-----
;D攻撃で隙付き2a
[State -3];
type=parentvarset
triggerall = !root,var(0)
triggerall=root,statetype != A
triggerall=!(root,p2statetype=L||root,p2statetype=A)

triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=(root,var(36) != [-11101,-11100])
triggerall = !root,fvar(17);a
triggerall = !root,var(39)
triggerall = root,P2StateType != A
triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

triggerall= !(numpartner && !root,fvar(36))
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || root,stateno = 900 || root,stateno = 10900
trigger1 = var(15) = 2 && var(16) = root,p2stateno
trigger1 = p2stateno != [40,45]
trigger1 = enemynear(root,var(48)),animtime <= -13;(発生+1)
trigger1 = (root,p2bodydist x = [50,120])
var(36) = -100

;D攻撃で隙付き(2b)
[State -3];
type=parentvarset
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=(root,var(36) != [-11101,-11100])
triggerall=root,statetype != A
triggerall=!(root,p2statetype=L||root,p2statetype=A)

triggerall = !root,fvar(17);a
triggerall = !root,var(39)
triggerall = root,P2StateType != A
triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201
triggerall= !(numpartner && !root,fvar(36))
;奇襲
;trigger1 = power > 1000
trigger1 = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21
trigger1 = (root,p2bodydist x = [60-(root,var(0))*15,117-(root,var(0))*15])
trigger1 = !root,inguarddist || root,p2bodydist x > 110
trigger1 = random < 40
var(36) = -101

;回り込み後
[State -3];
type=parentvarset
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A
triggerall=!(root,p2statetype=L||root,p2statetype=A)

triggerall = !root,fvar(17);a
triggerall = !root,var(39)
triggerall = root,P2StateType != A
triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

trigger1 = root,stateno = 300 && root,animtime = -1
;trigger1 = var(15) = 2 && var(16) = root,p2stateno
trigger1 = enemynear(root,var(48)),animtime <= -5+(root,p2statetype=S)*2;(発生)
trigger1 = !enemynear(root,var(48)),ctrl
trigger1 = root,p2bodydist x = [-50,50]
;trigger1 = root,facing != enemynear(root,var(48)),facing
var(36) = -301

;逃げ
[State -3];
type=parentvarset
triggerall= root,var(59) = 7
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A

triggerall = !root,var(39)
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

triggerall = root,prevstateno = 105
trigger1 = root,stateno = 1000
trigger2 = (numpartner && !root,fvar(36));タッグ専用
trigger2 = root,ctrl || root,stateno = 21 || root,stateno = 52 || (root,stateno = [120,131])
trigger2 = !root,backedgebodydist < 80
trigger2 = root,facing = partner,facing
trigger2 = random < 30 + (root,p2bodydist x < 60)*30
var(36) = -10105

;-------------

;空低D
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = !root,fvar(18);b
triggerall = !root,var(39)
triggerall = root,P2StateType != A
triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = !root,var(36)
trigger1 = root,p2bodydist x = [110+(!root,var(0))*15,160+(!root,var(0))*15]
trigger1 = random < 30+(var(19))-(root,life<500)*20
var(36) = -10110

;-------------
;上りJ攻撃＞結界(off)
[State -3];
type=parentvarset
triggerall=!root,var(36)
triggerall=root,statetype != A

triggerall = !(numhelper(1155)&&numhelper(1156)&&numhelper(1157))
triggerall = !root,var(39)
triggerall = root,P2StateType != A
triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

triggerall = !(-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)<160)
triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = (root,p2bodydist x = [-5,45-(root,var(0))*15])
trigger1 = !root,inguarddist || root,p2statetype = C
trigger1 = random < 60
trigger2 = (enemynear(root,var(48)),hitdefattr = S,ST,HT)
trigger2 = root,P2bodydist X < 100
var(36) = -140

;-------------

;結界まち
[State -3];
type=parentvarset
triggerall=root,var(59) >= 7
triggerall=root,var(36) <= 0 || root,power < 1000
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A

triggerall = !root,var(39)
trigger1 = root,fvar(17);a
trigger1 = root,var(36) = -1010
trigger1 = root,stateno = 1100
trigger2 = root,var(36) = -20
trigger2 = (root,fvar(19)) || (root,fvar(18)&&-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)<60)
trigger2 = root,ctrl || root,stateno = 1
;trigger3 = !(root,fvar(17)&&root,fvar(18));a
;trigger3 = root,var(36) = 10
var(36) = -11100

;結界まち2(待機)
[State -3];
type=parentvarset
triggerall=root,var(59) >= 7
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A

triggerall = !root,var(39)
trigger1 = root,var(36) = -11100
trigger1 = root,p2bodydist x > 50
var(36) = -11101

;-------------

;タイラップ上下
[State -3];
type=parentvarset
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10029,-10000])
triggerall=root,statetype != A

;triggerall = !root,fvar(17);a
triggerall = !root,var(39)
;triggerall = root,P2StateType != A
;triggerall = root,P2StateType != L
triggerall = root,P2stateno != 5120
triggerall = root,P2stateno != 5201

trigger1 = helper(10000),stateno = 1250
;trigger1 = root,p2bodydist x = [80,165-(root,var(0))*15]
var(36) = -1250

;-------------
;offして結界
;結界
[State -1, 1000]
type = parentvarset
triggerall = roundstate = 2
triggerall = root,statetype != A
triggerall = !root,var(8)
triggerall = !root,var(9)

triggerall = !root,var(39)
triggerall = !root,var(36)

triggerall = (numhelper(1155)+numhelper(1156)+numhelper(1157))<1
triggerall = !(root,fvar(17)&&root,fvar(18)&&root,fvar(19))
triggerall = !root,var(32)
triggerall = !(root,inguarddist && enemynear(root,var(48)),numproj)

triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time) || ((root,stateno = 100 || root,stateno = 105) && root,animelemtime(2) >= 0)
triggerall = root,p2bodydist x >= 90+(root,var(0)>0)*15
triggerall = !(root,inguarddist&&root,var(59)=7)
triggerall = !(numpartner && !root,fvar(36))
trigger1 = random < 50+(root,p2bodydist x >130)*21-(root,p2bodydist y > 100)*10-(root,Inguarddist)*55+(root,P2StateType = L)*250+!(root,fvar(17)||root,fvar(18)||root,fvar(19))*50-(!root,fvar(36))*25-(root,fvar(35)*15)-(numpartner&&partner,alive)-50
var(36) = -41100

;-------------
;onして通常攻撃
;B
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = root,P2StateType != L

triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
triggerall = !root,var(36)
triggerall = !(numhelper(1155)+numhelper(1156)+numhelper(1157)>=2)
trigger1 = root,P2StateType != A
trigger1 = (root,p2bodydist x = [70+(!root,var(0))*15,95+(!root,var(0))*15])
trigger1 = !root,inguarddist && !root,var(32)
trigger1 = (root,p2stateno = [40,44])
trigger1= random < 300-(fvar(17)||fvar(18)||fvar(19))*15-(root,var(59)=4)*250
trigger2 = root,P2StateType = A
trigger2 = (root,p2bodydist x = [70+(!root,var(0))*15,100+(!root,var(0))*15])
trigger2 = (root,p2bodydist y = [-114,-75])
trigger2 = !root,inguarddist && !root,var(32)
trigger2= random < 120-(fvar(17)||fvar(18)||fvar(19))*15-(root,var(59)=4)*80
var(36) = -10210

;2B
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = root,P2StateType != A
triggerall = root,P2StateType != L

triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = !root,var(36)
trigger1 = (root,p2bodydist x = [95+(!root,var(0))*15,135+(!root,var(0))*15])
trigger1 = !(numhelper(1155)+numhelper(1156)+numhelper(1157)>=2)
trigger1 = !root,inguarddist && !root,var(32)
trigger1= random < 30-(fvar(17)||fvar(18)||fvar(19))*15
trigger2= (numpartner && !root,fvar(36))
trigger2= (root,p2bodydist x = [60,135+(!root,var(0))*15]) || enemynear(root,var(48)),facing=root,facing || partner,movetype = H
trigger2= random < 80 + (partner,movetype = H)*50
var(36) = -10410

;-------------

;onしてエメスプ
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = root,p2bodydist x > 150
trigger1 = root,var(36) = 23 || root,p2stateno = 1282
trigger2 =!root,var(36)
trigger2 = root,p2bodydist y > -40
trigger2 = root,p2bodydist x > 160
trigger2 = random < 30+(fvar(17)||fvar(18)||fvar(19))*10+(var(18))-(root,life<400)*30
trigger3= (numpartner && !root,fvar(36));tag
trigger3= (root,p2bodydist x > 100)
trigger3= random < 80 + (partner,movetype = H)*50
var(36) = -11000

;-------------

;onしてタイラップ(タッグ)
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = root,statetype != A
triggerall = root,statetype != L
triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1= (numpartner && !root,fvar(36));tag
trigger1= (root,p2bodydist x = [90,150])
trigger1= random < 40
var(36) = -10025

;onしてタイラップ(タッグ)
[State -3];
type=parentvarset
;triggerall = !root,var(0)
triggerall = !root,var(9)
triggerall = !root,var(23)

triggerall = root,statetype != A
triggerall = root,statetype != L
triggerall = root,p2statetype = A && root,p2bodydist y < -70
triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1= (numpartner && !root,fvar(36));tag
trigger1= partner,numtarget && partner,movehit
trigger1= (root,p2bodydist x >= 90)
trigger1= random < 60
var(36) = -10010

;-------------

;超反応ハイエロフィニッシュ
[State -3];
type=parentvarset
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A
triggerall=root,statetype != L
triggerall=!(root,p2statetype=L||root,p2statetype=A)
triggerall = !root,var(8)
triggerall = !root,var(9)
triggerall = !root,var(23)
triggerall = root,power >= 1500 || (power > 1000 && life < 100)

triggerall = root,P2MoveType = A && root,movetype != H
triggerall = root,P2stateType != A
triggerall = Random < 0+(root,life < root,p2life)*40+(root,p2life < 220)*80+(root,life<450)*70+(power > 4000)*30
triggerall = enemynear(root,var(48)),animtime <= -10;(発生+1)
triggerall = root,p2bodydist x < 50+(!root,var(0))*15+(enemynear(root,var(48)),vel x*1)
triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = root,var(59) >= 7
trigger1 = root,life < 700
var(36) = -3900

;超反応ハイエロフィニッシュ(tag)
[State -3];
type=parentvarset
triggerall=root,var(36) <= 0
triggerall=(root,var(36) != [-10099,-10000])
triggerall=root,statetype != A
triggerall=root,statetype != L
triggerall=!(root,p2statetype=L||root,p2statetype=A)
triggerall = !root,var(8)
triggerall = !root,var(9)
triggerall = !root,var(23)
triggerall = root,power >= 1000

triggerall= (numpartner && !root,fvar(36));tag
triggerall = root,p2movetype != I
triggerall = root,movetype != H
triggerall = root,P2stateType != A || root,p2bodydist y > -20
triggerall = Random < 120+(partner,movetype = H)*60+(p2movetype = H&&partner,numtarget)*120+((-root,facing*(helper(60000+(root,facing=1)*10),pos x-root,pos x)<80)*300)
triggerall = root,ctrl || (root,stateno = [120,131]) || root,stateno = 21 || (root,stateno = 52 && root,time)
trigger1 = (root,p2bodydist x < 55)
var(36) = -3900

;----------------------------------------------------------------------------------
; 相手クラッシュ時
;----------------------------------------------------------------------------------
[State -1, コンボ分岐];デムへ
type = null;parentvarset
triggerall = roundstate = 2 && !root,Ishelper
triggerall = !root,var(39)
triggerall = !root,var(9)
triggerall = p2statetype != A
triggerall = power >= 1000
triggerall = enemynear(root,var(48)),time < 10
triggerall = ((p2stateno = [4000,4100]) || (p2stateno = [6000,6001]) && p2movetype = H) || (p2stateno = 5910)
trigger1 = root,stateno = 210 || root,stateno = 220 || (root,stateno = [410,422]) || (root,stateno = [10200,10222]) || (root,stateno = [10400,10520]) || root,stateno = 11100 || root,stateno = 10950
trigger1 = random < 800
trigger1 = root,p2bodydist x < 120
var(36) = 180

;----------------------------------------------------------------------------------
; off判別
;----------------------------------------------------------------------------------
;遠くでガードしたら
[State -1, コンボ分岐]
type = parentvarset
trigger1 = root,var(0)
trigger1 = (root,stateno = [150,153]) && root,p2bodydist x > 150
trigger1 = random < 20
var(35) = 1
ignorehitpause = 1

[State -1, コンボ分岐]
type = parentvarset
trigger1 = !root,var(0)
trigger2 = root,p2bodydist x < 55
var(35) = 0
ignorehitpause = 1

;----------------------------------------------------------------------------------
; めくり対策
;----------------------------------------------------------------------------------
[state ]
type=posset
trigger1=1
x=root,pos x-30*facing
y=0
[state ]
type=varadd
trigger1=var(57):=0||1
var(57)=inguarddist
[state ]
type=posset
trigger1=1
x=root,pos x+30*facing
y=0
[state ]
type=varadd
trigger1=1
var(57)=inguarddist
[state ]
type=posset
trigger1=1
x=root,pos x-60*facing
y=0
[state ]
type=varadd
trigger1=1
var(57)=inguarddist
[state ]
type=posset
trigger1=1
x=root,pos x+60*facing
y=0
[state ]
type=varadd
trigger1=1
var(57)=inguarddist
[state ]
type=posset
trigger1=1
x=root,pos x-90*facing
y=0
[state ]
type=varadd
trigger1=1
var(57)=inguarddist
[state ]
type=posset
trigger1=1
x=root,pos x+90*facing
y=0
[state ]
type=varadd
trigger1=1
var(57)=inguarddist

[state ]
type=turn
trigger1=facing!= root,facing

;----------------------------------------------------------------------------------
; 学習？
;--------------------
;学習用(エメスプ)
[State -2]
type = varadd
triggerall = !root,var(36) > 0
trigger1 = var(18) < 20
trigger1 = root,stateno = 11000 && root,p2movetype = H
trigger1 = root,animtime = -1
var(18) = 5-(root,p2stateno=[150,159])*3
ignorehitpause = 1
[State -2]
type = varadd
trigger1 = var(18) > -20
trigger1 = root,movetype = H && root,prevstateno = 11000
trigger1 = root,time = 2
var(18) = -25
ignorehitpause = 1

;学習用(空D)
[State -2]
type = varadd
triggerall = !root,var(36) > 0
trigger1 = var(19) < 20
trigger1 = root,prevstateno = 110
trigger1 = (root,stateno = [10610,10625]) && root,movehit = 2
var(19) = 5
ignorehitpause = 1
[State -2]
type = varadd
trigger1 = var(19) > -20
trigger1 = root,movetype = H
trigger1 = ((root,prevstateno = [10610,10625])&&root,pos y > -35) || (root,prevstateno = 110)
trigger1 = root,time = 2
var(19) = -12
ignorehitpause = 1

;----------------------------------------------------------------------------------
; 立ち下段学習
;----------------------------------------------------------------------------------

;学習用
[State -2];地上中段＆空中下段学習用
type = varset
trigger1 = root,stateno = 131||(root,stateno = [152,153])
var(4) = 1
ignorehitpause = 1

[State -2];地上中段＆空中下段学習用
type = varset
trigger1 = root,stateno = 130||(root,stateno = [150,151])
var(4) = -1
ignorehitpause = 1

[State -2];地上＆空中下段中段学習用
type = varset
trigger1 = !((root,stateno = [130,131])||(root,stateno = [150,153]))
trigger1 = root,time >= 2
var(4) = 0
ignorehitpause = 1

[State -2];地上中段学習用
type = varset
trigger1 = var(4)=1
;trigger1 = !var(5)
trigger1 = root,movetype = H
trigger1 = root,stateno >= 200
trigger1 = root,P2Statetype != A
trigger1 = root,P2Movetype = A
var(5) = root,P2Stateno
ignorehitpause = 1

[State -2];地上中段学習用
type = varset
trigger1 = var(4)=-1
trigger1 = var(5)=root,P2stateno
trigger1 = root,movetype = H
trigger1 = root,stateno > 200
trigger1 = root,P2statetype != A
trigger1 = root,P2movetype = A
var(5) = 0
ignorehitpause = 1

[State -2];立ち下段学習用
type = varset
trigger1 = var(4)=-1
trigger1 = !var(6)
trigger1 = root,movetype = H
trigger1 = root,stateno >= 200
trigger1 = root,P2Statetype = S
trigger1 = root,P2Movetype = A
var(6) = root,P2Stateno
ignorehitpause = 1

[State -2];立ち下段学習用
type = varset
trigger1 = var(4)=1
trigger1 = var(6)=root,P2Stateno
trigger1 = root,movetype = H
trigger1 = root,stateno > 200
trigger1 = root,P2Statetype = S
trigger1 = root,P2Movetype = A
var(6) = 0
ignorehitpause = 1

;----------------------------------------------------------------------------------
; 暗転計測
;----------------------------------------------------------------------------------
[State -1]
type = VarSet
trigger1 = root,var(59) > 0
trigger1 = enemynear(root,var(48)),time = 1
v = 7
value = 0
[State -1]
type = VarAdd
trigger1 = root,var(59)
v = 7
value = 1
ignorehitpause = 1

;----------------------------------------------------------------------------------
; ガードしている時間の計測(ガーキャン条件用)
;----------------------------------------------------------------------------------
[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = (root,stateno = [150,153]) || root,stateno = 710
var(8) = 1
ignorehitpause = 1
[State -1]
type = Varset
trigger1 = root,stateno != [150,153]
trigger1 = root,stateno != 710
var(8) = 0
ignorehitpause = 1

;----------------------------------------------------------------------------------
; 待ち状態へ
;----------------------------------------------------------------------------------
[State -1]
type = playsnd
trigger1 = var(9) < 0
value = 0,10
ignorehitpause = 1

[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1155)
trigger1 = helper(1155),stateno = 1155
trigger1 = var(10):= 1
trigger1 = !var(9)
var(9) = 1
ignorehitpause = 1
[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1156)
trigger1 = helper(1156),stateno = 1155
trigger1 = var(11):= 1
trigger1 = !var(9)
var(9) = 1
ignorehitpause = 1
[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1157)
trigger1 = helper(1157),stateno = 1155
trigger1 = var(12):= 1
trigger1 = !var(9)
var(9) = 1
ignorehitpause = 1

[State -1]
type = parentVarset
trigger1 = root,var(59)
fvar(17) = (var(10)=1)
[State -1]
type = parentVarset
trigger1 = root,var(59)
fvar(18) = (var(11)=1)
[State -1]
type = parentVarset
trigger1 = root,var(59)
fvar(19) = (var(12)=1)

[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1155)
trigger1 = helper(1155),stateno != 1155
trigger1 = var(10):= 0
var(9) = -1
ignorehitpause = 1
[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1156)
trigger1 = helper(1156),stateno != 1155
trigger1 = var(11):= 0
var(9) = -1
ignorehitpause = 1
[State -1]
type = Varadd
trigger1 = root,var(59)
trigger1 = numhelper(1157)
trigger1 = helper(1157),stateno != 1155
trigger1 = var(12):= 0
var(9) = -1
ignorehitpause = 1

;===========================================================================
; ヘルパー式射撃感知
;===========================================================================
[Statedef 51000]
anim=20000;なにも表示しないｱﾆﾒでもいいけど入れなくても全然問題ない
ctrl=0

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

[state 51000]	;ID初期値設定開始
type = varset
trigger1 = var(0) = 0
trigger1 = var(1) = 0
v = 1
value = 70+root,RoundsExisted*200

[state 30000]	;定期更新用ヘルパー射出
type=helper
trigger1 = NumHelper(51010)=0 && ishelper
trigger1 = roundstate<=2 && root,alive
helpertype=normal
name="Clear"
stateno=51010
ID=51010
pos=0,0
pausemovetime=2147483647
supermovetime=2147483647
persistent = 999

[state 30000]	;常駐ヘルパーの除外
type = varadd
trigger1 = var(0) = 0
trigger1 = var(1) > 0
trigger1 = !playerIDexist(var(1))
v = 1
value = -1

[state 30000]	;ID初期値確定フラグ
type = varadd
trigger1 = var(0) = 0
trigger1 = playerIDexist(var(1))
trigger1 = var(0):= 1
v = 1
value = 1

------------------------------ loop start -----------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

--------------------------------- loop --------------------------------------

[state 30000]	;ID登録(var(3)～var(22))
type = varset
trigger1 = var(0)=1
trigger1 = var(2)<20
trigger1 = playerIDexist(var(1))
v = 3+var(2)
value = var(1)

[state 30000]	;ID量把握
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 2
value = 1

[state 30000]	;許容値以上で最初へ
type = varset
trigger1 = var(0)=1
trigger1 = var(2)>=20
v = 2
value = 0

[state 30000]	;次のIDへ
type = varadd
trigger1 = var(0)=1
trigger1 = playerIDexist(var(1))
v = 1
value = 1

------------------------------- loop end ------------------------------------

[statedef 51010]
type     = A
movetype = I
physics  = N
ctrl     = 0
anim     = 20000

[State 10000,間違いで本体が来たら立ちへ移行]
type=selfstate
trigger1=!ishelper
value=0

[state 30000]
type = assertspecial
trigger1 = 1
flag = invisible
flag2 = noshadow

[state 30000]
type = Nothitby
trigger1 = 1
value = SCA

[state 30000]	;ID初期値設定開始
type = varset
trigger1 = var(30) = 0
trigger1 = var(31) = 0
v = 31
value = parent,var(1)+120+(parent,var(1)=58)*1000

[state 30000]	;既存ヘルパーの除外
type = varadd
trigger1 = var(30) = 0
trigger1 = var(31) > 0
trigger1 = !playerIDexist(var(31))
v = 31
value = -1

[state 30000]	;ID初期値確定フラグ
type = varadd
trigger1 = var(30) = 0
trigger1 = playerIDexist(var(31))
trigger1 = var(30):= 1
v = 31
value = 1

[state 30000]	;フィードバック
type = parentvarset
trigger1 = var(30) = 1
trigger1 = parent,var(1)<var(31)
v = 1
value = var(31)

[state 30000]	;消滅
type = destroyself
trigger1 = var(30) = 1
;-------------------------------------------------------------------------
;ステージ端計測用ヘルパー（厨忍氏より）
[Statedef 60000]
type=A
movetype=I
physics=N
ctrl=0
anim=20000;何も表示しないAnimなら、下記完全無敵と影消し、不可視化は不要
sprpriority=0
velset=10, 0;速度。projectileのものと同じにする

[State 9741, Safety];一応
type=selfstate
trigger1=!ishelper
value=0

[State -2];常時完全無敵
type=Nothitby
trigger1=1
value=SCA

[State 30000];画面にとらわれない
type=ScreenBound
trigger1=1
value=0
movecamera=0,0

[State 30000];判定用飛び道具射出
type=Projectile
trigger1=time=0
projID=30001
projanim=20000
velocity=10, 0;へルパーの初期速度と同じに
projpriority=4
projsprpriority=2
projstagebound=0;0がオススメ
projedgebound=99999
offset=0, 0
postype=right
supermovetime=99999
pausemovetime=99999
projremovetime=-1

[State -2];不可視化＆影消し。
type=assertspecial
trigger1=1
flag=noshadow
flag2=invisible
ignorehitpause=1

[State -2];飛び道具が消えたら停止。
type=velset
trigger1=!(root,numprojID(30001));ヘルパーが出したprojectileも本体管理になるので、「root,」を忘れないように
x=0
y=0

;-----------------------------------------------------------------------------
[Statedef 60010]
type=A
movetype=I
physics=N
ctrl=0
anim=20000;何も表示しないAnimなら、下記完全無敵と影消し、不可視化は不要
sprpriority=0
velset=10, 0;速度。projectileのものと同じにする

[State 9741, Safety];一応
type=selfstate
trigger1=!ishelper
value=0

[State -2];常時完全無敵
type=Nothitby
trigger1=1
value=SCA

[State 30000];画面にとらわれない
type=ScreenBound
trigger1=1
value=0
movecamera=0,0

[State 30000];判定用飛び道具射出
type=Projectile
trigger1=time=0
projID=30011
projanim=20000
velocity=10, 0;へルパーの初期速度と同じに
projpriority=4
projsprpriority=2
projstagebound=0;0がオススメ
projedgebound=99999
offset=0, 0
postype=reft
supermovetime=99999
pausemovetime=99999
projremovetime=-1

[State -2];不可視化＆影消し。
type=assertspecial
trigger1=1
flag=noshadow
flag2=invisible
ignorehitpause=1

[State -2];飛び道具が消えたら停止。
type=velset
trigger1=!(root,numprojID(30011));ヘルパーが出したprojectileも本体管理になるので、「root,」を忘れないように
x=0
y=0


;Alternate language victory quotes (optional).
;0 or more alternate language sections may be added, preceded by the
;ISO 639-1 code followed by a ".", e.g. "[ja.Quotes]".
;See language setting in mugen.cfg.
[ja.Quotes]
victory1 = "お前は敵を知らなすぎたようだな、\n勉強不足だ"
victory2 = "二度とあのみじめな\n花京院には戻らないッ！"
victory3 = "『 悪 』とは敗者のこと…\n負けたやつが『 悪 』なのだ"
victory4 = "いったはずだ…"
victory5 = "ぼくは自分を知っている…"
victory6 = "さぁ　おしおきの時間だ"
victory7 = "正義とは勝者のこと、過程は問題\nじゃない、負けたやつが悪なのだ"
;victory8 = "フン　おぞましいスタンドには\nおぞましい本体がついているものよ"
