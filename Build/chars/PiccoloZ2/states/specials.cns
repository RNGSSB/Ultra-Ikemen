;==============================================
; Special and EX moves
;============================================== 

;Sonic Kick
[Statedef 1000]
type    = S
movetype= A
physics = N
;juggle  = 7
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
facep2 = IsHelper 

[State 0, 4] 
type = ChangeState
triggerall = NumEnemy && RoundState = 2
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = Var(1) = 7
triggerall = StateNo != [35100,35106]
triggerall = !Time
trigger1 = Facing = root,Facing
value = 35100
ctrl = 0

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(9) = 0

[State 1402, VelSet]
type = VelSet
trigger1 = !moveguarded
trigger1 = animelemtime(3) >= 0 && animelemtime(12) <= 0
x = (16*exp((-0.208)*(time-10)))
[State 1402, VelSet]
type = VelSet
trigger1 = moveguarded
trigger1 = anim = 1050
trigger1 = animelemtime(4) <= 0
x = (4*exp((-0.208)*(time-10)))
[State 1402, VelSet]
type = VelSet
trigger1 = movehit
trigger1 = anim = 1001
trigger1 = animelemtime(5) <= 0
x = (6*exp((-0.208)*(time-10)))
[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1000 && animelem = 12
trigger2 = anim = 1001 && animelem = 5
trigger3 = anim = 1050 && animelem = 4
x = 0

[State 0, Explod]
type = Explod
trigger1 = !moveguarded
trigger1 = animelemtime(3) = 1
anim = 1002
ID = 1002
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = 1
vel = .1,0
sprpriority = 3
ownpal = 1
removeongethit = 0

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = MoveHit || MoveGuarded
trigger1 = Var(9) :=1
trigger1 = Var(9) = 1
trigger1 = animelemtime(3) >= 0 && animelemtime(12) <= 0
id = 1002

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 5,15
persistent = 0
[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 4,2
persistent = 0
[State 100, snd]
type = playsnd
trigger1 = Animelem = 4
value = 5,8
persistent = 0

[State 110y, Hit HK 3];wall bounce
type = HitDef
triggerall = !IsHelper
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676)
trigger1 = animelemtime(4) >= 0 && animelemtime(12) < 0
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,18,ceil(ifElse(fvar(11) * 35/fvar(19) < 7, 7, fvar(11) * 35))),0
pausetime = 12,14
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -75
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = Cond(Var(25)=1,0,-15),-4
guard.ctrltime = 8
air.velocity = Cond(Var(25)=1,0,-15),-4
fall = 1
fall.recover = 0
getpower = 0,0
givepower = 35,35
envshake.time = 16
envshake.freq = 60
envshake.ampl = 4
yaccel = 0.5
id = Cond((Enemy, MoveType = A || enemy, MoveType = H),1050,1054)
;p2stateno = ifelse(!var(12),1050,1054)    ;Make p2 go to bounce state on hit
p2facing = 1       ;Force to face p1
persistent = 0

[State 110y, Hit HK 3];wall bounce
type = HitDef
triggerall = IsHelper
triggerall = !NumTarget(1676)
trigger1 = animelemtime(4) >= 0 && animelemtime(12) < 0
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,18,ceil(ifElse(root,fvar(11) * 35/root,fvar(19) < 7, 7, root,fvar(11) * 35))),0
pausetime = 12,14
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -75
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-15),Cond((root, MoveType = A && Facing != root, Facing),-11.5,-4)
guard.ctrltime = 8
air.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-15),Cond((root, MoveType = A && Facing != root, Facing),-11.5,-4)
fall = 1
fall.recover = 0
getpower = 0,0
givepower = 35,35
envshake.time = 16
envshake.freq = 60
envshake.ampl = 4
yaccel = 0.5
id = Cond((Enemy, MoveType = A || enemy, MoveType = H),1050,1054)
;p2stateno = ifelse(!var(12),1050,1054)    ;Make p2 go to bounce state on hit
p2facing = 1       ;Force to face p1
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = MoveHit = 1
trigger1 = P2StateType = A
var(18) = 7
ignorehitpause = 1
persistent = 0

[State 0, Explod]
type = Explod
trigger1 = numtarget(1050) && movehit
anim = 1
ID = 1050
removetime = -1
removeongethit = 1

[State 0, TargetState]  ;New state
type = TargetState
trigger1 = Numtarget(1050)
trigger1 = movehit = 1
value = Cond(!NumExplod(1050),1050,1054)    ;Make p2 go to bounce state on hit
ID = 1050
ignorehitpause = 1
persistent = 0

[State 0, TargetState]  ;New state
type = TargetState
trigger1 = IsHelper; && Var(1) = 7
trigger1 = Numtarget(1050)
trigger1 = movehit = 1
value = 653   ;Make p2 go to bounce state on hit
ID = 1055
ignorehitpause = 1
persistent = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = moveguarded 
trigger1 = hitpausetime > 0
value = 1050
elem = 2
ignorehitpause = 1

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = movehit
value = 1001
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(12)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1
;------------------
; Hit by EX Hurricane Kick - shaking from the hit
[Statedef 1050]
type    = A
movetype= H
physics = N
velset = 0,0

[State 1555, Anim] ;Custom animation
type = ChangeAnim2
trigger1 = 1
value = 1051

[State 1555, State]
type = ChangeState
trigger1 = HitShakeOver = 1
value = stateno+1

;------------------
; Hit by EX Hurricane Kick - flying through the air
[Statedef 1051]
type = A
movetype = H
physics = N

[State 1556, Velocity]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 1556, Gravity]
type = VelAdd
trigger1 = time > 0
y = GetHitVar(yaccel)

[State 1323, Wallbounce ko] 
type = ChangeState
triggerall = !alive ;This would send them to the special ko state
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = 1323

[State 1556, Hit wall]
type = ChangeState
triggerall = alive
trigger1 = BackEdgeBodyDist <= 20
trigger2 = FrontEdgeBodyDist <= 20
value = stateno+1

[State 1556, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;------------------
; Hit by EX Hurricane Kick - hit wall
[Statedef 1052]
type    = A
movetype= H
physics = N

[State 1557, Turn]
type = Turn
trigger1 = (Time = 0) && (FrontEdgeBodyDist <= 30)

[State 1557, Pos]
type = PosAdd
trigger1 = Time = 0
x = 15 - BackEdgeBodyDist

[State 1557, Stop moving]
type = PosFreeze
trigger1 = 1
x = 1
y = 1

[State 1557, No scroll]
type = ScreenBound
trigger1 = 1
value = 1
movecamera = 0,1



[State 1557, Anim]
type = ChangeAnim2
trigger1 = Time = 0
value = 1052

[State 1557, State]
type = ChangeState
trigger1 = AnimTime = 0
value = stateno+1

;------------------
; Hit by EX Hurricane Kick - bounce off wall
[Statedef 1053]
type    = A
movetype= H
physics = N

[State 1558, Vel Y]
type = VelSet
trigger1 = Time = 0
y = -6

[State 1558, Vel X]
type = VelSet
trigger1 = Time = 0
x = 1.6


[State 1558, Gravity]
type = VelAdd
trigger1 = 1
y = .35

[State 1028, Anim 5050] ;Self falling animation
type = ChangeAnim
trigger1 = Time = 0
trigger1 = !SelfAnimExist(5052)
value = 5050

[State 1028, Anim 5052] ;Self falling animation (diagup type)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5052)
value = 5052

[State 1028, Anim 5060] ;Coming down - normal
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5050
trigger1 = SelfAnimExist(5060)
persistent = 0
value = 5060

[State 1028, Anim 5062] ;Coming down - diagup type
type = ChangeAnim
trigger1 = Vel Y > -2
trigger1 = Anim = 5052
trigger1 = SelfAnimExist(5062)
persistent = 0
value = 5062

[State 1028, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100

;-------------------------------------
;P2 custom state, sent away (bounce reset)
[Statedef 1054]
type = A
movetype = H
physics = N
anim = ifelse(selfanimexist(5052),5052,5030)
ctrl = 0
facep2 = 1

[State 4005, vel]
type = velset
trigger1 = animelemtime(2)=0
x = -10
y = -4
persistent = 0
 
[State 9011, VelAdd]
type = VelAdd
trigger1 = Pos Y < 0
y = 0.35
 
[State 9011, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
 
[State 1028, Hit ground]
type = SelfState
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 5100



;----------------------------------------
;Hyakuretsu Kyaku 
[Statedef 1100]
type    = A
movetype= A
physics = N
anim = 1100
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1101, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0
ignorehitpause = 1

[State 1101, VarSet]
type = VarSet
trigger1 = AILEVEL>0
trigger1 = !Time
var(35) = 41

[State 1101, VarSet]
type = VarSet
trigger1 = AILEVEL>0
trigger1 = random<300
var(35) = 1

[State 1102, VelAdd]
type = VelSet
trigger1 = animelem = 1
x = cond((Vel X!=0),ln(abs(Vel X)/2 + 1)*(abs(ceil(Vel X))/ceil(Vel X+.000000001)),0)
y = 0

[State 1103, VelAdd]
type = VelAdd
trigger1 = animelemtime(1) > 0
y = (const(movement.yaccel)/650)*time

[state 1215, Smoke FX]
type = explod
trigger1 = Pos Y >= -28
trigger1 = animelem = 2
anim = 10100+(var(2)=0)
id = 10100
pos = 0,-(ceil(Pos Y))
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 8
ignorehitpause = 1
scale = .8,.8

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 1 || !animtime
value = 5,14
channel = 0

[State 240, 1]
type = PlaySnd
trigger1 = animelem = 3 
value = 5,14
channel = 0

[State 440, 2]
type = HitDef
triggerall = !IsHelper
triggerall = Var(18) <= 55
trigger1 = AnimElem = 1 
trigger2 = !animtime
attr = A, SA
damage = Cond(IsHelper,3,ceil(ifElse(fvar(11) * 7/fvar(19) < 3, 3, fvar(11) * 7/fvar(19)))), 0 
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 4,10
guard.pausetime = 4,4
sparkno = s10020
guard.sparkno = s10000
sparkxy = -25,-55
hitsound   = s5,4
guardsound = S5,20
ground.type = Low
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = Cond(Var(25)=1,0,-3)
guard.velocity = Cond(Var(25)=1,0,-6)
air.velocity = Cond(Var(25)=1,0,-2),-2
down.velocity = Cond(Var(25)=1,0,-3),0
down.hittime = 20
getpower= ifelse(p2movetype=H,Cond(var(28)>=1||var(29)>=1,0,40),Cond(var(28)>=1||var(29)>=1,0,140)), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
fall.recover = 0
air.animtype = back
yaccel = 0.5
ID = 1100
fall = Var(41) >3

[State 440, 2]
type = HitDef
triggerall = !IsHelper
triggerall = Var(18) <= 55
trigger1 = AnimElem = 2
attr = A, SA
damage = Cond(IsHelper,3,ceil(ifElse(fvar(11) * 7/fvar(19) < 3, 3, fvar(11) * 7/fvar(19)))), 0 
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 4,10
guard.pausetime = 4,4
sparkno = s10020
guard.sparkno = s10000
sparkxy = -25,-80
hitsound   = s5,4
guardsound = S5,20
ground.type = High
air.type = Low
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = Cond(Var(25)=1,0,-3)
guard.velocity = Cond(Var(25)=1,0,-6)
air.velocity = Cond(Var(25)=1,0,-2),-2
down.velocity = Cond(Var(25)=1,0,-3),0
down.hittime = 20
getpower= ifelse(p2movetype=H,Cond(var(28)>=1||var(29)>=1,0,40),Cond(var(28)>=1||var(29)>=1,0,140)), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
fall.recover = 0
air.animtype = back
yaccel = 0.5
ID = 1101
fall = Var(41) >3

[State 640, 2]
type = HitDef
triggerall = !IsHelper
triggerall = Var(18) <= 55
trigger1 = AnimElem = 3
attr = A, NA
damage = Cond(IsHelper,3,ceil(ifElse(fvar(11) * 7/fvar(19) < 3, 3, fvar(11) * 7/fvar(19)))), 0 
guardflag = MA
hitflag = MAF
animtype  = Hard
priority = 4,Hit
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20,-86
hitsound   = s5,5
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = Cond(Var(25)=1,0,-5),-4
air.velocity = Cond(Var(25)=1,0,-5),-4
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
pausetime = 12,12
guard.pausetime = 12,12
getpower= ifelse(p2movetype=H,Cond(var(28)>=1||var(29)>=1,0,40),Cond(var(28)>=1||var(29)>=1,0,140)), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
ID = 1102
fall = 1
fall.recover = 0

[State 440, 2]
type = HitDef
triggerall = IsHelper
trigger1 = AnimElem = 1 
trigger2 = !animtime
attr = A, SA
damage = Cond(IsHelper,3,ceil(ifElse(root,fvar(11) * 7/root,fvar(19) < 3, 3, root,fvar(11) * 7/root,fvar(19)))), 0 
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 4,10
guard.pausetime = 4,4
sparkno = s10020
guard.sparkno = s10000
sparkxy = -25,-55
hitsound   = s5,4
guardsound = S5,20
ground.type = Low
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-3)  ;-4
guard.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-6)
air.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-2),-2
down.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-3),0
down.hittime = 20
getpower= 0,0;ifelse(p2movetype=H,40,140), 35
givepower = 35,35
fall.recover = 0
air.animtype = back
yaccel = 0.5
ID = 1100
fall = Var(41) >3

[State 440, 2]
type = HitDef
triggerall = IsHelper
trigger1 = AnimElem = 2
attr = A, SA
damage = Cond(IsHelper,3,ceil(ifElse(root,fvar(11) * 7/root,fvar(19) < 3, 3, root,fvar(11) * 7/root,fvar(19)))), 0 
animtype  = Medium
hitflag = MAFD
guardflag = MA
pausetime = 4,10
guard.pausetime = 4,4
sparkno = s10020
guard.sparkno = s10000
sparkxy = -25,-80
hitsound   = s5,4
guardsound = S5,20
ground.type = High
air.type = Low
ground.slidetime = 12;8
ground.hittime  = 12;8
ground.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-3)  ;-4
guard.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-6)
air.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-2),-2
down.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-3),0
down.hittime = 20
getpower= 0,0;ifelse(p2movetype=H,40,140), 35
givepower = 35,35
fall.recover = 0
air.animtype = back
yaccel = 0.5
ID = 1101
fall = Var(41) >3

[State 640, 2]
type = HitDef
triggerall = IsHelper
trigger1 = AnimElem = 3
attr = A, NA
damage = Cond(IsHelper,3,ceil(ifElse(root,fvar(11) * 7/root,fvar(19) < 3, 3, root,fvar(11) * 7/root,fvar(19)))), 0 
guardflag = MA
hitflag = MAF
animtype  = Hard
priority = 4,Hit
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20,-86
hitsound   = s5,5
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-5),-4
air.velocity = Cond((root, MoveType = A && Facing != root, Facing),0,-5),-4
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
pausetime = 12,12
guard.pausetime = 12,12
getpower= 0,0;ifelse(p2movetype=H,40,140), 35
givepower = 35,35
yaccel = 0.5
ID = 1102
fall = 1
fall.recover = 0

[State -2, EnvColor]
type = EnvColor
trigger1 = movehit
trigger1 = numtarget(1102)
value = 255,255,255
time = 1
under = 1
ignorehitpause = 1
persistent = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = NumTarget(1102)
var(35) = -1
ignorehitpause = 1

[State 800, VarAdd]
type = VarAdd
trigger1 = movecontact = 1
var(41) = 1

[State 0, Explod]
type = Explod
trigger1 = !NumExplod(300601)
anim = 1606
ID = 300601
pos = 0,0
postype = p1  ;p2,front,back,left,right
bindtime = -1
removetime = -1

[State 0, Explod]
type = Explod
trigger1 = !NumExplod(1100)
trigger1 = Var(41)=9
anim = 1
ID = 1100
removetime = -1
removeongethit = 1

[State 0, ChangeState]
type = ChangeState
triggerall = IsHelper
trigger1 = root,StateNo=1100
trigger1 = Var(1) = 5 || Var(1) = 7
trigger1 = root, Time = 1
trigger1 = Time>3
value = 1100

[State 0, ChangeState]
type = ChangeState
triggerall = IsHelper
triggerall = Var(1) = 6
trigger1 = Var(19)=0
value = 50

[State 0, ChangeState]
type = ChangeState
triggerall = IsHelper
triggerall = Var(1) != 6
trigger1 = root,StateNo != 1100
value = 50

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHit = 1
trigger1 = P2StateType = A
var(18) = ifelse(p2statetype=A,3,16)
persistent = 0

[State 1400, EndState]
type = ChangeState
triggerall = !IsHelper
trigger1 = var(35) <= 0 && AILEVEL=0
trigger2 = Var(41)=9
trigger3 = var(35) <= 0 && AILEVEL>0
trigger3 = Time >=20
value = 50
ctrl = 1

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = stateno+1 
;---------------------------
;Land
[Statedef 1101]
type = S
movetype = I
physics = S
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 47

[State 852, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = time >= 7
value = 1

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !time
value = 40, 0

[state 52, Land FX]
type = helper
trigger1 = !time
name = "LandFX"
stateno = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Halo Stomp 
[Statedef 1200]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
triggerall = !Ailevel
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250)||NumExplod(90000255),2,ifElse(NumExplod(90000240)||NumExplod(90000245),1,0))

[State 1000, VarSet]
type = VarSet
triggerall = AILEVEL >0
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse((P2BodyDist X >71),2,ifElse((P2BodyDist X =[30,70]),1,0))

[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)!=3
trigger1 = !time
var(41) = root,var(41)
[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)=3
trigger1 = !time
var(41) = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1200+(var(41))

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 5,15
persistent = 0

[State -2, Accel]
type = VelSet
trigger1 = animelem = 2
x = 11*sin((var(41)+1)*pi/12)
y = 11*cos((var(41)+1)*pi/12)

[State 0, PosAdd]
type = PosAdd
trigger1 = MoveHit=1
y = -30

[State 110a, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelemtime(3) >= 0 
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = 0,0
pausetime = 0,1
guard.pausetime = 10,10
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -54
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
guard.velocity = -12
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1200
p2facing = 1        ;Force to face p1
persistent = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 1
fall.recover=0

[State 0, TargetState]
type = TargetState
trigger1 = MoveHit=1
value = 1250
ID = -1
ignorehitpause = 1

[State 0, TargetBind]
type = TargetBind
trigger1 = MoveHit = 1
time = 1
id = 1200
pos = 30,30

[State 1000, 7]
type = ChangeState
trigger1 = movehit && numtarget(1200)
value = 1202
ignorehitpause = 0

[State 220,2]
type = ChangeState
trigger1 = MoveGuarded
value = 1203
ignorehitpause = 1
ctrl = 0

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = stateno+1 

;---------------------------
;Land
[Statedef 1201]
type = S
movetype = I
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 2

[State sd, PosAdd]
type = PosAdd
trigger1 = !time
x = 30*sin((var(41)+1)*pi/12);*cond(var(41)=2,2,1);36;*sin((var(41)+1)*pi/12)
persistent = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 47

[State 852, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = time >= 5+var(41)
value = 1

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !time
value = 40, 0

[state 52, Land FX]
type = helper
trigger1 = !time
name = "LandFX"
stateno = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Attack
[Statedef 1202]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = MoveHit = 1
fvar(13) = -2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1203

[State 1202, PlayerPush]
type = PlayerPush
trigger1 = stateno = 1202
value = 0
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1
value = 1200,0
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1
value = 1200,1
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1
value = 1200,2
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = 5,15
persistent = 0
[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 4,2
persistent = 0

[State 110b, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10/fvar(19) < 3, 3, fvar(11) * 10/fvar(19)))), Cond(IsHelper,0,1)
pausetime = 2,4
guard.pausetime = 2,4
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20, -46
hitsound = s5,4
guardsound = S5,20
p2facing = 1
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,7)),Cond(IsHelper,0,0)
givepower = 35,35
yaccel = 0.5
id = 1201
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 1
fall.recover=0
kill = 0

[State 110c, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 6
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10/fvar(19) < 3, 3, fvar(11) * 10/fvar(19)))), Cond(IsHelper,0,1)
pausetime = 2,4
guard.pausetime = 2,4
sparkno = s10030
guard.sparkno = s10000
sparkxy = -30, -74
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,7)),Cond(IsHelper,0,0)
givepower = 35,35
yaccel = 0.5
id = 1201
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
fall = 1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = animelem >= 7 && !movehit
value = 1250
ID = -1
ignorehitpause = 1
;persistent = 

[State 0, TargetBind]
type = TargetBind
trigger1 = 1
time = 5
id = 1201
pos = 30,30

[State 220,2]
type = ChangeState
trigger1 = time >= 36
value = stateno+1
ctrl = 0

;----------------------------------------
;Finish!
[Statedef 1203]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1207
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1207 && !animtime
value = 1205

[State 0, AttackDist]
type = AttackDist
trigger1 = anim = 1205
value = 0        ;I,A,H
ignorehitpause = 1
[State 1202, PlayerPush]
type = PlayerPush
trigger1 = anim = 1207
value = 0
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = anim = 1207 && animelem=1
value = 220,1
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = anim = 1207 && animelem=1
value = 220,5
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = anim = 1207 && animelem=1
value = 220,9
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = anim = 1207 &&AnimElem = 2
value = 5,15
persistent = 0
[State 250, 1]
type = PlaySnd
trigger1 = anim = 1207 && AnimElem = 1
value = 4,2
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Anim = 1205
value = 1205,0
persistent = 0

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelemtime(6) < 0
x = (const(velocity.runjump.back.x)*2*exp((-0.108)*(time-10)))
[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelem = 1
y = const(velocity.jump.y)+1
[State 110d, VelAdd]
type = VelAdd
trigger1 = anim = 1205
trigger1 = animelemtime(1) > 0
y = const(movement.yaccel)


[State 110e, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10/fvar(19) < 3, 3, fvar(11) * 10/fvar(19)))), Cond(IsHelper,0,1)
pausetime = 8,24
guard.pausetime = 12,14
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20, -46
hitsound = s5,4
guardsound = S5,20
p2facing = 1
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -5,-4
air.velocity = -5,-4
getpower = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,70)),Cond(IsHelper,0,0)
givepower = 35,35
yaccel = 0.5
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
id = 1203
fall = 1
fall.recover=0
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State -2, EnvColor]
type = EnvColor
trigger1 = movehit
trigger1 = numtarget(1203)
value = 255,255,255
time = 1
under = 1
ignorehitpause = 1
persistent = 0

[State 220,2]
type = ChangeState
trigger1 = anim = 1205
trigger1 = Vel Y + Pos Y >= 0
value = stateno+1
ctrl = 0

;---------------------------
;Land
[Statedef 1204]
type = S
movetype = I
physics = S
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 47

[State 852, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = time >= 10
value = 1

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !time
value = 40, 0

[state 52, Land FX]
type = helper
trigger1 = !time
name = "LandFX"
stateno = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Halo Stomp (EX)
[Statedef 1210]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
poweradd = Cond(IsHelper,0,-500)

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 3

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1201

[State 8000, flash]
type = PalFX
trigger1 = stateno = 1210
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 30
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 5,15
persistent = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = MoveHit=1
trigger1 = Pos Y >= -40
y = -30

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 4,2
persistent = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[State -2, Accel]
type = VelSet
trigger1 = animelem = 2
x = 13*sin(pi/6)
y = 11*cos(pi/6)

[State 110f, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelemtime(3) >= 0 
attr = S, SA
hitflag = MAF
guardflag = HA
animtype = Back
priority = 4, Hit
damage = 0,0
pausetime = 0,2
guard.pausetime = 10,10
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -54
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1200
p2facing = 1        ;Force to face p1
persistent = 0
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
fall = 1

[State 0, TargetState]
type = TargetState
trigger1 = MoveHit=1
value = 1250
ID = -1
ignorehitpause = 1


[State 0, TargetBind]
type = TargetBind
trigger1 = MoveHit = 1
time = 5
id = 1200
pos = 30,50

[State 1000, 7]
type = ChangeState
trigger1 = movehit && numtarget(1200)
value = 1212
ignorehitpause = 0

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = stateno+1 

;---------------------------
;Land
[Statedef 1211]
type = S
movetype = I
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 2

[State sd, PosAdd]
type = PosAdd
trigger1 = !time
x = 20*sin(pi/6)
persistent = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 47

[State 852, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = time >= 5
value = 1

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !time
value = 40, 0

[state 52, Land FX]
type = helper
trigger1 = !time
name = "LandFX"
stateno = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Attack
[Statedef 1212]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1204

[State 1202, PlayerPush]
type = PlayerPush
trigger1 = stateno = 1212
value = 0
ignorehitpause = 1

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1
value = 1200,0
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1
value = 1200,1
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1
value = 1200,2
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = 5,15
persistent = 0
[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 4,2
persistent = 0

[State 110g, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10 < 3, 3, fvar(11) * 10))), Cond(IsHelper,0,1)
pausetime = 0,10
guard.pausetime = 0,2
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20, -46
hitsound = s5,4
guardsound = S5,20
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1201
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
fall = 1

[State 110h, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 6
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10 < 3, 3, fvar(11) * 10))), Cond(IsHelper,0,1)
pausetime = 0,10
guard.pausetime = 0,2
sparkno = s10030
guard.sparkno = s10000
sparkxy = -30, -74
hitsound = s5,5
guardsound = S5,20
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1201
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
fall = 1

[State 0, TargetBind]
type = TargetBind
trigger1 = MoveHit = 1
time = 5
id = 1201
pos = 30,30

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = animelem >= 7 && !movehit
value = 1250
ID = -1
ignorehitpause = 1
;persistent = 

[State 220,2]
type = ChangeState
trigger1 = time >= 36
value = stateno+1
ctrl = 0

;----------------------------------------
;Attack. Finish
[Statedef 1213]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1206

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 1202, PlayerPush]
type = PlayerPush
trigger1 = stateno = 1213
value = 0
ignorehitpause = 1

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 2
trigger2 = animelem = 5
value = 5,15

[State 110i, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10 < 3, 3, fvar(11) * 10))), Cond(IsHelper,0,1)
pausetime = 0,10
guard.pausetime = 0,2
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20, -46
hitsound = s5,4
guardsound = S5,20
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1201
p2facing = 1        ;Force to face p1
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
fall = 1

[State 110j, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 6
attr = S, SA
hitflag = MAF
guardflag = MA
animtype = Back
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 10 < 3, 3, fvar(11) * 10))), Cond(IsHelper,0,1)
pausetime = 0,10
guard.pausetime = 0,2
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20, -46
hitsound = s5,4
guardsound = S5,20
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = 0,0
air.velocity = 0,0
getpower = 0,0
givepower = 35,35
yaccel = 0.5
id = 1202
p2facing = 1        ;Force to face p1
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
kill = 0
fall = 1

[State 0, TargetBind]
type = TargetBind
trigger1 = MoveHit = 1
time = 5
id = 1202
pos = 30,30

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = animelem >= 7 && !movehit
value = 1250
ID = -1
ignorehitpause = 1
;persistent = 


[State 220,2]
type = ChangeState
trigger1 = time >= 36
value = 1214+(NumExplod(90000008))
ctrl = 0

;----------------------------------------
;Hold '2' Finisher
[Statedef 1214]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1208
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1208 && !animtime
value = 1205

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Anim = 1205
value = 1205,0
persistent = 0

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = Anim = 1205
value = 0      
ignorehitpause = 1
[State 1202, PlayerPush]
type = PlayerPush
trigger1 = anim = 1208
value = 0
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = anim = 1208 && animelem=1
value = 220,1
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = anim = 1208 && animelem=1
value = 220,5
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = anim = 1208 && animelem=1
value = 220,9
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = anim = 1208 &&AnimElem = 2
value = 5,15
persistent = 0
[State 250, 1]
type = PlaySnd
trigger1 = anim = 1208 && AnimElem = 1
value = 4,2
persistent = 0

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelemtime(6) < 0
x = (const(velocity.runjump.back.x)*2.5*exp((-0.108)*(time-10)))
[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelem = 1
y = const(velocity.jump.y)+1
[State 110k, VelAdd]
type = VelAdd
trigger1 = anim = 1205
trigger1 = animelemtime(1) > 0
y = const(movement.yaccel)

[State 110L, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = diagup
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 30 < 20, 20, fvar(11) * 30))), Cond(IsHelper,0,1)
pausetime = 12,14
guard.pausetime = 12,14
sparkno = s10030
guard.sparkno = s10000
sparkxy = -30, -74
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -8,-4
air.velocity = -8,-4
getpower = 0,0
givepower = 35,35
yaccel = 0.5
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
id = 1203
fall = 1
fall.recover = 0
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0

[State 205, Time Offset]
type = VarSet
trigger1 = moveContact = 1
var(50) = Time
ignorehitpause = 1
persistent = 0

[State 205, Play Anim]
type = ChangeAnim
triggerall = AnimElemTime(4) <= 0
trigger1 = hitPauseTime = [1,12 - (2 - Var(50))]
value = anim
elem = 4
ignorehitpause = 1

[State -2, EnvColor]
type = EnvColor
trigger1 = movehit
trigger1 = numtarget(1203)
value = 255,255,255
time = 1
under = 1
ignorehitpause = 1
persistent = 0

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = animelem >= 7 && !movehit
value = 1250
ID = -1
ignorehitpause = 1
;persistent = 

[State 220,2]
type = ChangeState
trigger1 = anim = 1205
trigger1 = Vel Y + Pos Y >= 0
value = 1204
ctrl = 0

;----------------------------------------
;Hold '8' Finisher
[Statedef 1215]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 2
velset = 0,0
poweradd = 0

[State 0, VarAdd]
type = VarAdd
trigger1 = !Time
var(18) = 555

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1207
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1207 && !animtime
value = 1205

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Anim = 1205
value = 1205,0
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = Anim = 1205
value = 0  
ignorehitpause = 1

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelemtime(3) < 0
x = (const(velocity.jump.back.x)*exp((-0.108)*(time-11)))
[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1205
trigger1 = animelem = 1
y = const(velocity.jump.y)+1
[State 110m, VelAdd]
type = VelAdd
trigger1 = anim = 1205
trigger1 = animelemtime(1) > 0
y = const(movement.yaccel)

[State 1215, CtrlSet]
type = CtrlSet
trigger1 = anim = 1205 
trigger1 = animelem = 4
value = 1

[State 110n, Hit HK 3]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 3
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = hard
priority = 4, Hit
damage = Cond(IsHelper,5,ceil(ifElse(fvar(11) * 20 < 20, 20, fvar(11) * 20))), Cond(IsHelper,0,1)
pausetime = 8,14
guard.pausetime = 8,14
sparkno = s10030
guard.sparkno = s10000
sparkxy = -30, -74
hitsound = s5,5
guardsound = S5,20
p2facing = 1
ground.type = High
air.type = Low
ground.slidetime = 17
ground.hittime = 17
ground.velocity = -2.5
air.velocity = -6,-4
getpower = 0,0
givepower = 35,35
yaccel = 0.5
envshake.time = 12
envshake.freq = 60
envshake.ampl = 3
id = 1203
air.fall = 1
fall.recover = 0
p2facing = 1        ;Force to face p1
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0

;Following the same standards as the jump
[state veladd F]
type = veladd
triggerall = !AILEVEL
triggerall = (prevstateno = [10231,10233])
trigger1 = time > 8 && vel X< 4
trigger1 = (ifelse(Facing = 1, (NumExplod(90000009) || NumExplod(90000006) || NumExplod(90000003)),(NumExplod(90000007) || NumExplod(90000004) || NumExplod(90000001))))
x = 0.25

[state veladd]
type = veladd
triggerall = AILevel>0 && numenemy
triggerall = prevstateno = [10231,10233]
triggerall = time > 8 && vel X< 4
trigger1 = enemynear,Movetype!=A
x = Ifelse(enemynear,Movetype=H,0.5,0.25)

[state veladd R]
type = veladd
triggerall = !AILEVEL
triggerall = (prevstateno = [10231,10233])
trigger1 = time > 15 && vel X> -4
trigger1 = (ifelse(Facing = 1, (NumExplod(90000007) || NumExplod(90000004) || NumExplod(90000001)),(NumExplod(90000009) || NumExplod(90000006) || NumExplod(90000003))))
x = -0.1

[state veladd]
type = veladd
triggerall = AILevel>0
triggerall = prevstateno = [10231,10233]
trigger1 = time > 15 && vel X> -4
trigger1 = enemynear,Movetype=A
x = -0.1

[State 0, TargetState]
type = TargetState
triggerall = NumTarget
trigger1 = animelem >= 7 && !movehit
value = 1250
ID = -1
ignorehitpause = 1
;persistent = 

[State 220,2]
type = ChangeState
trigger1 = anim = 1205
trigger1 = Vel Y + Pos Y >= 0
value = 1204
ctrl = 0

;----------------------------------------
;Hit by
[Statedef 1250];Ok!
type    = A
movetype= H
physics = N
ctrl = 0
velset = 0,0

[State 3450, SelfState]
type = SelfState
trigger1 = statetype = A
value = 5000

[State 3105, StateTypeSet]
type = StateTypeSet
trigger1 = !time
statetype = S

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !HitShakeOver
value = 5002

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 5002 && !animtime
value = 5017

[State 3105, StateTypeSet]
type = StateTypeSet
trigger1 = Hitshakeover
statetype = S

[State 5001, 6]
type = SelfState
trigger1 = time = 50
value = 0
ctrl = 1


;---------------------------------------------------------------------------
;Focus Strike - charge state 1
;This state covers the charging aspect of the Focus Strike attack at the start.
[Statedef 1300]
type = S
movetype = I
physics = S
juggle = 10
anim = 1300
ctrl = 0
poweradd = 0
velset = 0,0

; These next two sctrls cover initial charge value and building it up
[State 900, starting value]
type = VarSet
trigger1 = !Time
fvar(9) = 0
 
[State 900, SA variable]
type = VarAdd
trigger1 = time
fvar(9) = 1

[State 8000, flash]
type = PalFX
trigger1 = time =10 
add = 40, 30, -40
sinadd = 50,50,50,16
time = 40
 
; These change states control dash cancels and moving into the attack portion
[State 900, dash cancel back]
type = ChangeState
trigger1 = time >= 8 && !AILevel && (ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90001064)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90001016)) && !AILevel
trigger2 = time >= 8 && AILevel>0 && numenemy && (enemynear,vel x>=1)
trigger3 = time >= 8 && AILevel>0 && numenemy && (P2Dist X >50) && P2MoveType = A && P2StateType = A
value = Cond(P2Dist X < -12, 100, 105)
 
[State 900, dash cancel forward]
type = ChangeState
trigger1 = time >= 8 && !AILevel && (ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90001016)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90001064)) && !AILevel
trigger2 = time >= 8 && AILevel>0 && numenemy && (enemynear,vel x<=1) 
value = Cond(P2Dist X < -12, 105, 100)
 
[State 900, stopping early]
type = ChangeState
trigger1 = !AILEVEL
trigger1 = time >= 8 
trigger1 = command != "holdc" || command != "holdz"
trigger2 = AILEVEL>0
trigger2 = time >= 8 
trigger2 = (P2Dist X =[-10,50]) && (P2Dist Y =[-30,50])
value = 1302
 
[State 900, fully charged]
type = ChangeState
trigger1 = fvar(9)>=60
value = 1302
 
;---------------------------------------------
;Focus Strike - charge state 2
;This state covers the charging aspect of the Focus Strike attack if hit
[Statedef 1301]
type = S
movetype = I
physics = S
juggle = 10
ctrl = 0
poweradd = 0
velset = 0,0
 
; This part covers the after effects of getting hit from earlier.
[state 901, no more saving hit] ;???????????????????????
type = varset
trigger1 = time = 1
var(20) = 0

[State 8000, flash]
type = PalFX
trigger1 = time =0
add = 40, 30, -40
sinadd = 50,50,50,16
time = 10
 
[State 901, life removal]
type = LifeAdd
trigger1 = time = 1 && !var(20) ;lel
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950
 
; This ctrl changes the animframe back to the last active one
[State 901, ChangeAnim]
type = ChangeAnim
trigger1 = time = 0
value = 1300
elem = var(23)
 
; This varset is the continuation of charging
[State 901, adding to charge]
type = VarAdd
trigger1 = time
fvar(9) = 1
 
; These change states control dash cancels and moving into the attack portion
[State 900, dash cancel back]
type = ChangeState
trigger1 = time >= 8 && !AILevel && (ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90001064)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90001016)) && !AILevel
trigger2 = time >= 8 && AILevel>0 && numenemy && (enemynear,vel x>=1)
trigger3 = time >= 8 && AILevel>0 && numenemy && (P2Dist X >50) && P2MoveType = A && P2StateType = A
value = Cond(P2Dist X < -12, 100, 105)
 
[State 900, dash cancel forward]
type = ChangeState
trigger1 = time >= 8 && !AILevel && (ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90001016)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90001064)) && !AILevel
trigger2 = time >= 8 && AILevel>0 && numenemy && (enemynear,vel x<=1) 
value = Cond(P2Dist X < -12, 105, 100)

[State 900, stopping early]
type = ChangeState
trigger1 = !AILEVEL
trigger1 = time >= 8 
trigger1 = command != "holdc" || command != "holdz"
trigger2 = AILEVEL>0
trigger2 = time >= 8 
value = 1302
 
[State 901, fully charged]
type = ChangeState
trigger1 = fvar(9)>=60
value = 1302
 
;----------------------------------------
;Focus Attack - actual attack
[Statedef 1302]
type = S
movetype = A
physics = S
juggle = 10
anim = 1301
ctrl = 0
velset = 0,0
 
[state 901, cancel earlier fx flash]
type = PalFx
trigger1 = time = 0
add = 0,0,0
time = 0
 [state 901, bright flash if maxed out]
type = PalFx
triggerall = FVar(9) = 60
trigger1 = time = 0
add = 128,128,128
sinadd = -128,-128,-128,32
time = 8
ignorehitpause = 1

[State 1302, 2]
type = PlaySnd
trigger1 = AnimElem = 2 && (FVar(9) < 60)
value = 5,12

[State 1302, 2]
type = PlaySnd
trigger1 = AnimElem = 2 && (FVar(9) = 60)
value = 5,12

[State 4000, Invincible]
type = NotHitBy
trigger1 = animelemtime(1) >= 0 && animelemtime(4) < 0
value = ,NP, SP

[State 1300, repel helper]
type = helper
trigger1 = animelem = 1
stateno = 1305
ID = 1305
name = "repel"
postype = p1
pos = 70, -60
persistent = 0

[state 1215, Smoke FX]
type = explod
trigger1 = animelemtime(3)=1
anim = 1218;+(var(2)=0)
id = 1206
pos = 0,0  ;30,0
postype = P1
sprpriority = -3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1

[State 205, Time Offset]
type = VarSet
trigger1 = moveContact = 1
var(50) = Time
ignorehitpause = 1
persistent = 0

[State 205, Play Anim]
type = ChangeAnim
triggerall = AnimElemTime(5) <= 0
trigger1 = hitPauseTime = [1,9 - (8 - Var(50))]
value = anim
elem = 5
ignorehitpause = 1

;; The hitdef used depends on the how long you've been charging. In case you are wondering why there are 2 versions of each lvl's
; hitdef, the second one has been refined to compensate for hitting air opponents.
; LV 1
[State 902, 0-30]
type = HitDef
triggerall = P2stateno != [5020,5040]
triggerall = p2stateno != [154,155]
trigger1 = AnimElem = 2 && (FVar(9) < 60)
attr = S, NA
damage = 32,0
animtype = Hard
guardflag = M
hitflag = M
priority = 4, Hit
pausetime = 9, 9
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-73
hitsound   = s2, 1
guardsound = S5,21
ground.type = Low
ground.slidetime = 12  ;14
ground.hittime  = 12   ;14
ground.velocity = -8.95
guard.slidetime = 18
guard.hittime = 18
guard.ctrltime = 6
airguard.velocity = -3.5,-4
air.type = High
air.velocity = -3.5,-6
air.hittime = 9
getpower = Cond(var(28)>=1||var(29)>=1,0,101),Cond(var(28)>=1||var(29)>=1,0,101)
givepower = 35,35
ground.cornerpush.veloff = -7.25
air.cornerpush.veloff = 0
yaccel = .55
air.fall = 1
air.juggle = 15
fall = (p2movetype=H)
 
[State 902, 0-30]
type = HitDef
triggerall = P2stateno != [5020,5040]
triggerall = p2stateno != [154,155]
triggerall = p2statetype = A
trigger1 = AnimElem = 2 && (FVar(9) < 60)
attr = S, NA
damage= 32,0
animtype = Hard
guardflag = A
hitflag = A
priority = 4, Hit
pausetime = 9, 9
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-73
hitsound   = s2, 1
guardsound = S5,21
ground.type = Low
ground.slidetime = 12  ;14
ground.hittime  = 12   ;14
ground.velocity = -6.95
guard.slidetime = 18
guard.hittime = 18
guard.ctrltime = 6
airguard.velocity = -3.5,-4
air.type = High
air.velocity = -3.5,-6
air.hittime = 9
getpower = Cond(var(28)>=1||var(29)>=1,0,101),Cond(var(28)>=1||var(29)>=1,0,101)
givepower = 35,35
ground.cornerpush.veloff = -7.25
air.cornerpush.veloff = 0
yaccel = .55
air.fall = 1
air.juggle = 15
fall = (p2movetype=H)
 
;LV 2 MAX 1-limiter
[State 902, max-charge] 
type = HitDef 
triggerall = P2stateno != [5020,5040]
triggerall = p2stateno != [154,155]
triggerall = ifelse(enemy,time <= 10,enemy, prevstateno != 5300,1) ;Checks if the opponent has been in the dizzy state for the past 10 ticks 
triggerall = p2stateno != 5300 ;Checks if the opponent is in the dizzy state
trigger1 = AnimElem = 2 && FVar(9) = 60
attr = S, NA
damage = 59,0
animtype = Hard
;guardflag = MA ;<-- Commented out as you will not be blocking this. This will hurt, and you will fall!
hitflag = MAF
priority = 4, Hit
pausetime = 14, 14
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-73
hitsound   = s2, 1
guardsound = S5,21
ground.type = Low
ground.slidetime = 20  ;14
ground.hittime  = 20   ;14
ground.velocity = -4.95
guard.slidetime = 18
guard.hittime = 18
guard.ctrltime = 6
airguard.velocity = -3.5,-4
air.type = High
air.velocity = -3.5,-6
air.hittime = 9
getpower = Cond(var(28)>=1||var(29)>=1,0,101),Cond(var(28)>=1||var(29)>=1,0,101)
givepower = 35,35
ground.cornerpush.veloff = -7.25
air.cornerpush.veloff = 0
yaccel = .55
;p2stateno = 1320 ; <- Opponent sent to flying state
ID = 1302
 
; LV 2 MAX
[State 902, max-charge]
type = HitDef
triggerall = AnimElem = 2 && FVar(9) = 60
trigger1 = p2stateno = 5300 ;Checks if the opponent is in the dizzy state
trigger2 = ifelse(enemy,time <= 10,enemy, prevstateno = 5300,0)
trigger3 = NumExplod(1302)
trigger4 = P2MoveType = H 
attr = S, NA
damage = 59,0
animtype = Hard
;guardflag = MA ;<-- Commented out as you will not be blocking this. This will hurt, and you will fall!
hitflag = MAF
priority = 4, Hit
pausetime = 14, 14
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-73
hitsound   = s2, 1
guardsound = S5,21
ground.type = Low
ground.slidetime = 20  ;14
ground.hittime  = 20   ;14
ground.velocity = -4.95
guard.slidetime = 18
guard.hittime = 18
guard.ctrltime = 6
airguard.velocity = -3.5,-4
air.type = High
air.velocity = -3.5,-6
air.hittime = 9
getpower = Cond(var(28)>=1||var(29)>=1,0,101),Cond(var(28)>=1||var(29)>=1,0,101)
givepower = 35,35
ground.cornerpush.veloff = -7.25
air.cornerpush.veloff = 0
yaccel = .55
air.fall = 1
air.juggle = 15
;p2stateno = 1320 ; <- Opponent sent to flying state
ID = 1322

[State 1302, TargetState]  ;Limiter state
type = TargetState
triggerall = Numtarget(1322)
trigger1 = movehit = 1
value = 1322
ID = 1322
ignorehitpause = 1
persistent = 0
 
[State 1302, TargetState]  ;New state
type = TargetState
triggerall = Numtarget(1302)
trigger1 = movehit = 1
value = 1320
ID = 1302
ignorehitpause = 1
persistent = 0
 
;Focus Limiter 2 Limiter
[State 0, Explod]
type = Explod
trigger1 = !NumExplod(1302)
trigger1 = NumTarget(1302)
anim = 1
ID = 1302
removetime = -1
removeongethit = 1
ignorehitpause = 1
 
[State 902, fvar reset]
type = VarSet
trigger1 = !AnimTime
fvar(9) = 0

[State 205, Time Offset]
type = VarSet
trigger1 = moveContact = 1
var(50) = Time
ignorehitpause = 1
persistent = 0

[State 205, Play Anim]
type = ChangeAnim
triggerall = (FVar(9) < 60)
triggerall = AnimElemTime(2) <= 0
trigger1 = hitPauseTime = [1,9 - (3 - Var(50))]
value = anim
elem = 2
ignorehitpause = 1
[State 205, Play Anim]
type = ChangeAnim
triggerall = FVar(9) = 60
triggerall = AnimElemTime(2) <= 0
trigger1 = hitPauseTime = [1,14 - (3 - Var(50))]
value = anim
elem = 2
ignorehitpause = 1

;Dash Cancels upon movecontact
[State 1302, dash cancel backward]
type = ChangeState
trigger1 = !AILevel
trigger1 = Movecontact 
trigger1 = (ifElse(P2Dist x < -12, Facing = -1, Facing = 1) && NumExplod(90001016)) || (ifElse(P2Dist x < -12, Facing = 1, Facing = -1) && NumExplod(90001064))
trigger2 = AILevel>=1 && movecontact && random<150
value = Cond(P2Dist X < -12, 105, 100)
ignorehitpause = 1

[State 1302, dash cancel forward]
type = ChangeState
trigger1 = !AILevel
trigger1 = MoveContact
trigger1 = (ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90001064)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90001016))
trigger2 = AILevel>=1 && movecontact && random<150
value = Cond(P2Dist X < -12, 100, 105)
ignorehitpause = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Micro Wave
[Statedef 1350]
type    = S
movetype= A
physics = N
;juggle  = 7
velset = 0,0
anim = 1350
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000220)||NumExplod(90000225),2,ifElse(NumExplod(90000210)||NumExplod(90000215),1,0))

[State 1000, VarSet]
type = VarSet
triggerall = AILEVEL>0
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse((P2BodyDist X >110),2,ifElse((P2BodyDist X =[70,109]),1,0))

[State 1000, VarSet]
type = Varset
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = var(1)<5
trigger1 = !time
var(41) = 0 + Random%3
[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)!=3
triggerall = var(1)>=5
trigger1 = !time
var(41) = root,var(41)
[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)=3
triggerall = var(1)>=5
trigger1 = !time
var(41) = 1

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1350+(var(41))

[State 0, ChangeState]
type = ChangeState
triggerall = !AILEVEL
triggerall = statetype != A && !WinKo 
triggerall = !IsHelper
triggerall =  power >= 2000 && Var(52) <=0  || Var(52) >= 1 && Var(42) = 0 || power >= 2000 && Var(52) >0 && Var(42) = 1
triggerall = !NumHelper(3310) 
triggerall = ((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90010006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90010104)))
triggerall = (ifElse(NumExplod(90000200), 1, 0) + ifElse(NumExplod(90000210), 1, 0) + ifElse(NumExplod(90000220), 1, 0) >= 2) || (ifElse(NumExplod(90000205), 1, 0) + ifElse(NumExplod(90000215), 1, 0) + ifElse(NumExplod(90000225), 1, 0) >= 2)
trigger1 = NumProjID(1350) 
value =3300
[State 0, ChangeState]
type = ChangeState
triggerall = !AILEVEL
triggerall = statetype != A && !WinKo 
triggerall = !IsHelper
triggerall = power >= 1000 
triggerall = ((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90010006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90010104)))
triggerall = NumExplod(90000200) || NumExplod(90000205) || NumExplod(90000210) || NumExplod(90000215) || NumExplod(90000220) || NumExplod(90000225)
trigger1 = NumProjID(1350) 
value =3200
[State 0, ChangeState]
type = null;ChangeState
triggerall = !AILEVEL
triggerall = statetype != A && !WinKo 
triggerall = !IsHelper
triggerall = Var(52) >=1 && Var(53) >= 700 && Var(42) = 0
triggerall = ((ifElse(P2DisT x < -12, Facing = -1, Facing = 1) && NumExplod(90010006)) || (ifElse(P2DisT x < -12, Facing = 1, Facing = -1) && NumExplod(90010104)))
triggerall = NumExplod(90000200) || NumExplod(90000205) || NumExplod(90000210) || NumExplod(90000215) || NumExplod(90000220) || NumExplod(90000225)
trigger1 = NumProjID(1350) 
value =3250


[State 1402, VelSet]
type = VelSet
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) >= 0 && animelemtime(9+cond(var(41)=2,3,var(41)*2)) < 2
x = -((5+var(41))*exp((-0.208)*(time-14-cond(var(41)=2,6,var(41)*2))))

[State 1350, NotHitBy]
type = NotHitBy
trigger1 = var(41) = 2
trigger1 = animelemtime(4) < 0
value = ,AP
time = 1

[state 1215, Smoke FX]
type = explod
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
anim = 10100+(var(2)=0)
id = 10100
pos = 0,5
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 8
ignorehitpause = 1
scale = .8,.8

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
value = 1350,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
value = 1350,(10+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
value = 1350,(20+random%2)
channel = 0

[State 100, snd]
type = playsnd
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
value = 5,8
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 2
id = 1355
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1355
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 1350, EnvShake]
type = EnvShake
trigger1 = animelemtime(6+cond(var(41)=2,3,var(41)*2)) = 0
time = 10
freq = 180
ampl = -6

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Micro Wave (EX)
[Statedef 1351]
type    = S
movetype= A
physics = N
;juggle  = 7
velset = 0,0
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,-500)

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 3

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 240

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1353

[State 1402, VelSet]
type = VelSet
trigger1 = animelemtime(7) >= 0 && animelemtime(10) < 2
x = -(6*exp((-0.208)*(time-15)))

[State 1350, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(1) >= 2 && animelemtime(7) < 0
value = SCA
time = 1

[State 8000, flash]
type = PalFX
trigger1 = stateno = 1351
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 30
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem= 7
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem= 7
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem= 7
value = 1350,(20+random%2)
channel = 0
persistent = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[state 1215, Smoke FX]
type = explod
trigger1 = animelem = 7
anim = 10100+(var(2)=0)
id = 10100
pos = 0,5
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 8
ignorehitpause = 1
scale = .8,.8

[State 100, snd]
type = playsnd
trigger1 = Animelem = 7
value = 5,8
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 2
id = 1357
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1357
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 1350, EnvShake]
type = EnvShake
trigger1 = animelem = 7
time = 10
freq = 180
ampl = -6

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Micro Wave (EX)
[Statedef 1352]
type    = S
movetype= A
physics = N
;juggle  = 7
velset = 0,0
ctrl = 0
sprpriority = 2
poweradd = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75


[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1353

[State 1402, VelSet]
type = VelSet
trigger1 = animelemtime(7) >= 0 && animelemtime(10) < 2
x = -(6*exp((-0.208)*(time-15)))

[State 1350, NotHitBy]
type = NotHitBy
trigger1 = animelemtime(1) >= 2 && animelemtime(7) < 0
value = SCA
time = 1

[State 8000, flash]
type = PalFX
trigger1 = stateno = 1352
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 30
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem= 7
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem= 7
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem= 7
value = 1350,(20+random%2)
channel = 0
persistent = 0


[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[state 1215, Smoke FX]
type = explod
trigger1 = animelem = 7
anim = 10100+(var(2)=0)
id = 10100
pos = 0,5
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 8
ignorehitpause = 1
scale = .8,.8

[State 100, snd]
type = playsnd
trigger1 = Animelem = 7
value = 5,8
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 2
id = 1357
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1357
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 1350, EnvShake]
type = EnvShake
trigger1 = animelem = 7
time = 10
freq = 180
ampl = -6

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Gethits
; Z2 Airslide
[Statedef 1360]
type    = S
movetype= H
physics = N
velset = 0,0

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)
[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = !time
;trigger1 = !selfanimexist(5937)
trigger1 = GetHitVar(animtype) = [3,5]
value = cond(selfanimexist(5937),5937,5030)


[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
;trigger1 = !selfanimexist(5937)
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 || GetHitVar(fall)
trigger2 = Pos Y != 0
statetype = a

[State 5000, 6]
type = SelfState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0 && !GetHitVar(fall)
value = 5001 ;Stand get-hit (knocked back)

[State 5000, 7]
type = ChangeState
trigger1 = HitShakeOver
value = stateno+1

;---------------------------------------------------------------------------
; Air slide get-hit (AIRTIME) (KOF)
[Statedef 1361]
type    = A
movetype= H
physics = N
ctrl = 0

[State 10070, NotHitBy]
type = NotHitBy
trigger1 = enemy,numhelper(3501)=0||enemy,numhelper(3502)=0&&enemy,authorname="Piccolo Z2"
trigger1 = time >=0
value = SCA
time = 1

[State 5030, 1]
type = ChangeAnim
trigger1 = anim != 1360 && anim != 5937
trigger1 = Anim != [5000, 5199]
trigger1 = SelfAnimExist(5030)
value = 5030

[State 5030, 3]
type = VelSet
trigger1 = Time = 0
x = -5
y = -8

[State 3030, VelMul]
type = VelAdd
trigger1 = time > 0
y = GetHitVar(yaccel)

[State 5030, 4]
type = SelfState
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10;Const(movement.air.gethit.groundlevel)
value = 5040 ;HITA_RECOV

[State 5030, 5]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10;Const(movement.air.gethit.groundlevel)
value = 1363 ;HITA_FALL

[State 5030, 6]
type = ChangeState
trigger1 = AnimTime = 0
value = stateno+1 ;Air get-hit (transition)

;---------------------------------------------------------------------------
; Air get-hit (transition)
[Statedef 1362]
type    = A
movetype= H
physics = N

[State 5035, 1]
type = ChangeAnim
trigger1 = anim != 1360 && anim != 5937
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5035, 2]
type = VelAdd
trigger1 = time > 0
y = GetHitVar(yaccel)

[State -2, Explod];State 5052 Twist FX
type = playsnd
trigger1 = anim=1360 && !(gametime%10) && animelemtime(4)>=0
value = 5052,0

[State 5035, 3]
type = SelfState
triggerall = !HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= Const(movement.air.gethit.groundlevel)
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5040 ;Air get-hit (recovering in air, not falling)

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= Const(movement.air.gethit.groundlevel)
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = stateno+1 ;Air get-hit (falling)

;---------------------------------------------------------------------------
; Air get-hit (falling) (KOF)
[Statedef 1363]
type    = A
movetype= H
physics = N

[State 10070, NotHitBy]
type = NotHitBy
trigger1 = enemy,numhelper(3501)=0||enemy,numhelper(3502)=0&&enemy,authorname="Piccolo Z2"
trigger1 = time >=0
value = SCA
time = 1

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
triggerall = anim != 1360
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
triggerall = anim != 1360
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2);ifelse(anim = 5050, Const720p(4), Const720p(-8))
trigger1 = SelfAnimExist(anim+10)
value = 5060
persistent = 0

[State 105, 1]
type = VelSet
trigger1 = numenemy
x = ifelse((facing=enemynear,facing),1,-1)*(abs(gethitvar(xvel))*exp((-0.01574835696813916860754951146083)*(time)))

[State 3030, VelMul]
type = VelAdd
trigger1 = time > 0 
y = GetHitVar(yaccel)

[State -2, Explod];State 5052 Twist FX
type = playsnd
trigger1 = anim=1360 && !(gametime%10) && animelemtime(4)>=0
value = 5052,0

[State 5050, 6]
type = ChangeState;SelfState;
trigger1 = Vel Y + Pos Y >=0
value = stateno+1 ;Downed get-hit (hit ground from fall)5100;

;---------------------------------------------------------------------------
; HIT_BOUNCE (hit ground)
[Statedef 1364]
type    = L
movetype= H
physics = N

[State 3030, VelMul]
type = VelSet
triggerall = numenemy
trigger1 = time = 1 
x = ifelse((facing=enemynear,facing),7,-7)
[State 3030, VelMul]
type = VelMul
trigger1 = time > 0 
x = 0.90625

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim2
trigger1 = GetHitVar(animtype) = [3,5]
trigger1 = !time
trigger2 = (GetHitVar(animtype) = [4,5]) 
trigger2 = !SelfAnimExist(5161) 
trigger2 = !time
value = 1361

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = Name = "cvsfelicia" && authorname = "Jesuszilla"
trigger1 = !time
value = 5100

[State 811]
type = posset
trigger1 = !time
y = 0

[State 811]
type = posset
trigger1 = (GetHitVar(animtype) = [4,5]) 
trigger1 = SelfAnimExist(5101)
trigger1 = SelfAnimExist(5161)
Trigger1 = Time = 9
y = 20

[State 811]
type = posset
trigger1 = SelfAnimExist(5101)
trigger1 = SelfAnimExist(5161)
trigger1 = time = 17
y = 0

[State 1505, Anim 5050] 
type = ChangeAnim
Trigger1 = !Time
trigger1 = (GetHitVar(animtype) = [4,5]) 
trigger1 = SelfAnimExist(5101)
trigger1 = SelfAnimExist(5161)
value = 5101

[State 1505, Anim 5050] 
type = ChangeAnim
triggerall = anim = 5101
Trigger1 = Time = 9
trigger1 = SelfAnimExist(5161)
trigger1 = SelfAnimExist(5111)
value = 5161

[State 700,0]
type = ChangeAnim
triggerall = anim = 5101
trigger1 = time < 17
value = anim

[State 1505, Anim 5050] 
type = ChangeAnim
triggerall = anim = 5161
Trigger1 = Time = 17
trigger1 = SelfAnimExist(5111)
value = 5111

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 7]
type = ChangeState
trigger1 = Time = 20
value = stateno+1 ;HIT_LIEDOWN

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 1365]
type    = L
movetype= H
physics = N
velset = 0,0



;[State 10070, NotHitBy]
;type = NotHitBy
;trigger1 = 1
;value = SCA
;time = 1

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = SelfState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 11] ;If just died
type = SelfState
trigger1 = time = 9
value = 5120

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

;----------------------------------------
;Micro Wave (AIR)
[Statedef 1370]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 1000, VarSet]
type = VarSet
triggerall = !Ailevel
triggerall = !Ishelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000220)||NumExplod(90000225),2,ifElse(NumExplod(90000210)||NumExplod(90000215),1,0))

[State 1000, Varrandom]
type = Varrandom
triggerall = AILEVEL>0
triggerall = !IsHelper
trigger1 = !time
v=41
range = 0,2
[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)!=3
trigger1 = !time
var(41) = root,var(41)

[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
triggerall = root,var(41)=3
trigger1 = !time
var(41) = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1370+(var(41))
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1370+(var(41))
trigger1 = animtime = 0
value = 46

[State 0, VelSet]
type = null;VelSet
trigger1 = prevstateno = 1500 || prevstateno = 1510 || prevstateno = 1520
trigger1 = !Time
x = 2
y = -2

[State 0, VelSet]
type = null;VelSet
trigger1 = prevstateno = 1500 || prevstateno = 1510 || prevstateno = 1520
trigger1 = Time = 10
x = 0
y = 0

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) >= 0 && animelemtime(8+var(41)) < 2
x = -((8+var(41))*exp((-0.208)*(time-12-var(41)*2)))
[State -2, Accel]
type = VelSet
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) = 0
y = -8*sin(pi/3)
[State 1370, VelAdd]
type = VelAdd
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) > 0
trigger2 = anim = 46
y = const(movement.yaccel)

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(20+random%2)
channel = 0
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 3
id = 1375
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1375
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = stateno+1 

;----------------------------------------
;Clone Micro Wave (AIR)
[Statedef 1395]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1370+(var(41))
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1370+(var(41))
trigger1 = animtime = 0
value = 46

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) >= 0 && animelemtime(8+var(41)) < 2
x = -((8+var(41))*exp((-0.208)*(time-12-var(41)*2)))
[State -2, Accel]
type = VelSet
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) = 0
y = -8*sin(pi/3)
[State 1370, VelAdd]
type = VelAdd
trigger1 = anim = 1370+(var(41))
trigger1 = animelemtime(6+var(41)) > 0
trigger2 = anim = 46
y = const(movement.yaccel)

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(6+var(41)) = 0
value = 1350,(20+random%2)
channel = 0
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 3
id = 1396
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1396
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = 1371
;---------------------------
;Land
[Statedef 1371]
type = S
movetype = I
physics = N
poweradd= 0
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 47

[State 852, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = IsHelper(3501) || IsHelper(3502)
trigger1 = time >= 5+2
value = 0

[State 1101, CtrlSet]
type = CtrlSet
trigger1 = !IsHelper
trigger1 = time >= 5+2
value = 1

[State -3, Landing Sound]
type = PlaySnd
trigger1 = !time
value = 40, 0

[state 52, Land FX]
type = helper
trigger1 = !time
name = "LandFX"
stateno = 17100
id = 17100
postype = P1
ownpal = 1
keyctrl = 0
supermovetime = 99999
pausemovetime = 99999

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Micro Wave (EX) (AIR)
[Statedef 1372]
type    = A
movetype= A
physics = N
ctrl = 0
velset = 0,0
sprpriority = 2
poweradd = -500

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75


[State 1000, VarSet]
type = VarSet
triggerall = !ishelper
trigger1 = !time
var(41) = 3

[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = !time
value = 1373
[State 1000, ChangeAnim]
type = ChangeAnim
trigger1 = anim = 1373
trigger1 = animtime = 0
value = 46

[State 0, CtrlSet]
type = CtrlSet
trigger1 = Anim = 1373
trigger1 = AnimElem = 9
value = 1

[State 1350, NotHitBy]
type = NotHitBy
trigger1 = anim = 1373
trigger1 = animelemtime(1) >= 2 && animelemtime(6) < 0
value = SCA
time = 1

[State 8000, flash]
type = PalFX
trigger1 = stateno = 1372
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 30
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[State 0, VelSet]
type = null;VelSet
trigger1 = prevstateno = 1500 || prevstateno = 1510 || prevstateno = 1520
trigger1 = !Time
x = 2
y = -2

[State 0, VelSet]
type = null;VelSet
trigger1 = prevstateno = 1500 || prevstateno = 1510 || prevstateno = 1520
trigger1 = Time = 10
x = 0
y = 0

[State 1402, VelSet]
type = VelSet
trigger1 = anim = 1373
trigger1 = animelemtime(6) >= 0 && animelemtime(8) < 2
x = -((8+var(41))*exp((-0.208)*(time-11)))
[State -2, Accel]
type = VelSet
trigger1 = anim = 1373
trigger1 = animelemtime(6) = 0
y = -8*sin(pi/3)
[State 1370, VelAdd]
type = VelAdd
trigger1 = anim = 1373
trigger1 = animelemtime(6) > 0
trigger2 = anim = 46
y = const(movement.yaccel)

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(6) = 0
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(6) = 0
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(6) = 0
value = 1350,(20+random%2)
channel = 0
persistent = 0

[State 1000: Helper]
type = helper
trigger1 = animelem = 3
id = 1377
pos = 0,0 ;50
postype = p1
facing = 1
stateno = 1377
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
persistent = 0

[State 3052, Land]
type = changestate
trigger1 = Vel Y + Pos Y >= 0
value = 1371 



;----------------------------------------
;Mentaru Shoujo
[Statedef 1400]
type = S
physics = S
movetype = A
anim = 1400
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd =0; Cond(IsHelper,0,-500)

[State 0, ChangeState]
type = ChangeState
trigger1 = IsHelper
value =1410
ctrl = 0
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 8000, flash]
type = PalFX
triggerall = !Ishelper
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
triggerall = !Ishelper
trigger1 = !time
time = 30
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = 1
channel = 19

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 8051

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = time = 1
value = 1400,ifelse((random>499),1,2)
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = time = 1
value = 1400,ifelse((random>499),11,12)
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = time = 1
value = 1400,ifelse((random>499),21,22)
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, Explod]
type = Explod
trigger1 = NumHelper(1450)
trigger1 = Helper(1450), Var(16) = 2
anim = 1
ID = 1455
removetime = -1
removeongethit = 1
ignorehitpause = 1
[State 0, Explod]
type = Explod
trigger1 = !NumHelper(1450) && var(16) = 1
anim = 1
ID = 1456
removetime = -1
removeongethit = 1
ignorehitpause = 1

[State 0, VarSet]
type = null;VarSet
trigger1 = NumHelper(1450)
trigger1 = Helper(1450), Var(16) = 2
var(16) = 1

[State 0, VarSet]
type = null;VarSet
trigger1 = !NumHelper(1450) && var(16) = 1
var(16) = 2

[State 0, Helper]
type = helper
trigger1 = animelem = 4
helpertype = normal ;player
name = "Gimme the Chocolate Hisao"
ID = 1450
stateno = 1450
pos = 8,-115
postype = p1    ;p2,front,back,left,right
facing = 1
keyctrl = 0
ownpal = 1
supermovetime = 0
pausemovetime = 0
ignorehitpause = 1
persistent = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Arm Slam
[Statedef 1410]
type = S
physics = S
movetype = A
anim = 1410
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
triggerall = prevstateno != 1480
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000220)||NumExplod(90000225),2,ifElse(NumExplod(90000210)||NumExplod(90000215),1,0))

[State 1000, VarSet]
type = VarSet
triggerall = prevstateno = 1480
triggerall = !IsHelper
trigger1 = !time
var(41) = 2

[State 0, ChangeState]
type = null;ChangeState
trigger1 = !Time
trigger1 = Var(41)=2
trigger1 = NumProjID(1451)=0
value = 1400
ctrl = 0
ignorehitpause = 1

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !IsHelper
trigger1 = !Time
value = Anim + Var(41)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = IsHelper
trigger1 = !Time
value = 1413

[State 0, StopSnd]
type = StopSnd
trigger1 = 1
channel = 19

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 8051

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 0
channel = 1

[State 200, 1];voice
type = PlaySnd
triggerall = !IsHelper
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 810, MH1hit]
type = HitDef
triggerall = !IsHelper
triggerall = Var(18) <= 16
trigger1 = animelem = 4
attr = S, ST
damage = Cond(IsHelper,20,40), 0
animtype = Hard	
;guardflag = A
hitflag = AF
priority = 4, Hit
pausetime = 0,14
;guard.pausetime = 11,21
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -180
hitsound = s800,1
guardsound = S5,21
airguard.ctrltime = 40
airguard.velocity = Cond(Var(41)=0,3,6.5),-1.3
air.type = High	
air.velocity = 12,3
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = 1
fall = 1
fall.recover = 0
id = 1410
fall.xvelocity = 2;Cond(Var(41)=0,.2,2)
fall.yvelocity = -6.5;Cond(Var(41)=0,-4.5,-4.5)

[State 810, MH1hit]
type = HitDef
triggerall = IsHelper
trigger1 = animelem = 5
attr = S, SA
damage = ceil(ifElse(root,fvar(11) * 13/root,fvar(19) < 7, 7, root,fvar(11) * 13/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5, 2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5,-5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-2.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-6
air.hittime = 12
air.animtype = back
getpower= 0
givepower = 35,35
yaccel = 0.5
kill = 1
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 0, NotHitBy]
type = NotHitBy
trigger1 = NumTarget(1410)
trigger1 = MoveHit
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, HitBy]
type = HitBy
trigger1 = movehit = 0
value = SC, AA,AT, AP
time = 1

[State 0, PlayerPush]
type = PlayerPush
triggerall = !IsHelper
trigger1 = NumTarget(1410)
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
triggerall = !IsHelper
trigger1 = MoveHit = 1
value = 1420
ignorehitpause = 1
persistent = 0

[State 0, PosAdd]
type = PosAdd
triggerall = !IsHelper
trigger1 = NumTarget(1410)
trigger1 = MoveHit <= 8
trigger1 = BackEdgeBodyDist < 6
x = 40
persistent = 0

[State 0, Turn]
type = Turn
trigger1 = Anim = 1420
trigger1 = AnimElemTime(2)=0

[State 0, TargetBind]
type = TargetBind
triggerall = !IsHelper
trigger1 = MoveHit = 1
time = 1
pos = 75,-120
id = 1410
ignorehitpause = 1
persistent = 0

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = NumTarget(1410)
trigger1 = Anim = 1420
trigger1 = AnimElem = 7
value = ceil(ifElse(fvar(11) * -50 > -7, -7, fvar(11) * -50))
kill = 1

[State 0, TargetState]
type = TargetState
triggerall = !IsHelper
triggerall = NumTarget(1410)
trigger1 = MoveHit = 1
value = 1411
ID = 1410

[State 200, 1]
type = PlaySnd
trigger1 = Anim = 1411
trigger1 = animelem = 2
value = 1410,0
channel = 1

[State 0, AttackDist]
type = AttackDist
triggerall = !IsHelper
trigger1 = 1
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------
;Piccolo Pulls P2 to the ground
[Statedef 1411]
type    = A
movetype= H
physics = N
anim = 5061

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Time < 14
value = 5061

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 5071, 1]
type = VelSet
trigger1 = !Time 
x = 0
y = 0

[State 5071, 1]
type = VelSet
trigger1 = Time = 14
x = GetHitVar(xvel) * facing
y = 6

[State 5071, 3] ;Hit ground
type = ChangeState
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 652
ctrl = 0


;----------------------------------------
;Mental Shock Special State
[Statedef 1475]
type = A
physics = N
movetype = H
velset = 0,0
anim = ifelse((selfanimexist(9010)),9010,5030)

[State 0, PalFX]
type = PalFX
trigger1 = time%2 = 1
trigger1 = (anim = 7696 || anim = 9010)
add = 0, 0, 0
time = 1

[State 0, PalFX]
type = PalFX
trigger1 = anim = 5030
time = 1
add = -104,-104,7
sinadd = 56,56,0,10
color = 0
invertall = 1
mul = 256,256,256

[State 1475, outta here]
type = selfstate
trigger1 = time >= 60
;trigger2 = Pos Y <= -150
;trigger2 = time = 30
value = 5030
;----------------------------------------
;Arm Slam EX
[Statedef 1480]
type = S
physics = S
movetype = A
anim = 1480
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = 0

[State 0, PowerAdd]
type = PowerAdd
triggerall = !numexplod(1678)
trigger1 = !Time
value = Cond(IsHelper,0,-500)

[State 0, PowerAdd]
type = PowerAdd
triggerall = numexplod(1678)
trigger1 = !Time
value = 0

[State 0, ChangeState]
type = ChangeState
triggerall = numexplod(1678)
trigger1 = !Time
trigger1 = !IsHelper
value =1410
ctrl = 0
ignorehitpause = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 41
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = 2

[State 0, StopSnd]
type = StopSnd
trigger1 = 1
channel = 19

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = 1
id = 8051

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = A,NA;,SA;,HP
time = 1

[State 40, HitBy]
type = HitBy
trigger1 = 1
value = SC, AA,AT, AP
time = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 0
channel = 1

[State 200, 1];voice
type = PlaySnd
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 810, MH1hit]
type = HitDef
triggerall = Var(18) <= 16
trigger1 = animelem = 4
attr = S, ST
damage = Cond(IsHelper,20,40), 0
animtype = Hard	
;guardflag = A
hitflag = AF
priority = 4, Hit
pausetime = 0,14
;guard.pausetime = 11,21
sparkno = s10030
guard.sparkno = s10000
sparkxy = 0, -180
hitsound = s800,1
guardsound = S5,21
airguard.ctrltime = 40
airguard.velocity = Cond(Var(41)=0,3,6.5),-1.3
air.type = High	
air.velocity = 10,3
air.hittime = 12
air.animtype = back
getpower= 0,0
yaccel = 0.5
kill = 0
p2facing = 1
fall = 1
fall.recover = 0
id = 1480
fall.xvelocity = -2;Cond(Var(41)=0,.2,2)
fall.yvelocity = -6.5;Cond(Var(41)=0,-4.5,-4.5)
p1sprpriority = -2
p2sprpriority = 12

;Cooldown No5
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1678)
trigger1 = movehit = 1
anim = 15999
ID = 1678
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 0, NotHitBy]
type = NotHitBy
trigger1 = NumTarget(1480)
trigger1 = MoveHit
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1
ignorehitpause = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = NumTarget(1480)
value = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = MoveHit = 1
value = 1481
ignorehitpause = 1
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = anim = 1481 && animelemtime(10)>=0
value = 1483
ignorehitpause = 1
persistent = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = MoveHit <= 8
trigger1 = BackEdgeBodyDist < 6
x = 40
persistent = 0

[State 0, Turn]
type = Turn
trigger1 = Anim = 1481
trigger1 = AnimElemTime(2)=0

[State 0, TargetBind]
type = TargetBind
trigger1 = MoveHit = 1
trigger1 = animelemtime(3)<0
time = 1
pos = 70,-170
id = 1480
ignorehitpause = 1
persistent = 0

[State 0, TargetLifeAdd]
type = TargetLifeAdd
trigger1 = NumTarget(1480)
trigger1 = Anim = 1481
trigger1 = AnimElem = 7
value = ceil(ifElse(fvar(11) * -5 > -3, -3, fvar(11) * -5))
kill = 1

[State 0, TargetState]
type = TargetState
trigger1 = NumTarget(1480)
trigger1 = MoveHit = 1
value = 1482
ID = 1480

[State 200, 1]
type = PlaySnd
trigger1 = Anim = 1480
trigger1 = animelem = 2
value = 1410,0
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------
;EX Piccolo Pulls P2 to the ground
[Statedef 1482]
type    = A
movetype= H
physics = N

[State 0, ChangeAnim]
type = ChangeAnim2
trigger1 = Time < 14
value = 1482

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 5071, 1]
type = VelSet
trigger1 = !Time 
x = 0
y = 0

[State 5071, 1]
type = VelSet
trigger1 = Time = 14
x = GetHitVar(xvel) * facing
y = 12

[State 5071, 3] ;Hit ground
type = ChangeState
trigger1 = Pos Y >= 0
trigger1 = Vel Y > 0
value = 652
ctrl = 0
;---------------------------------------------------------------------------
; EX Arm Slam END
[Statedef 1483]
type = S
movetype = A
physics = S
anim = 1483
ctrl = 0
velset = 0,0
sprpriority = 3
juggle = 0
poweradd = 0

[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 4) = 0
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
value = 0
scale = 1,1 
ignorehitpause = 1
[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 2) = 0
trigger1 = animelemtime(6)>=0&&animelemtime(7)<0
value = 0
scale = 0.98,0.98
ignorehitpause = 1

[State 8000, flash]
type = PalFX
trigger1 = 1
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 8000, Train]
type = AfterImage
trigger1 = !time
time = 46
palbright = 40,30,-40
palcontrast = 256,206,206
trans = add1
ignorehitpause = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 2.5

[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NP,SP;,HP
time = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(6) = 0
value = 220,(8+random%2)
channel = 0
persistent = 0

[State 0, EnvShake]
type = EnvShake
;trigger1 = AnimElem = 2
trigger1 = AnimElem = 5
time = 14
freq = 120
ampl = -4
phase = 90

[State 1675, 1]
type = null;HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 2
attr = S, SA
damage = 15, 0
animtype = Hard	
hitflag = MAF
pausetime = 13,13
sparkno = s10030
sparkxy = -17,-64
hitsound = s5,7 ;Piccolo only
ground.type = Low
ground.slidetime = 5
ground.hittime  = 12
ground.velocity = -1.5
air.type = High	
air.velocity = -1,-4
air.hittime = 12
air.animtype = back
getpower = 0,0
yaccel = 0.5
kill = 0
id = 1676
p2facing = 1
fall = 1
fall.recover = 0

[State 810, 1]
type = PlaySnd
trigger1 = AnimElem = 5
value = 5, 15

[State 1675, 2]
type = HitDef
;triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = S, SA
damage = 17, 0
hitflag = MAFD
pausetime = 13,16
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-64
hitsound = s5,6 ;Piccolo only
animtype = Up
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = .2,-9
air.velocity = .2,-9.2
fall = 1
fall.recover = 0
air.animtype = back
getpower = 0,0
yaccel = 0.45
kill = 0
id = 1676
fall = 1
fall.recover = 0
p2facing = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = animelemtime(9) >= 0
value = 1400
ctrl = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

;----------------------------------------
;Carnage Blitz (Light) 4 hits left
[Statedef 1500]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, Helper]
type = Helper
trigger1 = animelemtime(1) = 1  
trigger1 = !NumHelper(1556)
name = "Carnage Voice"
ID = 1556
stateno = 1556
pos = 0,0
postype = p1  

[State 0, PlaySnd]
type = null;PlaySnd
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
trigger1 = !Time
value = 1501,0
volumescale = 255
channel = -1

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 2
var(20) = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1500
;trigger2 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
;trigger2 = !Time
value = 1500

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
anim = 15999
ID = 1500
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = Var(52)<=0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(7) < 0
trigger2 = Var(52)>=1
trigger2 = AnimElemTime(1) >= 0 && AnimElemTime(7) < 0
slot = 1
time = 1
stateno = 1501 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(7) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 10

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
x = 5

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(7) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1500)
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(7) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id = 1500

[State 0, VarAdd]
type = NULL;VarAdd
triggerall = MoveHit = 1
trigger1 = P2StateType = A
trigger2 = P2Statetype = L
var(18) = ifelse(p2statetype=A,3,16)
ignorehitpause = 1
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(7)>=0
value = 0        

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 5
var(20) = 0


[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Carnage Blitz (Light) loop
[Statedef 1501]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1500 ;go back to Carnage Blitz
ctrl = 0

;----------------------------------------
;Carnage Blitz (Medium) 4 hits left
[Statedef 1510]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = 1
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1556)
name = "Carnage Voice"
ID = 1556
stateno = 1556
pos = 0,0
postype = p1  

[State 0, PlaySnd]
type = null;PlaySnd
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
trigger1 = !Time
value = 1501,1
volumescale = 255
channel = -1

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
;trigger2 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 2
var(20) = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1510
;trigger1 = PrevStateNo != 1500 || PrevStateNo != 1510 || PrevStateNo != 1520
value = 1510

[State 0, ChangeAnim]
type = null;ChangeAnim
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
trigger1 = !Time
value = 1511

[State 0, PalFXWiz]
type = null;PalFX
trigger1 = Anim = 1511
trigger1 = Time < 15
time = 1
add = 7,0,-200
mul = 256,0,256
sinadd = 30,30,0,10
invertall = 0
color = 0

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
anim = 15999
ID = 1500
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
slot = 1
time = 1
stateno = 1511 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 14

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
x = 7

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1


[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1500)
;triggerall = prevstateno != 1500 || prevstateno != 1510 || prevstateno != 1520 
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8,-3
guard.velocity = 0
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,138)),Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,10))
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id = 1500

[State 1200, 2]
type = null;HitDef
triggerall = !NumTarget(1500)
triggerall = prevstateno = 1500 || prevstateno = 1510 || prevstateno = 1520 
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
;guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8,-3
guard.velocity = 0
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(IsHelper, 0,138),Cond(IsHelper, 0,10)
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1500

[State 0, VarAdd]
type = NULL;VarAdd
triggerall = MoveHit = 1
trigger1 = P2StateType = A
trigger2 = P2Statetype = L
var(18) = ifelse(p2statetype=A,3,16)
ignorehitpause = 1
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(9)>=0
value = 0    

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 7
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Carnage Blitz (Medium) loop
[Statedef 1511]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1510 ;go back to Carnage Blitz
ctrl = 0

;----------------------------------------
;Carnage Blitz (Heavy) 4 hits left
[Statedef 1520]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1556)
name = "Carnage Voice"
ID = 1556
stateno = 1556
pos = 0,0
postype = p1  

[State 0, PlaySnd]
type = null;PlaySnd
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
trigger1 = !Time
value = 1501,1
volumescale = 255
channel = -1

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 2
var(20) = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1520
;trigger2 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
;trigger2 = !Time
value = 1520

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
anim = 15999
ID = 1500
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1521 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 18

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 10

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1


[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1500)
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), 0
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1500

[State 0, VarAdd]
type = NULL;VarAdd
triggerall = MoveHit = 1
trigger1 = P2StateType = A
trigger2 = P2Statetype = L
var(18) = ifelse(p2statetype=A,3,16)
ignorehitpause = 1
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Carnage Blitz (Heavy) loop
[Statedef 1521]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1520 ;go back to Carnage Blitz
ctrl = 0

;----------------------------------------
;Carnage Blitz (EX) 
[Statedef 1550]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(PrevStateNo = 1551,0,Cond(IsHelper,0,-500))

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 3

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 2
var(20) = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1550
value = 1550

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = Var(52)<=0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
trigger2 = Var(52)>=1
trigger2 = AnimElemTime(1) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1551 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[State 0, Helper]
type = Helper
trigger1 = !Time 
trigger1 = !NumHelper(1606)
name = "EX?"
ID = 1606
stateno = 1606
pos = 0,0
postype = p1   

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4   
trigger1 = !NumHelper(1556)
name = "Carnage Voice"
ID = 1556
stateno = 1556
pos = 0,0
postype = p1  

[State 0, PlaySnd]
type = PlaySnd
trigger1 = PrevStateNo = 1500 || PrevStateNo = 1510 || PrevStateNo = 1520
trigger1 = !Time
value = 1501,1
volumescale = 255
channel = -1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 25

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 5

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(5) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1

[State 1200, 2]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = ceil(ifElse(fvar(11) * 70 < 35, 35, fvar(11) * 70)), 11
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = 0,0
givepower = Cond(var(28)>=1||var(29)>=1,0,27), Cond(var(28)>=1||var(29)>=1,0,13)
persistent = 0
fall.recover = 0
fall = 1
air.fall = 1

[State 1500]
type = changestate
trigger1 = MoveContact
trigger1 = P2BodyDist Y >= -20
value = 1552
ctrl = 0

[State 1500]
type = changestate
trigger1 = MoveContact
trigger1 = P2BodyDist Y < -20
value = 1553
ctrl = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Carnage Blitz (EX) 2 loop
[Statedef 1551]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1550 ;go back to Carnage Blitz
ctrl = 0

;----------------------------------------
;Carnage Blitz (EX) teleport -attack
[Statedef 1552]
type = S
physics = S
movetype = A
ctrl = 0
anim = 1540
velset = 0,0
sprpriority = -1

[State 0, Helper]
type = Helper
trigger1 = !Time 
name = "After Image Blitz 2"
ID = 1555
stateno = 1555
pos = 0,0
postype = p1   

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time 
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 12

[State 250, 1]
type = PlaySnd
trigger1 = !Time 
value = 7,0
persistent = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = Time = 8
x = P2Dist X +125;Cond(Facing = -1,(enemy, Pos X)-150,(enemy, Pos X)+150)



[State 0, VelSet]
type = VelSet
trigger1 = Time = 9
x = -35

[State 0, VelSet]
type = VelSet
trigger1 = AnimElem = 5
x = 0

[State 0, Helper]
type = Helper
trigger1 = Time = 2  
name = "Push P2"
ID = 1546
stateno = 1546
pos = 0,0
postype = p1   

[State 0, ScreenBound]
type = ScreenBound
trigger1 = AnimElemTime(6) < 0
value = 0

[State 0, Width]
type = Width
trigger1 = AnimElemTime(6) < 0
edge = 100,0
player = 150,150

[State 0, Width]
type = Width
trigger1 = AnimElemTime(3)<=0 && AnimElemTime(10)<0
player = 150,0

[State 0, Turn]
type = Turn
trigger1 = AnimElem = 2  

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem = 4  
value = 1500,2
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem = 4  
value = 1500,22
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem = 4  
value = 1500,32
volumescale = 255
channel = 0
;lowpriority = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4  
value = 1501,1
volumescale = 255
channel = -1
freqmul = 1.0
loop = 0
ignorehitpause = 1
persistent = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 5,15

[State 1200, 2]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = S, SA
hitflag = MAFD
animtype  = Hard
pausetime = 10,10
guard.pausetime = 10,17
damage    = ceil(ifElse(fvar(11) * 50 < 25, 25, fvar(11) * 50)), 11
sparkno = s10030
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S5, 5
guardsound = S5,21
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
guard.slidetime = 20
guard.hittime = 30
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = -6
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
persistent = 0
fall.recover = 0
fall = 1
air.fall = 1
getpower = 0,0
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Carnage Blitz (EX) teleport -attack AIR
[Statedef 1553]
type = A
physics = A
movetype = A
ctrl = 0
anim = 1541
velset = 0,-5
sprpriority = -1

[State 0, Helper]
type = Helper
trigger1 = !Time 
name = "After Image Blitz 2"
ID = 1555
stateno = 1555
pos = 0,0
postype = p1   

[State 0, NotHitBy]
type = NotHitBy
trigger1 = !Time 
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 12

[State 250, 1]
type = PlaySnd
trigger1 = !Time 
value = 7,0
persistent = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = Time = 8
x = P2Dist X +145;Cond(Facing = -1,(enemy, Pos X)-150,(enemy, Pos X)+150)
Y = P2Dist Y -10



[State 0, Helper]
type = Helper
trigger1 = Time = 2  
name = "Push P2"
ID = 1546
stateno = 1546
pos = 0,0
postype = p1   

[State 0, ScreenBound]
type = ScreenBound
trigger1 = AnimElemTime(6) < 0
value = 0

[State 0, Width]
type = Width
trigger1 = AnimElemTime(6) < 0
edge = 100,0
player = 150,150

[State 0, Width]
type = Width
trigger1 = AnimElemTime(3)<=0 && AnimElemTime(10)<0
player = 150,0

[State 0, Turn]
type = Turn
trigger1 = AnimElem = 2  

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 4
value = 5,15

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=2 && random<350
value = 220,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=2 && random<350
value = 220,(4+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=2 && random<350
value = 220,(8+random%2)
channel = 0

[State 250, 2]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = A, NA
animtype  = Hard
damage    = ceil(ifElse(fvar(11) * 50 < 25, 25, fvar(11) * 50)), 11
priority = 4, Hit
guardflag = MA
pausetime = 0,13
guard.pausetime = 0,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -20,-74
hitsound   = s5,5
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime = 20
ground.velocity = -9
air.velocity = -8,8
air.animtype = back
fall.recover = 0
fall = 1
air.fall = 1
yaccel = 0.5
getpower = 0,0
givepower = 27, 13

[State 1500]
type = changestate
trigger1 = MoveContact
trigger1 = AnimElemTime(8) > 2
value = 1554
ctrl = 0
ignorehitpause = 1

[State 0, VelSet]
type = VelSet
trigger1 = MoveContact
trigger1 = AnimElemTime(8) < 2
y = 0

[State 1500]
type = changestate
trigger1 = animtime = 0
value = 50
ctrl = 1

;----------------------------------------
;(EX) teleport -attack AIR Connects
[Statedef 1554]
type = A
physics = N
movetype = I
ctrl = 0
anim = 1543
velset = 0,0
sprpriority = -1

[State 0, VelSet]
type = VelSet
trigger1 = Time < 10
y = 0

[State 0, VelSet]
type = VelSet
trigger1 = Time >= 11
y = 10

[State 1500]
type = changestate
trigger1 = (Vel y > 0) && (Pos y >= 0)
value = 48
ctrl = 0

;----------------------------
;Mystic Harpoon Light
[Statedef 1600]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1600
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = IsHelper
trigger1 = Var(1) = 7
value = 1690
ctrl = 0
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 0
channel = 1

[State 200, 1];voice
type = PlaySnd
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

;Cooldown No3
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1675)
trigger1 = movehit = 1
anim = 15999
ID = 1675
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0
;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1677)
trigger1 = moveguarded=1&& AnimElemTime(4) >= 0
anim = 15999
ID = 1677
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 810, MH1hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 5
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH2hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 6
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) < 0
value = 1610
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) >= 0 
value = 1611
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) < 0 
;trigger1 = MoveGuarded && AnimElemTime(6) < 0 
trigger2 = !NumHelper(1604) && AnimElemTime(5) >= 0 && AnimElemTime(6) <= 0
value = 1620
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) > 0 && AnimElemTime(8) < 0
;trigger1 = MoveGuarded && AnimElemTime(6) > 0 && AnimElemTime(8) < 0
trigger2 = !NumHelper(1604) && AnimElemTime(6) > 0 && AnimElemTime(8) < 0
value = 1621
ctrl = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(8)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Mystic Harpoon Medium
[Statedef 1601]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1601
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = IsHelper
trigger1 = Var(1) = 7
value = 1696
ctrl = 0
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50


[State 0, Helper]
type = Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 1
channel = 6

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 
value = 1600,10  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 1600,20  + (random%2)
channel = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = AnimElem = 5
attr = SCA,NP,SP,HP        
slot = 0
stateno = 1620
time = 1
ignorehitpause = 1

;Cooldown No3
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1675)
trigger1 = movehit = 1
anim = 15999
ID = 1675
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0
;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1677)
trigger1 = moveguarded=1&& AnimElemTime(4) >= 0
anim = 15999
ID = 1677
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 810, MH1hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 5
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH2hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 6
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH3hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 7
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) < 0
value = 1610
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
value = 1611
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(7) >= 0 
value = 1612
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677) && AnimElemTime(6) < 0 
;trigger1 = MoveGuarded && AnimElemTime(6) < 0 
trigger2 = !NumHelper(1604) && AnimElemTime(5) >= 0 && AnimElemTime(6) <= 0
value = 1620
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677) && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
;trigger1 = MoveGuarded && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
trigger2 = !NumHelper(1604) && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
value = 1621
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677) && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
;trigger1 = MoveGuarded && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
trigger2 = !NumHelper(1604) && AnimElemTime(7) >= 0 && AnimElemTime(9)<=0
value = 1622
ctrl = 0

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 10
value = 1610,4
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(9)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Mystic Harpoon Strong
[Statedef 1602]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1602
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = IsHelper
trigger1 = Var(1) = 7
value = 1697
ctrl = 0
ignorehitpause = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50

[State 0, AttackDist]
type = AttackDist
trigger1 = 1
value = 400
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 2
channel = 6

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 
value = 1600,10  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 1600,20  + (random%2)
channel = 0

;Cooldown No3
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1675)
trigger1 = movehit = 1
anim = 15999
ID = 1675
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0
;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1677)
trigger1 = moveguarded=1&& AnimElemTime(4) >= 0
anim = 15999
ID = 1677
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 810, MH1hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 5
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH2hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 6
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH3hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 7
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH4hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 8
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 810, MH5hit]
type = HitDef
triggerall = Var(18) <= 16
triggerall = !NumTarget(1676)
trigger1 = animelem = 9
attr = S, NA
damage = Cond(IsHelper,0,7), 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = 12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 0
p2facing = Cond(IsHelper,0,1)
id = 1675

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) < 0
value = 1610
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
value = 1611
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
value = 1612
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
value = 1613
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(9) >= 0 
value = 1614
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) < 0 
;trigger1 = MoveGuarded && AnimElemTime(6) < 0 
trigger2 = !NumHelper(1604) && AnimElemTime(5) >= 0 && AnimElemTime(6) <= 0
value = 1620
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
;trigger1 = MoveGuarded && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
trigger2 = !NumHelper(1604) && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
value = 1621
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
;trigger1 = MoveGuarded && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
trigger2 = !NumHelper(1604) && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
value = 1622
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 =  NumExplod(1677)>=1 && AnimElemTime(8) >= 0 && AnimElemTime(9) <= 0 
;trigger1 = MoveGuarded && AnimElemTime(8) >= 0 && AnimElemTime(9) <= 0 
trigger2 = !NumHelper(1604) && AnimElemTime(8) >= 0 && AnimElemTime(10)<=0
value = 1623
ctrl = 0

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 12
value = 1610, 5
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
; EX Mystic Harpoon 
[Statedef 1603]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1602
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,-500)
hitcountpersist = 1
movehitpersist = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = IsHelper
trigger1 = Var(1) = 7
value = 1697
ctrl = 0
ignorehitpause = 1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time 
id = 1675
[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = !time 
id = 1677

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 3

[State 0, ChangeState]
type = Changeanim
trigger1 = IsHelper
value = 1600
elem = 8
persistent = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50


[State 0, Helper]
type = null;Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1    
[State 0, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA,NP,SP;,HP
time = 1
[State 0, HitBy]
type = HitBy
trigger1 = 1
value = SC, AA,AT, AP
time = 1

[State 0, Helper]
type = Helper
trigger1 = !Time
trigger1 = !IsHelper
name = "EX?"
ID = 1606
stateno = 1606
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 2  

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 2

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 1
value = 7,0
persistent = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 
value = 1600,10  + (random%3)
channel = 0

[State 200, 1];voice
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 1600,20  + (random%2)
channel = 0

;Cooldown No3
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1675)
trigger1 = movehit = 1
anim = 15999
ID = 1675
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0
;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1677)
trigger1 = moveguarded=1&& AnimElemTime(4) >= 0
anim = 15999
ID = 1677
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 810, MH1hit]
type = HitDef
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676) || !NumTarget(1675)
trigger1 = animelem = 5
trigger1 = !IsHelper
trigger2 = IsHelper
trigger2 = enemy, StateNo != [1660,1662]  
trigger2 = P2MoveType = H
attr = S, NA
damage = 7, 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 20
guard.hittime = 24
guard.velocity = 12
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
ground.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
yaccel = 0.5
id = 1675
kill = 0
p2facing = Cond(IsHelper,0,1)

[State 810, MH2hit]
type = HitDef
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676)|| !NumTarget(1675)
trigger1 = animelem = 6
trigger1 = !IsHelper
trigger2 = IsHelper
trigger2 = enemy, StateNo != [1660,1662] 
trigger2 = P2MoveType = H
attr = S, NA
damage = 7, 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 25
guard.hittime = 29
guard.velocity = 12
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
ground.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
yaccel = 0.5
id = 1675
kill = 0
p2facing = Cond(IsHelper,0,1)

[State 810, MH3hit]
type = HitDef
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676)|| !NumTarget(1675)
trigger1 = animelem = 7
trigger1 = !IsHelper
trigger2 = IsHelper
trigger2 = enemy, StateNo != [1660,1662]
trigger2 = P2MoveType = H
attr = S, NA
damage = 7, 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 32
guard.velocity = 12
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
ground.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
yaccel = 0.5
id = 1675
kill = 0
p2facing = Cond(IsHelper,0,1)

[State 810, MH4hit]
type = HitDef
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676)|| !NumTarget(1675)
trigger1 = animelem = 8
trigger1 = !IsHelper
trigger2 = IsHelper
trigger2 = enemy, StateNo != [1660,1662] 
trigger2 = P2MoveType = H
attr = S, NA
damage = 7, 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 34
guard.hittime = 36
guard.velocity = 12
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
ground.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
yaccel = 0.5
id = 1675
kill = 0
p2facing = Cond(IsHelper,0,1)

[State 810, MH5hit]
type = HitDef
triggerall = Var(18) <= 55
triggerall = !NumTarget(1676) || !NumTarget(1675)
trigger1 = !IsHelper
trigger1 = animelem = 9
trigger2 = IsHelper
trigger2 = enemy, StateNo != [1660,1662] 
trigger2 = P2MoveType = H
attr = S, NA
damage = 7, 0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s800,1
guardsound = S5,21
ground.type = High
air.type = Low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 34
guard.hittime = 36
guard.velocity = 12
airguard.velocity = -2.5,-1.3
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
ground.cornerpush.veloff = 0
getpower= 0,0
givepower = 35,35
yaccel = 0.5
id = 1675
kill = 0
p2facing = Cond(IsHelper,0,1)

;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1679)
trigger1 = movehit = 1
anim = 15999
ID = 1679
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0
;Cooldown No4
[State 0, Explod]
type = Explod
triggerall = !NumExplod(1680)
trigger1 = moveguarded=1&& AnimElemTime(4) >= 0
anim = 15999
ID = 1680
bindtime = -1
postype = p1
pos = 0,14
ignorehitpause = 1
removeongethit = 0
ownpal = 1
sprpriority = -3
persistent = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) < 0
value = 1610
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
value = 1611
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
value = 1612
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
value = 1613
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumTarget(1675) 
trigger1 = MoveHit && AnimElemTime(9) >= 0 
value = 1614
ctrl = 0
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) < 0 
;trigger1 = MoveGuarded && AnimElemTime(6) < 0 
value = 1620
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1 && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
;trigger1 = MoveGuarded && AnimElemTime(6) > 0 && AnimElemTime(7) < 0
value = 1621
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 =  NumExplod(1677)>=1 && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
;trigger1 = MoveGuarded && AnimElemTime(7) > 0 && AnimElemTime(8) < 0
value = 1622
ctrl = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = NumExplod(1677)>=1  && AnimElemTime(8) >= 0 
;trigger1 = MoveGuarded && AnimElemTime(8) >= 0 
value = 1623
ctrl = 0


[State 200, 1]
type = PlaySnd
trigger1 = animelem = 12
value = 1610, 5
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 810, end]
type = changestate
trigger1 = !AnimTime
trigger1 = enemy, StateNo = [1660,1662]
trigger1 = P2MoveType = H
value = 1352
ctrl = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------
;Piccolo Connects With MH1
[Statedef 1610]
type = S
movetype = I
physics = S
anim = 1610
ctrl = 0
sprpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 1.50

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(18) = 0

[State Throw]
type = targetstate
triggerall = !IsHelper
trigger1 = !time
value = 1660

[State Throw]
type = targetstate
triggerall = IsHelper&&var(1)<5
trigger1 = !time
value = 1660

[State 820, 1]
type = TargetBind
triggerall = !Ishelper
trigger1 = AnimElemTime(1) <= 2
pos = ceil(75 * const(size.xScale)),Cond((P2Name = "Babidi Z2" || P4Name = "Babidi Z2"),-40,0)
;ceil(84, 107, 160. 207, 218 * const(size.xScale)),0

[State 0, TargetDrop]
type = TargetDrop
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]

[State 810, end]
type = changestate
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]
value = 1620
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = NumHelper(1606) = 0
value = 1650
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = !IsHelper
trigger1 = NumHelper(1606) >= 1
value = 1652
ctrl = 0

;----------------------------
;Piccolo Connects With MH2
[Statedef 1611]
type = S
movetype = I
physics = S
anim = 1611
ctrl = 0
sprpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 1.50

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(18) = 0

[State Throw]
type = targetstate
triggerall = !IsHelper
trigger1 = !time
value = 1660

[State Throw]
type = targetstate
triggerall = IsHelper&&var(1)<5
trigger1 = !time
value = 1660

[State 820, 1]
type = TargetBind
triggerall = !Ishelper
trigger1 = AnimElemTime(1) <= 2
pos = ceil(98 * const(size.xScale)),Cond((P2Name = "Babidi Z2" || P4Name = "Babidi Z2"),-40,0)
;ceil(84, 107, 160. 207, 218 * const(size.xScale)),0

[State 0, TargetDrop]
type = TargetDrop
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]

[State 810, end]
type = changestate
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]
value = 1621
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = NumHelper(1606) = 0
value = 1650
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = !IsHelper
trigger1 = NumHelper(1606) >= 1
value = 1653
ctrl = 0

;----------------------------
;Piccolo Connects With MH3
[Statedef 1612]
type = S
movetype = I
physics = S
anim = 1612
ctrl = 0
sprpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 1.50

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(18) = 0

[State Throw]
type = targetstate
triggerall = !IsHelper
trigger1 = !time
value = 1660

[State Throw]
type = targetstate
triggerall = IsHelper&&var(1)<5
trigger1 = !time
value = 1660

[State 820, 1]
type = TargetBind
trigger1 = AnimElemTime(1) <= 2
pos = ceil(151 * const(size.xScale)),Cond((P2Name = "Babidi Z2" || P4Name = "Babidi Z2"),-40,0)
;ceil(84, 107, 160. 207, 218 * const(size.xScale)),0

[State 0, TargetDrop]
type = TargetDrop
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]

[State 810, end]
type = changestate
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]
value = 1622
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = NumHelper(1606) = 0
value = 1651
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = !IsHelper
trigger1 = NumHelper(1606) >= 1
value = 1654
ctrl = 0

;----------------------------
;Piccolo Connects With MH4
[Statedef 1613]
type = S
movetype = I
physics = S
anim = 1613
ctrl = 0
sprpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 1.50

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(18) = 0

[State Throw]
type = targetstate
triggerall = !IsHelper
trigger1 = !time
value = 1660

[State Throw]
type = targetstate
triggerall = IsHelper&&var(1)<5
trigger1 = !time
value = 1660

[State 820, 1]
type = TargetBind
triggerall = !Ishelper
trigger1 = AnimElemTime(1) <= 2
pos = ceil(256 * const(size.xScale)),Cond((P2Name = "Babidi Z2" || P4Name = "Babidi Z2"),-40,0)
;ceil(84, 107, 160. 207, 218 * const(size.xScale)),0

[State 0, TargetDrop]
type = TargetDrop
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]

[State 810, end]
type = changestate
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]
value = 1623
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = NumHelper(1606) = 0
value = 1651
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = !IsHelper
trigger1 = NumHelper(1606) >= 1
value = 1655
ctrl = 0

;----------------------------
;Piccolo Connects With MH5
[Statedef 1614]
type = S
movetype = I
physics = S
anim = 1614
ctrl = 0
sprpriority = 1

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 1.50

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(18) = 0

[State Throw]
type = targetstate
triggerall = !IsHelper
trigger1 = !time
value = 1660

[State Throw]
type = targetstate
triggerall = IsHelper&&var(1)<5
trigger1 = !time
value = 1660

[State 820, 1]
type = TargetBind
triggerall = !Ishelper
trigger1 = AnimElemTime(1) <= 2
pos = ceil(259 * const(size.xScale)),Cond((P2Name = "Babidi Z2" || P4Name = "Babidi Z2"),-40,0)
;ceil(84, 107, 160. 207, 218 * const(size.xScale)),0

[State 0, TargetDrop]
type = TargetDrop
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]

[State 810, end]
type = changestate
triggerall = IsHelper
trigger1 = root, StateNo = 1603
trigger2 = p2stateno = [1660,1662]
value = 1624
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = NumHelper(1606) = 0
value = 1651
ctrl = 0

[State 810, end]
type = changestate
triggerall = !animtime
trigger1 = !IsHelper
trigger1 = NumHelper(1606) >= 1
value = 1655
ctrl = 0

;----------------------------
;1st Hit of MH guarded
[Statedef 1620]
type = S
movetype = I
physics = S
anim = 1620
ctrl = 0
sprpriority = 1

[State 0, StopSnd]
type = StopSnd
trigger1 = !Time
channel = 6
ignorehitpause = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;2nd Hit of MH guarded
[Statedef 1621]
type = S
movetype = I
physics = S
anim = 1621
ctrl = 0
sprpriority = 1



[State 0, StopSnd]
type = StopSnd
trigger1 = !Time
channel = 6
ignorehitpause = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;3rd Hit of MH guarded
[Statedef 1622]
type = S
movetype = I
physics = S
anim = 1622
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 1610,4
channel = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;4th Hit of MH guarded
[Statedef 1623]
type = S
movetype = I
physics = S
anim = 1623
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 1610, 5
channel = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;5th Hit of MH grabs fireball
[Statedef 1624]
type = S
movetype = I
physics = S
anim = 1624
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 3
value = 1610, 5
channel = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Piccolo Pulls P2 Back Near
[Statedef 1650]
type = S
movetype = I
physics = S
anim = 1650
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Piccolo Pulls P2 Back Far
[Statedef 1651]
type = S
movetype = I
physics = S
anim = 1651
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Piccolo Pulls P2 Back EX1
[Statedef 1652]
type = S
movetype = I
physics = S
anim = 1652
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 810, end]
type = changestate
triggerall = Var(52)<=0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 2
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1675
ctrl = 0

[State 810, end]
type = changestate
triggerall = Var(52)>0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 2
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1680
ctrl = 0

[State 810, end]
type = changestate
trigger1 = !AnimTime
value = 1352
ctrl = 0


;----------------------------
;Piccolo Pulls P2 Back EX1
[Statedef 1653]
type = S
movetype = I
physics = S
anim = 1653
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 810, end]
type = changestate
triggerall = Var(52)<=0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 3
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1675
ctrl = 0

[State 810, end]
type = changestate
triggerall = Var(52)>0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 3
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1680
ctrl = 0

[State 810, end]
type = changestate
trigger1 = !AnimTime
value = 1352
ctrl = 0

;----------------------------
;Piccolo Pulls P2 Back EX1
[Statedef 1654]
type = S
movetype = I
physics = S
anim = 1654
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 810, end]
type = changestate
triggerall = Var(52)<=0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 4
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1675
ctrl = 0

[State 810, end]
type = changestate
triggerall = Var(52)>0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 4
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1680
ctrl = 0

[State 810, end]
type = changestate
trigger1 = !AnimTime
value = 1352
ctrl = 0



;----------------------------
;Piccolo Pulls P2 Back EX1
[Statedef 1655]
type = S
movetype = I
physics = S
anim = 1655
ctrl = 0
sprpriority = 1

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 1
value = 1610, 3
channel = 1

[State 100, snd]
type = playsnd
trigger1 = time=0
value = 5,8
persistent = 0

[State 810, end]
type = changestate
triggerall = Var(52)<=0
triggerall = !IsHelper
trigger1 = AnimElemTime(2) > 4
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1675
ctrl = 0

[State 810, end]
type = changestate
triggerall = Var(52)>0
triggerall = !IsHelper
trigger1 = AnimElemTime(1) > 4
trigger1 = P2MoveType = H
trigger1 = P2BodyDist X <= 20
value = 1680
ctrl = 0

[State 810, end]
type = changestate
trigger1 = !AnimTime
value = 1352
ctrl = 0

;----------------------------
;P2 Hit by MH
[Statedef 1660]
type = S
movetype = H
physics = S
anim = 5000
ctrl = 0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 1660

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = enemy,numhelper(3501)=0&&enemy,numhelper(3502)=0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 10

[State 810, end]
type = changestate
trigger1 = Time = 7
value = 1661
ctrl = 0

;----------------------------
;P2 Pulled Back
[Statedef 1661]
type = S
movetype = H
physics = S
anim = 5000
ctrl = 0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 1661

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = enemy, NumHelper(1606) >=1
trigger1 = StateNo = 1661
trigger1 = P2BodyDist X >= 20
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 1

[State 0, PlayerPush]
type = PlayerPush
trigger1 = enemy, NumHelper(1606) >=1
trigger1 = StateNo = 1661
value = 0

[State 0, HitFallSet]
type = HitFallSet
trigger1 = Anim = 1661
value = 0

[State 0, VelSet]
type = VelSet
trigger1 = Time >= 1 
x = 15

[State 0, VelSet]
type = VelSet
trigger1 = Time >= 20 
x = 0

[State 0, VelSet]
type = VelSet
trigger1 = P2BodyDist  X <= 2
x = 0

[State 810, end]
type = changestate
trigger1 = Time > 2 && Vel X = 0
value = 1662
ctrl = 0

;----------------------------
;P2 Recoverying
[Statedef 1662]
type = S
movetype = H
physics = S
anim = 5000
ctrl = 0
sprpriority = 1

[State 0, ChangeAnim2]
type = ChangeAnim2
trigger1 = Time = 0
value = 1662

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0
ignorehitpause = 1

[State 0, HitFallSet]
type = HitFallSet
trigger1 = Anim = 1662
value = 0

[State 810, end]
type = selfstate
trigger1 = !AnimTime
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; EX MH ENDER
[Statedef 1675]
type = S
movetype = A
physics = S
anim = 1675
ctrl = 0
velset = 0,0
poweradd = 0
sprpriority = 3
juggle = 0

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 2.5

[State 810, 1]
type = PlaySnd
trigger1 = !Time
value = 5, 12

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(14) = 0
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(14) = 0
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(14) = 0
value = 220,(8+random%2)
channel = 0
persistent = 0

[State 0, EnvShake]
type = EnvShake
trigger1 = AnimElem = 2
trigger2 = AnimElem = 4
trigger3 = AnimElem = 14
time = 14
freq = 120
ampl = -4
phase = 90

[State 1675, 1]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = animelem = 2
attr = S, SA
damage = 15, 0
animtype = Hard	
hitflag = MAF
pausetime = 13,13
sparkno = s10030
sparkxy = -17,-64
hitsound = s5,7 ;Piccolo only
ground.type = Low
ground.slidetime = 5
ground.hittime  = 12
ground.velocity = -3.5
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower = 0,0
yaccel = 0.5
kill = 0
id = 1676

[State 810, 1]
type = PlaySnd
trigger1 = AnimElem = 4
value = 5, 15

[State 1675, 2]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = S, SA
damage = 17, 0
hitflag = MAF
pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-64
hitsound = s5,6 ;Piccolo only
animtype = Up
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -.7,-11
air.velocity = ifelse(p2movetype=H,-3,-1),ifelse(p2movetype=H,-5,-10)
fall = 1
fall.recover = 0
air.animtype = back
getpower = 0,0
yaccel = 0.45
kill = 0
id = 1676

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 13
name = "MHBeam"
ID = 1676
stateno = 1676
pos = 0,0
postype = p1    

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(17)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

;---------------------------------------------------------------------------
; Demon MH ENDER
[Statedef 1680]
type = S
movetype = A
physics = S
anim = 1680
ctrl = 0
velset = 0,0
poweradd = 0
sprpriority = 3
juggle = 0

[State 0, VarSet]
type = VarSet
trigger1 = !Time
fvar(19) = 2.5

[State 810, 1]
type = PlaySnd
trigger1 = !Time
value = 5, 12

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelemtime(14) = 0
value = 1350,(random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelemtime(14) = 0
value = 1350,(10+random%2)
channel = 0
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelemtime(14) = 0
value = 220,(8+random%2)
channel = 0
persistent = 0

[State 0, EnvShake]
type = EnvShake
trigger1 = AnimElem = 2
trigger2 = AnimElem = 4
trigger3 = AnimElem = 14
time = 14
freq = 120
ampl = -4
phase = 90

[State 1675, 1]
type = HitDef
trigger1 = animelem = 2
attr = S, SA
damage = 15, 0
animtype = Hard	
hitflag = MAF
pausetime = 13,13
sparkno = s10030
sparkxy = -17,-64
hitsound = s5,7 ;Piccolo only
ground.type = Low
ground.slidetime = 5
ground.hittime  = 12
ground.velocity = -3.5
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower = 0,0
yaccel = 0.5
kill = 0
id = 1675

[State 810, 1]
type = PlaySnd
trigger1 = AnimElem = 4
value = 5, 15

[State 1675, 2]
type = HitDef
trigger1 = AnimElem = 6
attr = S, SA
damage = 17, 0
hitflag = MAF
pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -17,-64
hitsound = s5,6 ;Piccolo only
animtype = Up
ground.type = High
air.type = Low
ground.slidetime = 12
ground.hittime = 12
ground.velocity = -.7,-11
air.velocity = ifelse(p2movetype=H,-3,-1),ifelse(p2movetype=H,-5,-10)
fall = 1
fall.recover = 0
air.animtype = back
getpower = 0,0
yaccel = 0.45
kill = 0
id = 1675

[State 0, Helper]
type = Helper
trigger1 = AnimElem = 13
name = "MHEyeBeam"
ID = 1681
stateno = 1681
pos = 0,0
postype = p1    

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(15)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------
;Mystic Harpoon Light
[Statedef 1690]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1690
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50

[State 0, Helper]
type = null;Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 0
channel = 1

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 && random<350
value = 201,0
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 && random<350
value = 202,0
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 810, MH1hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 5
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,0
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH2hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,0
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

;helper hit
[State 810, MH1hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 5
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,0
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH2hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,0
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4
;helper hit

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(6) < 0
value = 1691
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(6) >= 0 
value = 1692
elem = 1
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(8)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1
;----------------------------
;Mystic Harpoon Medium-Punch
[Statedef 1696]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1696
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50


[State 0, Helper]
type = null;Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 1
channel = 6

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=2 && random<350
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=2 && random<350
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=2 && random<350
value = 210,(5+random%2)
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 
value = 1600,10  + (random%3)
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 1600,20  + (random%2)
channel = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = AnimElem = 5
attr = SCA,NP,SP,HP        
slot = 0
stateno = 1620
time = 1
ignorehitpause = 1

[State 810, MH1hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 5
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH2hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH3hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 7
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

;helper hit
[State 810, MH1hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 5
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH2hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH3hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 7
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,1
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4
;helper hit

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(6) < 0
value = 1691
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(6) >= 0 
value = 1692
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(7) >= 0 
value = 1693
elem = 1
persistent = 0

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 10
value = 1610,4
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(9)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------
;Mystic Harpoon Strong-Punch
[Statedef 1697]
type    = S
movetype= A
physics = S
;juggle  = 7
velset = 0,0
anim = 1697
ctrl = 0
sprpriority = 2
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
hitcountpersist = 1
movehitpersist = 1

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveHit = 1
var(53) = 75


[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = MoveGuarded = 1
var(53) = 50


[State 0, Helper]
type = null;Helper
trigger1 = AnimElem = 5
name = "KillProj"
ID = 1604
stateno = 1604
pos = 0,0
postype = p1   

[State 200, 1]
type = PlaySnd
trigger1 = animelem = 2
value = 1610, 2
channel = 6

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 && random<350
value = 220,2+random%2
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 && random<350
value = 220,6+random%2
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 && random<350
value = 220,10+random%2
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 1600,0  + (random%3)
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1 
value = 1600,10  + (random%3)
channel = 0

[State 200, 1];voice
type = null;PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 1600,20  + (random%2)
channel = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = Ishelper
trigger1 = p2stateno = [1660,1662]
value = 0

[State 810, MH1hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 5
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 16
guard.hittime = 20
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH2hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 6
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 22
guard.hittime = 26
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH3hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 7
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH4hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 8
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH5hit]
type = HitDef
triggerall = !Ishelper
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 9
attr = S, NA
damage = ceil(ifElse(fvar(11) * 23/fvar(19) < 7, 7, fvar(11) * 23/fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= ifelse(p2movetype=H,Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,40)),Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,210))), Cond(var(28)>=1||var(29)>=1,0,35)
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 1
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

;helper hit
[State 810, MH3hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 7
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 24
guard.hittime = 28
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH4hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 8
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4

[State 810, MH5hit]
type = HitDef
triggerall = Ishelper
triggerall = enemy,stateno !=[1660,1662] 
triggerall = Var(18) <= 16
triggerall = !NumTarget(1678)
trigger1 = animelem = 9
attr = S, NA
damage = ceil(ifElse(root,fvar(11) * 23/root,fvar(19) < 7, 7, root,fvar(11) * 23/root,fvar(19))),0
animtype = Hard	
guardflag = MA
hitflag = MAF
priority = 4, Hit
pausetime = 13,13
guard.pausetime = 13,13
sparkno = s10030
guard.sparkno = s10000
sparkxy = -10, -75
hitsound = s5,2
guardsound = S5,20
ground.type = low
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
ground.slidetime = 15
ground.hittime  = 24
ground.velocity = -3.5
guard.slidetime = 30
guard.hittime = 34
guard.velocity = -12
airguard.velocity = -2.5,-1.3
ground.cornerpush.veloff = 0
air.type = High	
air.velocity = -4,-4
air.hittime = 12
air.animtype = back
getpower= 0,0;ifelse(p2movetype=H,Cond(IsHelper,0,40),Cond(IsHelper,0,210)), 35
givepower = 35,35
yaccel = 0.5
kill = 1
p2facing = Cond(IsHelper,0,1)
id = 1678
fall = 0
fall.recover = 0
envshake.time = 8
envshake.ampl = -4
;helper hit

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(6) < 0
value = 1691
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(7) >= 0 
value = 1693
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget(1678)&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveContact && AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
value = 1694
elem = 1
persistent = 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = NumTarget = 1678&&anim!= 1691&&anim!= 1692&&anim!= 1693&&anim!= 1694&&anim!= 1695
trigger1 = MoveHit && AnimElemTime(9) >= 0 
value = 1695
elem = 1
persistent = 0


[State 200, 1]
type = PlaySnd
trigger1 = animelem = 12
value = 1610, 5
channel = 1

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
trigger2 = p2stateno = [1660,1662]
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; TeleSweep LK
[Statedef 1850]
type = S
movetype = A
physics = S
anim = 1800
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(3)=3
x = 21
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(4)=1
x = 21
[State 0, PosAdd]
type = null;PosAdd
trigger1 = AnimElemTime(5)=1
x = 21

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=2 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=2 
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=2 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; TeleSweep LK
[Statedef 1850]
type = S
movetype = A
physics = S
anim = 1800
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(3)=3
x = 21
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(4)=1
x = 21
[State 0, PosAdd]
type = null;PosAdd
trigger1 = AnimElemTime(5)=1
x = 21

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=2 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=2 
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=2 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 6
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; TeleSweep MK/SK
[Statedef 1851]
type = S
movetype = A
physics = S
anim = 1801
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250) || NumExplod(90000255),1,0) 

[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
trigger1 = !time
var(41) = ifElse(P2Dist X > 200 ,1,0) 

[State 0, Explod]
type = Explod
trigger1 = IsHelper
anim = 1606
ID = 1802
removetime = 80
removeongethit = 1


[State 0, PosAdd]
type = PosAdd
trigger1 = Var(41) = 0
trigger1 = AnimElemTime(4)=0
x = 80
[State 0, PosAdd]
type = PosAdd
trigger1 = Var(41) = 1
trigger1 = AnimElemTime(4)=0
x = 180

[State 0, Helper]
type = Helper
trigger1 = !Time
name = "Push"
ID = 1546
stateno = 1546

[State 0, Helper]
type = Helper
trigger1 = !Time
name = "AfterImage"
ID = 1557
stateno = 1557

[State 0, Turn]
type = Turn
trigger1 = P2Dist X < 0
trigger1 = AnimElemTime(6)=0

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(7)=3
x = 21
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(8)=1
x = 21
[State 0, PosAdd]
type = null;PosAdd
trigger1 = AnimElemTime(9)=1
x = 21

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=6 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=6 
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=6 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 7
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 10
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SavageSweep LK
[Statedef 1870]
type = S
movetype = A
physics = S
anim = 1870
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(9)=1
x = 3

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 4
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; realSavageSweep MK/SK
[Statedef 1871]
type = S
movetype = A
physics = S
anim = 1872
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250) || NumExplod(90000255),1,0) 

[State 1000, VarRandom]
type = VarRandom
triggerall = !IsHelper
trigger1 = !time
v=41
range = 0,1

[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
trigger1 = !time
var(41) = ifElse(P2Dist X > 200 ,1,0) 

[State 0, Explod]
type = Explod
trigger1 = IsHelper
anim = 1606
ID = 1802
removetime = 80
removeongethit = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !Time
value = 2302,0

[State 0, PosAdd]
type = PosAdd
trigger1 = Var(41) = 0
trigger1 = AnimElemTime(4)=0
x = 60
[State 0, PosAdd]
type = PosAdd
trigger1 = Var(41) = 1
trigger1 = AnimElemTime(4)=0
x = 120

[State 0, Helper]
type = Helper
trigger1 = !Time
trigger1 = P2Dist X < 100
name = "Push"
ID = 1546
stateno = 1546

[State 0, Turn]
type = Turn
trigger1 = P2Dist X < 0
trigger1 = AnimElemTime(6)=0

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(10)=1
x = 3

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=7 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=7
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=7 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 8
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 9
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; TeleSweep EX
[Statedef 1852]
type = S
movetype = A
physics = S
anim = 1802
ctrl = 0
velset = 0,0
poweradd = -500
sprpriority = 3

[State 0, VarSet]
type = VarSet
trigger1 = !Time
var(50) = 0

[State 8000, flash]
type = PalFX
trigger1 = stateno = 1852
add = 40, 30, -40
time=1
ignorehitpause = 1

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(4)=0
x = P2Dist X + 60

[State 0, Helper]
type = Helper
trigger1 = !Time
name = "Push"
ID = 1546
stateno = 1546

[State 0, PlaySnd]
type = PlaySnd
trigger1 = !Time
value = 2302,0

[State 0, Turn]
type = Turn
trigger1 = P2Dist X < 0
trigger1 = AnimElemTime(6)=0

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(7)=3
x = 21
[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(8)=1
x = 21

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=6 
trigger2 = AnimElem = 13
trigger3 = AnimElem = 20
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=6 
trigger2 = AnimElem = 13
trigger3 = AnimElem = 20
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=6 
trigger2 = AnimElem = 13
trigger3 = AnimElem = 20
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 7
trigger2 = AnimElem = 14
trigger3 = AnimElem = 21
value = 5,15

[State 0, HitDef]
type = HitDef
triggerall = !NumTarget(1850)
triggerall = Var(18) <= 55
trigger1 = AnimElem = 10
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = back          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = ceil(ifElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)),3
pausetime = 6,20
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -1,-6
;guard.velocity = 0
air.velocity = -1,-6
fall = 1
fall.recover = 0
getpower = 0, 0
givepower = 27, 13

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 17
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAF       ;HLAFD+-
guardflag = MA         ;HLA
animtype = Hard          ;light,medium,hard,back,up,diagup
air.animtype = Hard
damage    = ceil(ifElse(fvar(11) * 20 < 7, 7, fvar(11) * 20)),3
pausetime = 6,6
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,-60
hitsound   = s5,5
guardsound = S5,21
ground.type = High
air.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-6
;guard.velocity = 0
air.velocity = -2,-6
fall = 1
fall.recover = 0
getpower = 0, 0
givepower = 27, 13

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 23
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAF       ;HLAFD+-
guardflag = MA         ;HLA
animtype = back          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = ceil(ifElse(fvar(11) * 40 < 7, 7, fvar(11) * 40)),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,-60
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -12,-1
;guard.velocity = 0
air.velocity = -12,-1
fall = 1
fall.recover = 0
getpower = 0, 0
givepower = 27, 13
id = 1850

[State 205, Time Offset]
type = VarSet
triggerall = AnimElemTime(22) >= 0 && AnimElemTime(26) <= 0
trigger1 = moveContact = 1
var(50) = Time
ignorehitpause = 1
persistent = 0

[State 205, Play Anim]
type = ChangeAnim
triggerall = AnimElemTime(24) <= 0
trigger1 = hitPauseTime = [1,13 - (53 - Var(50))]
value = anim
elem = 24
ignorehitpause = 1

[State 205, Play Anim]
type = ChangeAnim
triggerall = animelemtime(25) >= 0 && AnimElemTime(26) <= 0
trigger1 = hitPauseTime = [1,13 - (57 - Var(50))]
value = anim
elem = 26
ignorehitpause = 1

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 21
statetype = A       ;S,A,C,L
movetype = A        ;I,A,H
physics = N        ;A,C,S,N

[State 0, StateTypeSet]
type = StateTypeSet
trigger1 = AnimElem = 31
statetype = A       ;S,A,C,L
physics = A        ;A,C,S,N

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(31)>=0
value = 0  

[State 0, ChangeState]
type = null;ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SweepKick LK
[Statedef 1860]
type = S
movetype = A
physics = S
anim = 1860
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 0, PosAdd]
type = PosAdd
trigger1 = AnimElemTime(9)=1
x = 3

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = animelem=1 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = animelem=1
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = animelem=1 
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 2
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 4
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; SweepKick MK/SK
[Statedef 1861]
type = S
movetype = A
physics = S
anim = 1861
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 3

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250) || NumExplod(90000255),1,0) 

[State 1000, VarSet]
type = VarSet
triggerall = IsHelper(3501) || IsHelper(3502)
trigger1 = !time
var(41) = ifElse(P2Dist X > 200 ,1,0) 

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = Cond(Var(41)=1,1862,1861)

[State 100, 1]
type = VelSet
trigger1 = Anim - 1861
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(6) <= 0
trigger2 = Anim - 1862
trigger2 = AnimElemTime(1) >= 0 && AnimElemTime(17) <= 0
x = const(velocity.run.fwd.x)+1
[State 0, VelAdd]
type = VelAdd
trigger1 = Anim - 1861
trigger1 = AnimElemTime(6) >= 0
trigger2 = Anim - 1862
trigger2 = AnimElemTime(17) >= 0
x = .5

[State 100, steps]
type = playsnd
trigger1 = animelem=2
value = 100,0

[State 100, steps]
type = playsnd
trigger1 = Anim = 1862
trigger1 = animelem=5
value = 100,1

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = Anim - 1861
trigger1 = animelem=6 
trigger2 = Anim - 1862
trigger2 = animelem=17 
value = 210,(random%2)
channel = 0

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = Anim - 1861
trigger1 = animelem=6 
trigger2 = Anim - 1862
trigger2 = animelem=17 
value = 210,(3+random%2)
channel = 0

[State 200, 1]
type = PlaySnd
triggerall = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = Anim - 1861
trigger1 = animelem=6 
trigger2 = Anim - 1862
trigger2 = animelem=17  
value = 210,(5+random%2)
channel = 0

[State 250, 1]
type = PlaySnd
trigger1 = AnimElem = 7
value = 5,15
persistent = 0

[State 0, HitDef]
type = HitDef
triggerall = Var(18) <= 55
trigger1 = AnimElem = 10
attr = S,SA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAFD        ;HLAFD+-
guardflag = LA         ;HLA
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = back
fall.animtype = Back
damage    = Cond(IsHelper,25,ceil(ifElse(fvar(11) * 50/fvar(19) < 7, 7, fvar(11) * 50/fvar(19)))),3
pausetime = 12,12
;guard.pausetime = 0,0
sparkno = s10020
guard.sparkno = s10000
sparkxy = -8,0
hitsound   = s5,5
guardsound = S5,21
ground.type = Low      ;Low,Trip,None
ground.slidetime = 15
;guard.slidetime = 0
ground.hittime = 21
;guard.hittime = 0
air.hittime = 20
yaccel = 0.5
ground.velocity = -2,-4
;guard.velocity = 0
air.velocity = -2,-4
fall = 1
fall.recover = 0
getpower = Cond(var(28)>=1||var(29)>=1,0,138), Cond(var(28)>=1||var(29)>=1,0,10)
givepower = 27, 13

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;---------------------------------------------------------------------------
; Trap Shot QCF
[Statedef 1700]
type = S
movetype = A
physics = S
anim = 1700
ctrl = 0
velset = 0,0
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1700,0 + Random%4
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1700,10 + Random%4
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1700,20 + Random%4
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250)||NumExplod(90000255),2,ifElse(NumExplod(90000240)||NumExplod(90000245),1,0))


[State 1000, VarSet]
type = VarSet
triggerall = IsHelper
trigger1 = 1
var(41) = root,var(41)

[State 1000, VarSet]
type = VarSet
triggerall = AILEVEL>0
trigger1 = !time
trigger1 = FrontEdgeBodyDist >50
var(41) = 0

[State 1000, VarSet]
type = VarRandom
triggerall = AILEVEL>0
trigger1 = !time
trigger1 = FrontEdgeBodyDist >90
v = 41
range = 0,1

[State 1000, VarSet]
type = VarRandom
triggerall = AILEVEL>0
trigger1 = !time
trigger1 = FrontEdgeBodyDist >150
v = 41
range = 0,2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = Ishelper
trigger1 = !Time
value = Cond(Var(41)=2,1702,Cond(Var(41)=1,1701,1700))

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Ishelper
trigger1 = !Time
value = Cond(Var(41)=2,1702,Cond(Var(41)=1,1701,1700))

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(7)>=0
value = 0 

;Ball for clones-START
[State 1740, Clone Ball Helper]
type = Helper
trigger1 = StateNo = 1700&&Ishelper
trigger1 = (anim = [1700,1702]) && AnimElemTime(6) = 0
;trigger1 = !NumHelper(1781)
ID = 1781
name = "Ball1"
stateno = 1780 ;All from 1750
ownpal = 1
[State 1740, Helper]
type = Helper
trigger1 = StateNo = 1700&&Ishelper
trigger1 = (anim = [1700,1702]) && AnimElemTime(6) = 0
;trigger1 = !NumHelper(1782)
trigger1 = NumHelper(1781) && helper(1781), StateNo != 1780
ID = 1782
name = "Ball2"
stateno = 1780 ;All from 1750
ownpal = 1
[State 1740, Helper]
type = Helper
trigger1 = StateNo = 1700&&Ishelper
trigger1 = (anim = [1700,1702]) && AnimElemTime(6) = 0
;trigger1 = !NumHelper(1783)
trigger1 = NumHelper(1781) && helper(1781), StateNo != 1780
trigger1 = NumHelper(1782) && helper(1782), StateNo != 1780
ID = 1783
name = "Ball3"
stateno = 1780 ;All from 1750
ownpal = 1
;Ball for Clones-END

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1800]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1801]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1802]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1803]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 810, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot QCB
[Statedef 1701]
type = S
movetype = A
physics = S
anim = 1700
ctrl = 0
velset = 0,0
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1700,0 + Random%4
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1700,10 + Random%4
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1700,20 + Random%4
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 1000, VarSet]
type = VarSet
triggerall = !IsHelper
trigger1 = !time
var(41) = ifElse(NumExplod(90000250)||NumExplod(90000255),2,ifElse(NumExplod(90000240)||NumExplod(90000245),1,0))

[State 0, VarRandom]
type = VarRandom
trigger1 = AILEVEL>0
trigger1 = !Time
v = 41
range = 0,2

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = Cond(Var(41)=2,1702,Cond(Var(41)=1,1701,1700))


[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(7)>=0
value = 0  

;Clone Balls Helper2-START
[State 1740, Helper]
type = Helper
trigger1 = StateNo = 1701&&Ishelper
trigger1 = (anim = [1700,1702]) &&  AnimElemTime(6) = 0
;trigger1 = !NumHelper(1784)
ID = 1784
name = "Ball1"
stateno = 1789 ;All from 1759
ownpal = 1
[State 1740, Helper]
type = Helper
trigger1 = StateNo = 1701&&Ishelper
trigger1 = (anim = [1700,1702]) &&  AnimElemTime(6) = 0
;trigger1 = !NumHelper(1785)
trigger1 = NumHelper(1784) && helper(1784), StateNo != 1789
ID = 1785
name = "Ball2"
stateno = 1759 ;All from 1759
ownpal = 1
[State 1740, Helper]
type = Helper
trigger1 = StateNo = 1701&&Ishelper
trigger1 = (anim = [1700,1702]) &&  AnimElemTime(6) = 0
;trigger1 = !NumHelper(1786)
trigger1 = NumHelper(1784) && helper(1784), StateNo != 1789
trigger1 = NumHelper(1785) && helper(1785), StateNo != 1789
ID = 1786
name = "Ball3"
stateno = 1789 ;All from 1759
ownpal = 1
;Clone Balls Helper2-End
[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1804]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1805]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75
[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1806]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75
[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Trap Shot DP Destroy!
[Statedef 1807]
type = S
movetype = I
physics = S
anim = 1710
ctrl = 0
velset = 0,0
poweradd = Cond(var(28)>=1||var(29)>=1,0,35)
sprpriority = 2
juggle = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=0,Var(55)=0)
trigger1 = !Time
value = 1710,0 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=1,Var(55)=1)
trigger1 = !Time
value = 1710,10 + Random%2
channel = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = Cond(IsHelper,root,var(55)=2,Var(55)=2)
trigger1 = !Time
value = 1710,20 + Random%2
channel = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = AnimElem = 7
var(53) = 75

[State 810, end]
type = changestate
trigger1 = !animtime
value = 0
ctrl = 1

;----------------------------------------
;Red Carnage Blitz (lvl1) 4 hits left
[Statedef 1900]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(21) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(22) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(23) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(24) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(25) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(26) = 0

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 0

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 4) = 0
trigger1 = stateno = 1900
value = 0
scale = 1,1 
ignorehitpause = 1
[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 2) = 0
trigger1 = stateno = 1900
value = 0
scale = 0.98,0.98
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1956)
name = "Red Carnage Voice"
ID = 1956
stateno = 1956
pos = 0,0
postype = p1  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = PrevStateNo != 1900 || PrevStateNo != 1910 || PrevStateNo != 1920|| PrevStateNo != 1930
trigger1 = AnimElem = 2
var(20) = 4

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1900
;trigger2 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
;trigger2 = !Time
value = 1900

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
anim = 15999
ID = 1900
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 0, SNK Evil Red PalFX]
type = PalFX
triggerall = animelemtime(1)>0&&animelemtime(5)<=0
trigger1 = (GameTime % 1) = 0
time = 2
add = 7,0,-200
mul = 456,0,256
sinadd = 30,30,0,10
invertall = 0
color = 0
ignorehitpause=1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 2
time = 5
ampl = -5

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1901 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 18

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 10

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1


[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 10,10
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), 0
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1900


[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Red Carnage Blitz (lvl1) loop
[Statedef 1901]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1900 ;go back to Carnage Blitz
ctrl = 0
;----------------------------------------
;Red Carnage Blitz (lvl2) 6 hits left
[Statedef 1910]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(21) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(22) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(23) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(24) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(25) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(26) = 0
[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 1

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 4) = 0
trigger1 = stateno = 1910
value = 0
scale = 1,1 
ignorehitpause = 1
[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 2) = 0
trigger1 = stateno = 1910
value = 0
scale = 0.98,0.98
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1956)
name = "Red Carnage Voice"
ID = 1956
stateno = 1956
pos = 0,0
postype = p1  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = PrevStateNo != 1900 || PrevStateNo != 1910 || PrevStateNo != 1920|| PrevStateNo != 1930
trigger1 = AnimElem = 2
var(20) = 6

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1910
;trigger2 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
;trigger2 = !Time
value = 1910

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
anim = 15999
ID = 1900
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8


[State 0, SNK Evil Red PalFX]
type = PalFX
triggerall = animelemtime(1)>0&&animelemtime(5)<=0
trigger1 = (GameTime % 1) = 0
time = 2
add = 7,0,-200
mul = 306,0,256
sinadd = 30,30,0,10
invertall = 0
color = 0
ignorehitpause=1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 2
time = 5
ampl = -5

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1911 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 18

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 10

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = SCA,NP,SP,HP
time = 1

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 14,14
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 70/fvar(19) < 7, 7, fvar(11) * 70/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), 0
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1910
envshake.time = 5
envshake.ampl = -5


[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Red Carnage Blitz (lvl2) loop
[Statedef 1911]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1910 ;go back to Carnage Blitz
ctrl = 0
;----------------------------------------
;Red Carnage Blitz (lvl3) 6 hits left+ 2nd hit guardcrush
[Statedef 1920]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(21) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(22) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(23) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(24) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(25) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(26) = 0

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 4) = 0
trigger1 = stateno = 1920
value = 0
scale = 1,1 
ignorehitpause = 1
[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 2) = 0
trigger1 = stateno = 1920
value = 0
scale = 0.98,0.98
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1956)
name = "Red Carnage Voice"
ID = 1956
stateno = 1956
pos = 0,0
postype = p1  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = PrevStateNo != 1900 || PrevStateNo != 1910 || PrevStateNo != 1920|| PrevStateNo != 1930
trigger1 = AnimElem = 2
var(20) = 6

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1920
;trigger2 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
;trigger2 = !Time
value = 1920

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
anim = 15999
ID = 1900
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8

[State 0, SNK Evil Red PalFX]
type = PalFX
triggerall = animelemtime(1)>0&&animelemtime(5)<=0
trigger1 = (GameTime % 1) = 0
time = 2
add = 7,0,-200
mul = 206,0,256
sinadd = 30,30,0,10
invertall = 0
color = 0
ignorehitpause=1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 2
time = 5
ampl = -5

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1921 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 18

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 10

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = SCA,NP,SP,HP
time = 1

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = Var(18) <= 55
triggerall = prevstateno != 1900 || prevstateno != 1910 || prevstateno != 1920 ||var(20)=6
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 20,20
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 90/fvar(19) < 17, 17, fvar(11) * 90/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
;guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -3
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), 0
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1900
envshake.time = 20
envshake.ampl = -5

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = prevstateno = 1900 || prevstateno = 1910 || prevstateno = 1920 ||var(20)<=5
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
attr = S, SA
animtype  = Hard
pausetime = 20,20
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 90/fvar(19) < 17, 17, fvar(11) * 90/fvar(19)))), Cond(IsHelper,0,21)
sparkno = s10020
guard.sparkno = s14000
priority  = 5
;guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8,-3
guard.velocity = 0
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,138)),Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,10))
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1900
envshake.time = 20
envshake.ampl = -5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit = 1
trigger1 = enemy,prevstateno = [120,155]
value = S1500,3
channel = -1
persistent = 0

[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Red Carnage Blitz (lvl3) loop
[Statedef 1921]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1920 ;go back to Carnage Blitz
ctrl = 0

;----------------------------------------
;Red Carnage Blitz (lvl4) 6 hits left+ 2nd hit guardcrush + 4x damage per hit
[Statedef 1930]
type = S
physics = S
movetype = A
ctrl = 0
velset = 0,0
sprpriority = -5
poweradd = Cond(IsHelper,0,Cond(var(28)>=1||var(29)>=1,0,35))

[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(21) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(22) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsx"
trigger2 = command = "rlsy"
trigger3 = command = "rlsz"
fvar(23) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(24) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(25) = 0
[State 0, VarSet]
type = VarSet
trigger1 = !Time
trigger1 = command = "rlsa"
trigger2 = command = "rlsb"
trigger3 = command = "rlsc"
fvar(26) = 0

[State 1000, VarSet]
type = VarSet
trigger1 = !time
var(41) = 2

[State 0, VarAdd]
type = VarAdd
triggerall = var(53) < 2100
trigger1 = !Time
var(53) = 75

[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 4) = 0
trigger1 = stateno = 1930
value = 0
scale = 1,1 
ignorehitpause = 1
[State 0, AngleDraw]
type = AngleDraw
triggerall = (GameTime % 2) = 0
trigger1 = stateno = 1930
value = 0
scale = 0.98,0.98
ignorehitpause = 1

[State 0, Helper]
type = Helper
trigger1 = animelemtime(2) = 4  
trigger1 = !NumHelper(1956)
name = "Red Carnage Voice"
ID = 1956
stateno = 1956
pos = 0,0
postype = p1  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 1 
var(20) = 0

[State 0, VarSet]
type = VarSet
trigger1 = PrevStateNo != 1900 || PrevStateNo != 1910 || PrevStateNo != 1920|| PrevStateNo != 1930
trigger1 = AnimElem = 2
var(20) = 6

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = !Time && Anim != 1930
;trigger2 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
;trigger2 = !Time
value = 1930

[State 0, Explod]
type = null;Explod
trigger1 = PrevStateNo = 1900 || PrevStateNo = 1910 || PrevStateNo = 1920
anim = 15999
ID = 1900
bindtime = -1
removetime = -1

[state 1215, Smoke FX]
type = explod
trigger1 = AnimElem = 1
anim = 10100+(var(2)=0)
id = 10100
pos = -10,0
postype = P1
sprpriority = 3
ownpal = 1
removetime = -2
persistent = 0
ignorehitpause = 1
scale = .8,.8


[State 0, SNK Evil Red PalFX]
type = PalFX
triggerall = animelemtime(1)>0&&animelemtime(5)<=0
trigger1 = (GameTime % 1) = 0
time = 2
add = 7,0,-200
mul = 96,0,256
sinadd = 30,30,0,10
invertall = 0
color = 0
ignorehitpause=1

[State 0, EnvShake]
type = EnvShake
trigger1 = animelem = 2
time = 5
ampl = -5

[State 1540, HitOverride]
type = HitOverride
triggerall = var(20) > 0
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
slot = 1
time = 1
stateno = 1931 ;spawning state
attr = SCA,NA,SA,HA,NP,SP,HP
ignorehitpause = 1

[State 901, life removal]
type = LifeAdd
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = -(gethitvar(damage))
kill = 1

[State 901, Killed] ;ok
type = ChangeState
trigger1 = life <= 0
value = 5950

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(3) = 1
trigger2 = animelemtime(4) = 1
x = 18

[State 0, VelSet]
type = VelSet
trigger1 = animelemtime(5) = 1 && Vel X =0
trigger2 = animelemtime(6) = 1 && Vel X =0
trigger3 = animelemtime(7) = 1 && Vel X =0
trigger4 = animelemtime(8) = 1 && Vel X =0
trigger5 = animelemtime(9) = 1 && Vel X =0
x = 10

[State 0, VelAdd]
type = VelAdd
triggerall = vel y >= 0.5
trigger1 = animelemtime(9) >= 1
x = -0.15
ignorehitpause = 1
persistent = 1

[State 0, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
value = SCA,NP,SP,HP
time = 1

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = Var(18) <= 55
triggerall = prevstateno != 1900 || prevstateno != 1910 || prevstateno != 1920 || prevstateno != 1930||var(20)=6
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(11) < 0
attr = S, SA
animtype  = Hard
pausetime = 30,30
damage    = Cond(IsHelper,35,ceil(ifElse(fvar(11) * 170/fvar(19) < 77, 77, fvar(11) * 170/fvar(19)))), Cond(IsHelper,0,11)
sparkno = s10020
guard.sparkno = s10000
priority  = 5
;guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8, -8
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
guard.velocity = 0
air.velocity = -12, -8
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(var(28)>=1||var(29)>=1,0,138), 0
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1900
envshake.time = 30
envshake.ampl = -5

[State 1200, 2]
type = HitDef
triggerall = !NumTarget(1900)
triggerall = var(20)<=5 ;prevstateno = 1900 || prevstateno = 1910 || prevstateno = 1920|| prevstateno = 1930&&var(20)=5 
triggerall = Var(18) <= 55
trigger1 = AnimElemTime(3) >= 0 && AnimElemTime(9) < 0
attr = S, SA
animtype  = Hard
pausetime = 30,30
damage    = Cond(IsHelper,140,ceil(ifElse(fvar(11) * 280/fvar(19) < 77, 77, fvar(11) * 280/fvar(19)))), Cond(IsHelper,0,44)
sparkno = s10020
guard.sparkno = s14000
priority  = 5
;guardflag = MA
sparkxy = -8,-69
hitsound   = S1500, 13
guardsound = S5,20
ground.type = Low
ground.slidetime = 16
ground.hittime  = 18
nochainid = 3000
ground.velocity = -8,-3
guard.velocity = 0
ground.cornerpush.veloff = -12 ;To push far away when p2 is in corner
air.velocity = -12, -2
airguard.velocity = -3.5,-4.5
p2facing = 1
getpower = Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,138)),Cond(IsHelper, 0,Cond(var(28)>=1||var(29)>=1,0,10))
givepower = 27, 13
persistent = 0
fall.recover = 0
fall = 1
id=1900
envshake.time = 30
envshake.ampl = -5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit = 1
trigger1 = enemy,prevstateno = [120,155]
value = S1500,3
channel = -1
persistent = 0


[State 0, TargetState]
type = TargetState
triggerall = NumTarget;()
triggerall = !IsHelper
trigger1 = MoveHit = 1
value = 1050
persistent = 1


[State 0, AttackDist]
type = AttackDist
trigger1 = AnimElemTime(11)>=0
value = 0  

[State 0, VarSet]
type = VarSet
trigger1 = AnimElem = 9
var(20) = 0

[State 14, end]
type = changestate
triggerall = Ishelper
trigger1 = !animtime
value = 35000
ctrl = 1

[State 14, end]
type = changestate
triggerall = !Ishelper
trigger1 = !animtime
value = 0
ctrl = 1


;----------------------------------------
;Red Carnage Blitz (lvl4) loop
[Statedef 1931]
type = A
physics = N
movetype = I
ctrl = 0

[State 1541, NotHitBy]
type = NotHitBy
trigger1 = 1
time = 1
value = SCA

[State 1541, VarAdd] ;Number of hits remaining
type = VarAdd
trigger1 = !time
var(20) = -1
ignorehitpause = 1
persistent = 0

[State 2315, ChangeState]
type = ChangeState
trigger1 = !time
value = 1930 ;go back to Carnage Blitz
ctrl = 0